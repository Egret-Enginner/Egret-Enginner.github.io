function StringIsNullOrEmpty(e){return e?e.trim().length<=0?!0:!1:!0}function IsNetworkEnable(){return navigator.onLine}function ArrayHasIndex(e,t){return void 0===t&&(t=0),null==e||IsNullOrUndefined(e[t])?!1:!0}function IsNullOrUndefined(e){return null==e||void 0==e}function GetStringLength(e){var t=e.match(/[^\x00-\xff]/gi);return null==t?e.length:e.length+t.length}function IsLegalString(e){var t=new RegExp("^[一-龥a-zA-Z0-9]+$");return t.test(e)}function MathAdd(e,t){isNaN(e)&&(e=0),isNaN(t)&&(t=0);var n,o,i,a;try{n=e.toString().split(".")[1].length}catch(r){n=0}try{o=t.toString().split(".")[1].length}catch(r){o=0}if(a=Math.abs(n-o),i=Math.pow(10,Math.max(n,o)),a>0){var s=Math.pow(10,a);n>o?(e=Number(e.toString().replace(".","")),t=Number(t.toString().replace(".",""))*s):(e=Number(e.toString().replace(".",""))*s,t=Number(t.toString().replace(".","")))}else e=Number(e.toString().replace(".","")),t=Number(t.toString().replace(".",""));return(e+t)/i}function MathSub(e,t){isNaN(e)&&(e=0),isNaN(t)&&(t=0);var n,o,i,a;try{n=e.toString().split(".")[1].length}catch(r){n=0}try{o=t.toString().split(".")[1].length}catch(r){o=0}return i=Math.pow(10,Math.max(n,o)),a=n>=o?n:o,MathToFixed((e*i-t*i)/i,a)}function MathMul(e,t,n){void 0===n&&(n=-1),isNaN(e)&&(e=0),isNaN(t)&&(t=0);var o=0,i=e.toString(),a=t.toString();try{o+=i.split(".")[1].length}catch(r){}try{o+=a.split(".")[1].length}catch(r){}var s=Number(i.replace(".",""))*Number(a.replace(".",""))/Math.pow(10,o);if(n>=0){var l=Math.pow(10,n);return Number((s*l).toString().split(".")[0])/l}return s}function MathDiv(e,t,n){if(void 0===n&&(n=-1),isNaN(e)&&(e=0),isNaN(t)&&(t=0),0==t)return console.error("除法函數除數不得為0"),0/0;var o,i,a=0,r=0;try{a=e.toString().split(".")[1].length}catch(s){}try{r=t.toString().split(".")[1].length}catch(s){}o=Number(e.toString().replace(".","")),i=Number(t.toString().replace(".",""));var l=o/i*Math.pow(10,r-a);if(n>=0){var u=Math.pow(10,n);return Number((l*u).toString().split(".")[0])/u}return l}function MathToFixed(e,t){var n=Math.pow(10,t);return MathDiv(Number(MathMul(e,n).toString().split(".")[0]),n)}function BigNum(e,t){var n=null;try{n=new BigNumber(e,t)}catch(o){}return n}function BigNumAdd(e,t,n){if(void 0===n&&(n=-1),!e||!t)return"";var o=BigNum(e.toString()),i=BigNum(t.toString());return o&&i?n>=0?o.plus(i).toFixed(n,BigNumber.ROUND_DOWN):o.plus(i).toString():""}function BigNumSub(e,t,n){if(void 0===n&&(n=-1),!e||!t)return"";var o=BigNum(e.toString()),i=BigNum(t.toString());return o&&i?n>=0?o.minus(i).toFixed(n,BigNumber.ROUND_DOWN):o.minus(i).toString():""}function BigNumMul(e,t,n){if(void 0===n&&(n=-1),!e||!t)return"";var o=BigNum(e.toString()),i=BigNum(t.toString());return o&&i?n>=0?o.mul(i).toFixed(n,BigNumber.ROUND_DOWN):o.mul(i).toString():""}function BigNumDiv(e,t,n){if(void 0===n&&(n=-1),!e||!t)return"";var o=BigNum(e.toString()),i=BigNum(t.toString());return o&&i?n>=0?o.dividedBy(i).toFixed(n,BigNumber.ROUND_DOWN):o.dividedBy(i).toString():""}function BigNumToFixed(e,t){if(!e)return"";var n=BigNum(e.toString());return n?0>t?n.toFixed(0,BigNumber.ROUND_DOWN):n.toFixed(t,BigNumber.ROUND_DOWN):""}function BigNumCompareTo(e,t){var n=BigNum(e),o=BigNum(t);if(!n||!o)return null;switch(n.comparedTo(o)){case-1:return CompareType.Less;case 0:return CompareType.Equal;case 1:return CompareType.Greater}return null}function IsNumberOverflow(e){if(e){var t=Number(e);if(t)return new RegExp("e+").test(t.toString())}return Debug.LogError("checkValue = "+e+" 回傳true !!"),!0}function MathSin(e){return Math.sin(Math.PI*e/180)}function MathCos(e){return Math.cos(Math.PI*e/180)}function MathTan(e,t){var n=Number(MathSin(e).toFixed(6)),o=Number(MathCos(e).toFixed(6));return 0==o?t:n/o}function MathCot(e,t){var n=Number(MathCos(e).toFixed(6)),o=Number(MathSin(e).toFixed(6));return 0==o?t:n/o}function MathSec(e,t){var n=Number(MathCos(e).toFixed(6));return 0==n?t:1/n}function MathCsc(e,t){var n=Number(MathSin(e).toFixed(6));return 0==n?t:1/n}function CalcTwoPointDistance(e,t,n,o){return void 0===n&&(n=0),void 0===o&&(o=0),Math.sqrt(Math.pow(e-n,2)+Math.pow(t-o,2))}function IsLineIntersect(e,t,n,o){var i=(o.x-n.x)*(e.y-n.y)-(o.y-n.y)*(e.x-n.x),a=(t.x-e.x)*(e.y-n.y)-(t.y-e.y)*(e.x-n.x),r=(o.y-n.y)*(t.x-e.x)-(o.x-n.x)*(t.y-e.y);if(0!==r){var s=i/r,l=a/r;if(s>=0&&1>=s&&l>=0&&1>=l)return!0}return!1}function IsLineRectIntersect(e,t,n){var o=new Vector2(n.x,n.y),i=new Vector2(n.x,n.z),a=new Vector2(n.w,n.z),r=new Vector2(n.w,n.y);return IsLineIntersect(e,t,o,i)?!0:IsLineIntersect(e,t,i,a)?!0:IsLineIntersect(e,t,a,r)?!0:IsLineIntersect(e,t,r,o)?!0:!1}function CalcTwoLineIntersectPoint(e,t,n,o,i){void 0===i&&(i=!0);var a=(t.y-e.y)*(o.x-n.x)-(e.x-t.x)*(n.y-o.y);if(0==a)return!1;var r=((t.x-e.x)*(o.x-n.x)*(n.y-e.y)+(t.y-e.y)*(o.x-n.x)*e.x-(o.y-n.y)*(t.x-e.x)*n.x)/a,s=-((t.y-e.y)*(o.y-n.y)*(n.x-e.x)+(t.x-e.x)*(o.y-n.y)*e.y-(o.x-n.x)*(t.y-e.y)*n.y)/a;return i?new Vector2(r,s):(r-e.x)*(r-t.x)<=0&&(s-e.y)*(s-t.y)<=0&&(r-n.x)*(r-o.x)<=0&&(s-n.y)*(s-o.y)<=0?new Vector2(r,s):!1}var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__awaiter=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(i,a){function r(e){try{l(o.next(e))}catch(t){a(t)}}function s(e){try{l(o["throw"](e))}catch(t){a(t)}}function l(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(r,s)}l((o=o.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return o([e,t])}}function o(n){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,a&&(r=a[2&n[0]?"return":n[0]?"throw":"next"])&&!(r=r.call(a,n[1])).done)return r;switch(a=0,r&&(n=[0,r.value]),n[0]){case 0:case 1:r=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,a=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(r=l.trys,!(r=r.length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){l.label=n[1];break}if(6===n[0]&&l.label<r[1]){l.label=r[1],r=n;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(n);break}r[2]&&l.ops.pop(),l.trys.pop();continue}n=t.call(e,l)}catch(o){n=[6,o],a=0}finally{i=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,r,s,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);n.prototype=t.prototype,e.prototype=new n},StateMachineFramework=function(){function e(){this.StateDic=new Dictionary([]),this.Flags=[!1,!1]}return e.prototype.GetStateListData=function(e){return this.StateDic.ContainsKey(e)||this.StateDic.Add(e,new StateListData),this.StateDic.GetValueByKey(e)},e.prototype.GetStateFromListData=function(e){return this.GetStateListData(e).GetState()},e.prototype.GetFunctionFromListData=function(e){return this.GetStateListData(e).GetFunction()},e.prototype.SetupState=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=null),this.GetStateListData(e).SetState(t,n),t},e.prototype.IsEmpty=function(e){return this.GetStateListData(e).IsEmpty},e.prototype.ResetStateListDataIndex=function(){for(var e=this.StateDic.Keys,t=0,n=e.length;n>t;t++)this.GetStateListData(e[t]).ResetIndex()},e.prototype.OnSameStateHandle=function(e){return!1},e.prototype.WaitForStateEnd=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.Flags[0]=!1,null==e?[3,2]:[4,e.StateEnd()];case 1:t.sent(),t.label=2;case 2:return this.Flags[0]=!0,[2]}})})},e.prototype.WaitForStateReady=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.Flags[1]=!1,null==e?[3,2]:[4,e.StateReadyToBegin()];case 1:t.sent(),t.label=2;case 2:return this.Flags[1]=!0,[2]}})})},e.prototype.ChangeState=function(e,t){void 0===t&&(t=null);for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];return __awaiter(this,void 0,void 0,function(){var o;return __generator(this,function(i){switch(i.label){case 0:if(o=this.GetFunctionFromListData(e),null==t&&(t=this.GetStateFromListData(e)),null!=this.CurGameStateBase&&this.CurGameStateBase===t&&!this.OnSameStateHandle(this.CurGameStateBase))return[2];this.WaitForStateEnd(this.CurGameStateBase),this.WaitForStateReady(t),i.label=1;case 1:return this.Flags[0]&&this.Flags[1]?[3,3]:[4,Time.WaitForSecond()];case 2:return i.sent(),[3,1];case 3:return null!=this.CurGameStateBase&&this.CurGameStateBase.StateClose(),this.CurGameState=e,this.CurGameStateBase=t,null!=o&&o.apply(this),[4,Time.WaitForSecond()];case 4:return i.sent(),null==this.CurGameStateBase?[3,6]:[4,this.CurGameStateBase.StateBegin()];case 5:return i.sent(),[3,7];case 6:null==o&&Debug.LogError("Cur GameStateBase = null : toState = "+e),i.label=7;case 7:return this.UpdateUI.apply(this,n),[2]}})})},e.prototype.UpdateUI=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e}();__reflect(StateMachineFramework.prototype,"StateMachineFramework");var AppResizeUIBase=function(){function e(){this.ScreenYOffset=0}return Object.defineProperty(e.prototype,"UseStaticYOffset",{get:function(){return AppUIBase.IsSetGlobalYOffset?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"UIScreenYOffset",{get:function(){return this.UseStaticYOffset?AppUIBase.GlobalYOffset:this.ScreenYOffset},set:function(e){this.ScreenYOffset=e,this.OnResize()},enumerable:!0,configurable:!0}),e}();__reflect(AppResizeUIBase.prototype,"AppResizeUIBase");var AppUIBase=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.IsInited=!1,t.UIDepth=10,t.IsActive=!1,t}return __extends(t,e),t.RegisterUI=function(e){this.AppAllUI.indexOf(e)<0&&this.AppAllUI.push(e)},t.UnregisterUI=function(e){var t=this.AppAllUI.indexOf(e);t>=0&&this.AppAllUI.splice(t,1)},Object.defineProperty(t,"GlobalYOffset",{get:function(){return t.GYOffset},set:function(e){t.GYOffset=e},enumerable:!0,configurable:!0}),t.SetupGlobalYOffset=function(e){this.IsSetGlobalYOffset=!0,t.GlobalYOffset=e;for(var n=0,o=this.AppAllUI.length;o>n;n++)this.AppAllUI[n].OnResize()},Object.defineProperty(t.prototype,"RootObj",{get:function(){return null!=this.RootEObj?this.RootEObj.GObj:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"UseRootToGetObj",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CountReplaceString",{get:function(){return"@"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ReplaceTextList",{get:function(){return[]},enumerable:!0,configurable:!0}),t.prototype.Init=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this.RootEObj=e[0],null!=this.RootEObj?(this.Depth=this.UIDepth,t.RegisterUI(this),SendTool.Register(AppEvent[AppEvent.OnResize],this,this.OnResize),SendTool.SendData(AppEvent[AppEvent.OnResize]),this.ReplaceText(),!0):(Debug.LogError("UI Init Failure : RootObj = null"),!1)},t.prototype.Start=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},t.prototype.Clear=function(){},t.prototype.WaitForInit=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.IsInited?[3,2]:[4,Time.WaitForSecond()];case 1:return e.sent(),[3,0];case 2:return[2]}})})},t.prototype.ReplaceText=function(){if(this.UseRootToGetObj)for(var e=0,t=this.ReplaceTextList.length;t>e;e++){var n=1;void 0!=this.ReplaceTextList[e].Count&&this.ReplaceTextList[e].Count>0&&0/0!=this.ReplaceTextList[e].Count&&(n=this.ReplaceTextList[e].Count);for(var o=0;n>o;o++){var i=this.ReplaceTextList[e].Text.replace(this.CountReplaceString,o.toString()),a=this.ReplaceTextList[e].LanguageKey.replace(this.CountReplaceString,o.toString()),r=this.ReplaceTextList[e].TextHierarchy.replace(this.CountReplaceString,o.toString()),s=FUIManager.GetEObj(this.RootObj,r);null!=s&&(StringIsNullOrEmpty(i)&&(i=StringIsNullOrEmpty(a)?LanguageManager.GetText(Method.GetLastCharString(r,"/")):LanguageManager.GetText(a)),s.Text=i)}}else for(var l=FUIManager.GetElementDictionary(this.RootObj),e=0,t=this.ReplaceTextList.length;t>e;e++){var n=1;void 0!=this.ReplaceTextList[e].Count&&this.ReplaceTextList[e].Count>0&&0/0!=this.ReplaceTextList[e].Count&&(n=this.ReplaceTextList[e].Count);for(var o=0;n>o;o++){var i=this.ReplaceTextList[e].Text.replace(this.CountReplaceString,o.toString()),a=this.ReplaceTextList[e].LanguageKey.replace(this.CountReplaceString,o.toString()),r=this.ReplaceTextList[e].TextHierarchy.replace(this.CountReplaceString,o.toString()),u=l[r];null!=u&&(StringIsNullOrEmpty(i)&&(i=StringIsNullOrEmpty(a)?LanguageManager.GetText(Method.GetLastCharString(r,"/")):LanguageManager.GetText(a)),u.Text=i)}}},Object.defineProperty(t.prototype,"Depth",{set:function(e){this.UIDepth=e,this.UpdateDepth(e)},enumerable:!0,configurable:!0}),t.prototype.UpdateDepth=function(e){null!=this.RootObj&&(this.RootObj.sortingOrder=e)},t.prototype.SetActive=function(e,t){void 0===t&&(t=!1),null!=this.RootObj&&(this.IsActive=e,this.UpdateDepth(e?this.UIDepth:0),this.RootObj.visible=e,t&&(this.RootObj.alpha=e?1:0))},t.prototype.UpdateUI=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.OnResize=function(){if(null!=this.RootObj){var e=t.GetObjScreenRect(GlobalValue.EgretElementWidth,GlobalValue.EgretElementHeight,GlobalValue.FitWidthRatio,GlobalValue.FitHeightRatio,this.UIScreenYOffset);this.RootObj.x=e.x,this.RootObj.y=e.y,this.RootObj.setScale(e.z,e.z)}},t.GetFairyToScreenPos=function(e,t,n){var o=Vector2.Zero,i=n/GlobalValue.EgretElementHeight,a=Math.abs(e.x*e.w),r=Math.abs(e.y*e.w);if(o.x=.5*innerWidth,e.x<=0)o.x=t/GlobalValue.EgretElementWidth*innerWidth;else{var s=innerWidth-2*a,l=GlobalValue.EgretElementWidth/s;o.x=t/l+a}return e.y<=0?e.x<=0?o.y=innerWidth/GlobalValue.EgretElementWidth*GlobalValue.EgretElementHeight*i-r:o.y=(innerHeight+2*r)*i-r:o.y=innerWidth/GlobalValue.EgretElementWidth*GlobalValue.EgretElementHeight*i+r,o},t.GetEgretScreenToFairyPos=function(e,t,n){var o=t/GlobalValue.EgretElementWidth,i=n/(GlobalValue.EgretElementWidth/innerWidth*innerHeight);return this.GetHtmlScreenToFairyPos(e,innerWidth*o,innerHeight*i)},t.GetHtmlScreenToFairyPos=function(e,t,n){var o=Vector2.Zero,i=Math.abs(e.x*e.w),a=Math.abs(e.y*e.w);if(e.x<=0)o.x=t/innerWidth*GlobalValue.EgretElementWidth;else{var r=innerWidth-2*i,s=GlobalValue.EgretElementWidth/r;o.x=(t-i)*s}return e.y<=0?e.x<=0?o.y=(n+a)/(innerWidth/GlobalValue.EgretElementWidth*GlobalValue.EgretElementHeight)*GlobalValue.EgretElementHeight:o.y=(n+a)/(innerHeight+2*a)*GlobalValue.EgretElementHeight:o.y=(n-a)/(innerWidth/GlobalValue.EgretElementWidth*GlobalValue.EgretElementHeight)*GlobalValue.EgretElementHeight,o},t.GetObjScreenRect=function(e,t,n,o,i,a){void 0===i&&(i=0),void 0===a&&(a=!1);var r=Vector4.Zero;r.x=0,r.y=0;var s=innerWidth,l=innerHeight;if(Main.IsPortrait&&(GlobalValue.AllowPortrait||(s=innerHeight,l=innerWidth)),Main.ScreenScaleMode==egret.StageScaleMode.FIXED_WIDTH){r.w=s/e;var u=s,c=u/e*t,h=u/n*o,p=1,d=0;if(n>o){if(s>l)if(h>l)p=l/h,d=(t-e/n*o)/2,r.y=-d*p,r.x=e*(1-p)/2;else{var g=c/t;r.y=(l-c)/2/g}else{var g=c/t;r.y=(l-c)/2/g}r.z=p}else{if(s>l)p=l/h,d=(t-e/n*o)/2,r.y=-d*p,r.x=e*(1-p)/2;else if(c>l)if(l>h){var y=(c-l)/Math.abs(h-c),g=l/h;d=(t-e/n*o)/2,r.y-=d*g*y}else p=l/h,d=(t-e/n*o)/2,r.y=-d*p,r.x=e*(1-p)/2;else{var g=c/l,f=(1-g)/2;d=f*l,r.y=d/g}r.z=p}}else{r.w=1;var p=fairygui.GRoot.inst.width/e;r.z=p}return r.y+=i*r.z,a&&(r.x*=r.w,r.y*=r.w,r.z*=r.w),r},t.AppAllUI=[],t.GYOffset=0,t.IsSetGlobalYOffset=!1,t}(AppResizeUIBase);__reflect(AppUIBase.prototype,"AppUIBase");var GameCtrllerBase=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.IsActive=!1,t}return __extends(t,e),t.prototype.StateReadyToBegin=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},t.prototype.StateBegin=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.SetActive(!0),[2]})})},t.prototype.StateEnd=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},t.prototype.StateClose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.SetActive(!1),[2]})})},t.prototype.Init=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.Data=e[0],this.View=e[1],this.Callback=e[2],this.SetActive(!1),[2]})})},t.prototype.SetActive=function(e){this.IsActive=e},t.prototype.Clear=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];(n=this.View).Clear.apply(n,e);var n},t}(StateMachineFramework);__reflect(GameCtrllerBase.prototype,"GameCtrllerBase",["IAppUIFunctionBase","IAppFunctionBase","IState"]);var HitFishBaseEffectType;!function(e){e[e.Small=0]="Small",e[e.Mid=1]="Mid",e[e.Big=2]="Big"}(HitFishBaseEffectType||(HitFishBaseEffectType={}));var FishingGameViewBase=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Battery=[],t.ScoreEffectPools=[],t.BatteryShelf=[],t.SettlementKey="",t.SkipPlayFirstTime=!0,t.InvokeUBOddsKey="",t}return __extends(t,e),Object.defineProperty(t.prototype,"SeatData",{get:function(){return this.Data.Seat[this.SeatIndex]},enumerable:!0,configurable:!0}),t.prototype.Init=function(t,n,o){return __awaiter(this,void 0,void 0,function(){var i,a,r,s,i,a,l=this;return __generator(this,function(u){if(e.prototype.Init.call(this,t)){for(this.Data=n,this.SeatIndex=o,this.FishParent=FUIManager.GetEObj(this.RootObj,"FishParent"),this.MoneyParent=FUIManager.GetEObj(this.RootObj,"MoneyParent"),this.SpecialEffectParent=FUIManager.GetEObj(this.RootObj,"SpecialEffectParent"),this.BulletParent=FUIManager.GetEObj(this.RootObj,"BulletParent"),this.LockedFish=FUIManager.GetEObj(this.RootObj,"LockedFish_"+o),this.LockedFishIcon=FUIManager.GetEObj(this.RootObj,"LockedFish_"+o+"/Icon"),this.SeatObj=FUIManager.GetEObj(this.RootObj,"Seat_"+o),this.LockTarget=FUIManager.GetEObj(this.RootObj,"LockTarget_"+o),this.LockTarget&&this.LockTarget.SetActive(!1),this.BulletOddText=FUIManager.GetEObj(this.RootObj,"BulletOdd_"+o),this.PlayerCtrlBtn=FUIManager.GetEObj(this.RootObj,"CtrlBtn_"+o),this.PlayerCtrlBtn&&this.PlayerCtrlBtn.SetActive(!1),i=0,a=GameSettings.MaxBatteryCount;a>i;i++)this.Battery.push(FUIManager.GetEObj(this.RootObj,"Seat_"+o+"/Battery_"+i)),this.BatteryShelf.push(FUIManager.GetEObj(this.RootObj,"Seat_"+o+"/Shelf_"+i));this.Settlement=FUIManager.GetEObj(this.RootObj,"Settlement_"+o),this.PlayInfoBoard=FUIManager.GetEObj(this.RootObj,"PlayInfo_"+o),this.PlayerName=FUIManager.GetEObj(this.RootObj,"PlayInfo_"+o+"/Text_Name"),this.Balance=FUIManager.GetEObj(this.RootObj,"PlayInfo_"+o+"/Text_Money"),this.HasPlayer=FUIManager.GetEObj(this.RootObj,"HasPlayer_"+o),this.WaitForEnterTip=FUIManager.GetEObj(this.RootObj,"WaitForEnterTip_"+o)}for(r=function(e,t){s.ScoreEffectPools.push(new Pool(function(){return FUIManager.CreateEObjFromResourceByPackageName(GlobalValue.PackageName,l.ScoreEffectResName(e))},function(e){e.SetActive(!0)},function(e){e.SetActive(!1)}))},s=this,i=0,a=Method.GetEnumCount(HitFishBaseEffectType);a>i;i++)r(i,a);return[2]})})},t.prototype.Clear=function(){Time.Stop(this.InvokeUBOddsKey)},t.prototype.GetOddsTextString=function(e,t){return e==t?"x"+e:"x"+e+"~"+t},t.prototype.UpdateLockTarget=function(e,t,n){null!=this.LockTarget&&(e&&(this.LockTarget.ActiveSelf||(AudioPlayer.PlaySound("CannonLocking_001_mp3"),this.LockTarget.PlayAni("LockEffect")),this.LockTarget.SetPosition(t,n)),this.LockTarget.SetActive(e))},t.prototype.SetLockFishActive=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},t.prototype.UpdateFishMove=function(e,t,n,o){var i=e.FishObj;if(null!=i){i.x=t,i.y=n,i.Rotation=o,o=Method.FixAngle(o);var a=o>90&&270>o?-1:1;i.SetScale(i.Scale.x,a)}},Object.defineProperty(t.prototype,"FishWaveDuration",{get:function(){return 1},enumerable:!0,configurable:!0}),t.prototype.OnFishWave=function(e){this.RootEObj.PlayAni("FishWave")},t.prototype.OnFishWaveWarning=function(e){},t.prototype.ShowSettlement=function(e,t){var n=this;this.Settlement&&(this.Settlement.SetActive(!0),this.Settlement.GetChild("Icon").SpriteName=FishType[t],this.SetSettlement(e),this.SettlementKey=Time.StopAndDelayAction(5,function(){n.Settlement.SetActive(!1)},this.SettlementKey))},t.prototype.SetSettlement=function(e){if(this.Settlement){this.Settlement.PlayAni("Others");var t=this.Settlement.GetChild("Text_Others");e>=0?t.Text=Method.ToFixedString(MathMul(e,GlobalValue.ServerToClientMoneyScale).toString(),GlobalValue.NumberDigits,!0):t.Text=""}},t.prototype.PlayScreenShake=function(){this.RootEObj.PlayAni("Shake")},t.prototype.ShowScoreEffect=function(e,t,n,o){return __awaiter(this,void 0,void 0,function(){var i,a,r;return __generator(this,function(s){switch(s.label){case 0:return(i=this.ScoreEffectPools[e].GetObj())?(FUIManager.SetEObjParentToEObj(i,this.MoneyParent),i.x=t,i.y=n,a=i.GetChild("Text"),o>=0?a.Text=Method.ToFixedString(MathMul(o,GlobalValue.ServerToClientMoneyScale).toString(),GlobalValue.NumberDigits,!0):a.Text="",i.PlayAni("Show"),[4,Time.WaitForSecond(1.5)]):[3,3];case 1:return s.sent(),r=GameSettings.SeatShootPos[this.SeatIndex],i.PlayAni("Hide"),FUIManager.MoveEObjToPos(i,.4,r.x,r.y,CurveMethod.EaseOut),[4,Time.WaitForSecond(.5)];case 2:s.sent(),this.ScoreEffectPools[e].RecycleObj(i),s.label=3;case 3:return[2]}})})},t.prototype.OnShootBullet=function(){for(var e=0,t=this.Battery.length;t>e;e++)this.Battery[e]&&this.Battery[e].PlayGLoaderAni();this.UpdateBalance()},t.prototype.UpdateBalance=function(){if(this.Balance)if(this.SeatData.PlayerName){var e=this.SeatData.DisplayBalance,t=AppData.Account.Symbol?AppData.Account.Symbol:"";this.Balance.Text=t+Method.ToFixedString(MathMul(e,GlobalValue.ServerToClientMoneyScale).toString(),GlobalValue.NumberDigits,!0)}else this.Balance.Text=""},t.prototype.UpdateBatteryAngle=function(e){for(var t=0,n=this.Battery.length;n>t;t++)this.Battery[t]&&(this.Battery[t].Angle=e)},t.prototype.UpdateBattery=function(){if(this.SeatData.LastBatteryIndex!=this.SeatData.CurBatteryIndex){this.ChangeBatteryFX(this.SeatData.LastBatteryIndex,this.SeatData.CurBatteryIndex),this.SeatData.LastBatteryIndex=this.SeatData.CurBatteryIndex;for(var e=0,t=this.Battery.length;t>e;e++)this.Battery[e]&&this.Battery[e].SetActive(e==this.SeatData.CurBatteryIndex),this.BatteryShelf[e]&&this.BatteryShelf[e].SetActive(e==this.SeatData.CurBatteryIndex)}},t.prototype.ChangeBatteryFX=function(e,t){return this.SeatObj&&this.SeatObj.PlayAni("LvUp"),this.SkipPlayFirstTime?void(this.SkipPlayFirstTime=!1):void AudioPlayer.PlaySound("CannonSwitch_001_mp3")},t.prototype.UpdateBulletOddsText=function(){Time.Stop(this.InvokeUBOddsKey),this.Data.BetOdd[this.SeatData.CurBulletIndex]?this.BulletOddText&&(this.BulletOddText.Text=Method.ToFixedString(MathMul(this.Data.BetOdd[this.SeatData.CurBulletIndex],GlobalValue.ServerToClientMoneyScale).toString(),GlobalValue.NumberDigits,!0)):(this.AutoInvokeUpdateBulletOddsText(),Debug.LogError(this.SeatData.CurBulletIndex+"沒有Odds資料 "+JSON.stringify(this.Data.BetOdd)))},t.prototype.AutoInvokeUpdateBulletOddsText=function(){var e=this;this.InvokeUBOddsKey=Time.DelayAction(1,function(){e.UpdateBulletOddsText()})},t.prototype.UpdateLocked=function(){this.SeatData.HasLockTarget&&this.SeatData.LockedFishType>0?(this.LockedFish&&this.LockedFish.SetActive(!0),this.LockedFishIcon&&(this.LockedFishIcon.SpriteName=FishType[this.SeatData.LockedFishType])):this.LockedFish&&this.LockedFish.SetActive(!1)},t.prototype.UpdateUI=function(){this.UpdateBattery(),this.UpdateBalance(),Debug.LogWarning("SeatIndex",this.SeatIndex,"PlayerName",this.SeatData.PlayerName),this.SeatData.PlayerName?(this.PlayerName&&(this.PlayerName.Text=this.SeatData.PlayerName),this.HasPlayer&&this.HasPlayer.SetActive(!0),this.PlayInfoBoard&&this.PlayInfoBoard.SetActive(!0),this.WaitForEnterTip&&this.WaitForEnterTip.SetActive(!1),this.UpdateBulletOddsText()):(this.PlayerName&&(this.PlayerName.Text=""),this.HasPlayer&&this.HasPlayer.SetActive(!1),this.PlayInfoBoard&&this.PlayInfoBoard.SetActive(!1),this.WaitForEnterTip&&this.WaitForEnterTip.SetActive(!0),this.BulletOddText&&(this.BulletOddText.Text="")),this.UpdateLocked()},t}(AppUIBase);__reflect(FishingGameViewBase.prototype,"FishingGameViewBase");var FishingGameCtrllerBase=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.CurAngle=90,t.LockCtrller=new LockTargetCtrller,t.BulletPools=new Dictionary,t.EffectPools=new Dictionary,t.SeatIndex=0,t.LockShootKey="",t.AutoShootKey="",t.SpecialWeaponKey="",t.LastLeftTime=-1,t.BulletID=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"BulletResName",{get:function(){return["Bullet1","Bullet2","Bullet3","Bullet4"]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EffectResName",{get:function(){return["HitEffect1","HitEffect2","HitEffect3","HitEffect4"]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SeatData",{get:function(){return this.Data.Seat[this.SeatIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShootPoint",{get:function(){return GameSettings.SeatShootPos[this.SeatIndex]},enumerable:!0,configurable:!0}),t.prototype.Init=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){var n,o,i,a,r,s,i,a,l=this;return __generator(this,function(u){for(e.prototype.Init.apply(this,t),this.SeatIndex=t[3],this.LockCtrller.Init(this.Data,this.View,function(e){l.OnLostLockTarget(e)},this.SeatIndex),n=function(e,t){o.EffectPools.Add(e,new Pool(function(){return FUIManager.CreateEObjFromResourceByPackageName(GlobalValue.PackageName,l.EffectResName[e])},function(e){e.SetActive(!0)},function(e){e.SetActive(!1)}))},o=this,i=0,a=this.EffectResName.length;a>i;i++)n(i,a);for(r=function(e,t){s.BulletPools.Add(e,new Pool(function(){return FUIManager.CreateEObjFromResourceByPackageName(GlobalValue.PackageName,l.BulletResName[e])},function(e){e.SetActive(!0)},function(e){e.SetActive(!1)}))},s=this,i=0,a=this.BulletResName.length;a>i;i++)r(i,a);return[2]})})},t.prototype.Clear=function(){e.prototype.Clear.call(this);for(var t=0,n=this.EffectResName.length;n>t;t++){var o=this.EffectPools[t];o&&(o.Clear(),o=null)}this.EffectPools.Clear();for(var t=0,n=this.BulletResName.length;n>t;t++){var o=this.BulletPools[t];o&&(o.Clear(),o=null)}this.BulletPools.Clear()},t.prototype.Start=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){return this.IsActive=!0,(t=this.View).Start.apply(t,e),this.UpdateUI(),[2]})})},t.prototype.OnLostLockTarget=function(e){this.DisableLockFishAutoShoot(),this.DisableAutoShoot(),this.UpdateUI()},t.prototype.StateReadyToBegin=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},t.prototype.StateBegin=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return Debug.LogWarningWithFlag("MainGame StateBegin : "+GameState[this.CurGameState]),e.prototype.StateBegin.apply(this,t),[2]})})},t.prototype.StateEnd=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return Debug.LogWarningWithFlag("MainGame StateEnd : "+GameState[this.CurGameState]),e.prototype.StateEnd.apply(this,t),[2]})})},t.prototype.DisableLockFishAutoShoot=function(){this.SeatData.ClearLockTarget(),Time.UnregisterByKey(this.LockShootKey)},t.prototype.EnableLockFishAutoShoot=function(){var e=this;Time.UnregisterByKey(this.LockShootKey),null!=this.SeatData.LockedFairyPos&&(this.AbleToShootBullet()&&this.ClientShootBullet(!0),this.LockShootKey=Time.DelayAction(GameSettings.ShootInterval[this.SeatData.ShootSpeed],function(){e.EnableLockFishAutoShoot()}))},t.prototype.DisableAutoShoot=function(){Time.UnregisterByKey(this.AutoShootKey)},t.prototype.EnableAutoShoot=function(){Debug.LogWarning("開啟自動射擊"),this.DisableAutoShoot(),this.InvokeAutoShoot()},t.prototype.InvokeAutoShoot=function(){var e=this;this.AbleToShootBullet()&&this.ClientShootBullet(),this.AutoShootKey=Time.DelayAction(GameSettings.ShootInterval[this.SeatData.ShootSpeed],function(){e.InvokeAutoShoot()})},t.prototype.EnableSpecialWeaponMode=function(e){},t.prototype.DisableSpecialWeaponMode=function(e){},t.prototype.EnableSpecialWeaponTimeCounter=function(e){var t=this;this.LastLeftTime=-1,this.SeatData.SpecialWeaponShootLeftTime=-1,Time.Stop(this.SpecialWeaponKey),this.SpecialWeaponKey=Time.CountReverseTimeFixUpdate(GameSettings.AutoShootSpecialWeaponMaxSec,function(e){t.OnSpecialWeaponCountDown(e)},function(){e()})},t.prototype.OnSpecialWeaponCountDown=function(e){var t=Method.ParseValueToInt(e);this.LastLeftTime!=t&&(this.LastLeftTime=t,this.SeatData.SpecialWeaponShootLeftTime=t,this.View.UpdateBulletOddsText())},t.prototype.OnServerShootBullet=function(e){if(e){if(this.SeatData.BulletMoney=e.PlayerBulletPool,this.CurAngle=e.ShootAngle,e.LockedFishID){if(this.SeatData.LockedFishID!=e.LockedFishID){this.SeatData.LockedFishID=e.LockedFishID;var t=this.Data.Fishes[this.SeatData.LockedFishID];t&&t.FishObj&&this.LockCtrller.StartLockTarget(t.FishObj.x,t.FishObj.y)}}else this.SeatData.ClearLockTarget();this.ChangeBattery(e.BulletIndex),this.ShootBullet(e.BulletID,e.BulletIndex,e.ShootAngle)}},t.prototype.OnServerShootSpecialBullet=function(e){},t.prototype.OnServerChangeBattery=function(e){this.ChangeBattery(e.BulletIndex)},t.prototype.OnServerGetBalance=function(e,t){if(void 0===t&&(t="0"),e){var n=BigNum(e),o=BigNum(t);if(null!=n&&null!=o){var i=n.toNumber(),a=o.toNumber();this.SeatData.Balance=i,this.SeatData.BulletMoney=a,this.UpdateUI()}else Debug.LogError("data Error : "+e)}},t.prototype.OnServerGetSpecialBullet=function(e){},t.prototype.ChangeBattery=function(e){this.SeatData.CurBulletIndex=e,this.SeatData.CurBatteryIndex=e,this.UpdateUI()},t.prototype.AbleToRotateBattery=function(){return!this.SeatData.HasLockTarget},t.prototype.AbleToShootBullet=function(){return this.Data.SceneStatus==SceneStatus.Wave?!1:this.SeatData.BulletCount<GameSettings.SceneMaxBulletCount},t.prototype.ClientShootBullet=function(e){void 0===e&&(e=!1);var t=this.CurAngle;e?(this.DisableAutoShoot(),t=Method.CalcTwoPosAngle(this.SeatData.LockedFairyPos.x,this.SeatData.LockedFairyPos.y,this.ShootPoint.x,this.ShootPoint.y)+180,this.UpdateUI()):this.DisableLockFishAutoShoot(),this.AbleToShootBullet()&&(this.BulletID++,this.ShootBullet(this.BulletID,this.SeatData.CurBulletIndex,t))},t.prototype.ShootBullet=function(e,t,n){var o=this;this.SeatData.BulletCount++,this.View.UpdateBatteryAngle(n);var i=this.BulletPools[t];if(null==i)return void Debug.LogError("Bullet Pool = null : bulletIndex = "+t);var a=i.GetObj();FUIManager.SetEObjParentToEObj(a,this.View.BulletParent);var r=FUIManager.GetEObjCorScript(a,BulletCtrller);r.Init(this.Data,this.View,function(n,i,r){var s=o.EffectPools[t].GetObj();
s?(a&&(s.Alpha=a.Alpha),FUIManager.SetEObjParentToEObj(s,o.View.BulletParent),s.SetPosition(i,r),s.PlayAni("t0"),Time.DelayAction(.5,function(){s&&(o.EffectPools[t]?o.EffectPools[t].RecycleObj(s):s.SetActive(!1))})):Debug.LogError("生成特效失敗 : bulletIndex = "+t),o.SeatData.BulletCount--;var l=o.BulletPools[t];l.RecycleObj(a),o.OnBulletHitFish(e,t,n)},this.SeatIndex,a,this.SeatData.HasLockTarget),r.Shoot(this.ShootPoint.x,this.ShootPoint.y,n),this.View.OnShootBullet()},t.prototype.OnBulletHitFish=function(e,t,n){n.FishObj.PlayAni("Hit")},t.prototype.UpdateUI=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.AbleToRotateBattery()&&this.View.UpdateBatteryAngle(this.CurAngle),this.View.UpdateUI()},t}(GameCtrllerBase);__reflect(FishingGameCtrllerBase.prototype,"FishingGameCtrllerBase");var GameCtrller=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LaserCtrller=new LaserCtrller,t.FlameCtrller=new FlameCtrller,t.NuclearCtrller=new NuclearCtrller,t.LastBatteryIndex=0,t}return __extends(t,e),t.prototype.Init=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(o){return e.prototype.Init.apply(this,t),this.LaserCtrller.Init(this.Data,this.View,function(e){n.OnSpecialWeaponHitFishes(WeaponType.Laser,e)},this.SeatIndex,this.View.LaserObj),this.FlameCtrller.Init(this.Data,this.View,function(e){n.OnSpecialWeaponHitFishes(WeaponType.Flame,e)},this.SeatIndex,this.View.FlameObj),this.NuclearCtrller.Init(this.Data,this.View,function(e){n.OnSpecialWeaponHitFishes(WeaponType.Bomb,e)},this.SeatIndex),[2]})})},t.prototype.OnServerShootSpecialBullet=function(e){e&&(this.CurAngle=e.ShootAngle,this.View.UpdateBatteryAngle(this.CurAngle),this.FlameCtrller.AllowShoot?this.ShootSpecialWeapon(WeaponType.Flame):this.LaserCtrller.AllowShoot?this.ShootSpecialWeapon(WeaponType.Laser):this.NuclearCtrller.AllowShoot&&this.ShootSpecialWeapon(WeaponType.Bomb))},t.prototype.EnableSpecialWeaponMode=function(t){var n=this;switch(e.prototype.EnableSpecialWeaponMode.call(this,t),this.Data.IsLockMode=!1,this.DisableLockFishAutoShoot(),this.DisableAutoShoot(),this.UpdateUI(),this.LastBatteryIndex=this.SeatData.CurBatteryIndex,t){case WeaponType.Laser:this.SeatData.IsLaserMode=!0,this.ChangeBattery(GameSettings.LaserWeaponIndex),this.LaserCtrller.EnableAim(),this.EnableSpecialWeaponTimeCounter(function(){n.ShootSpecialWeapon(WeaponType.Laser)});break;case WeaponType.Flame:this.SeatData.IsFlameMode=!0,this.ChangeBattery(GameSettings.FlameWeaponIndex),this.FlameCtrller.EnableAim(),this.EnableSpecialWeaponTimeCounter(function(){n.ShootSpecialWeapon(WeaponType.Flame)});break;case WeaponType.Bomb:this.SeatData.IsNuclearMode=!0,this.ChangeBattery(GameSettings.NuclearWeaponIndex),this.NuclearCtrller.EnableAim(),this.EnableSpecialWeaponTimeCounter(function(){n.ShootSpecialWeapon(WeaponType.Bomb)}),this.UpdateUI()}},t.prototype.DisableSpecialWeaponMode=function(e){switch(e){case WeaponType.Laser:this.SeatData.IsLaserMode=!1;break;case WeaponType.Flame:this.SeatData.IsFlameMode=!1;break;case WeaponType.Bomb:this.SeatData.IsNuclearMode=!1}this.ChangeBattery(this.LastBatteryIndex)},t.prototype.AbleToRotateBattery=function(){return this.SeatData.IsLaserMode&&!this.LaserCtrller.AllowShoot?!1:!this.SeatData.HasLockTarget},t.prototype.ShootSpecialWeapon=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:switch(Time.Stop(this.SpecialWeaponKey),t=e){case WeaponType.Flame:return[3,1];case WeaponType.Laser:return[3,3];case WeaponType.Bomb:return[3,5]}return[3,7];case 1:return[4,this.FlameCtrller.Shoot()];case 2:return n.sent(),[3,7];case 3:return this.SeatData.LaserMoney=0,[4,this.LaserCtrller.Shoot()];case 4:return n.sent(),[3,7];case 5:return[4,this.NuclearCtrller.Shoot()];case 6:return n.sent(),[3,7];case 7:return this.DisableSpecialWeaponMode(e),[2]}})})},t.prototype.AbleToShootBullet=function(){return this.Data.SceneStatus==SceneStatus.Wave||this.SeatData.IsLaserMode?!1:this.SeatData.BulletCount<GameSettings.SceneMaxBulletCount},t.prototype.ClientShootBullet=function(t){return void 0===t&&(t=!1),this.SeatData.IsFlameMode?void this.ShootSpecialWeapon(WeaponType.Flame):this.SeatData.IsLaserMode?void this.ShootSpecialWeapon(WeaponType.Laser):this.SeatData.IsNuclearMode?void this.ShootSpecialWeapon(WeaponType.Bomb):(Debug.Log("ClientShootBullet : "+Method.GetLogValueFormat("IsFlameMode",this.SeatData.IsFlameMode,"AllowShoot",this.FlameCtrller.AllowShoot)),void e.prototype.ClientShootBullet.call(this,t))},t.prototype.OnSpecialWeaponHitFishes=function(e,t){},t}(FishingGameCtrllerBase);__reflect(GameCtrller.prototype,"GameCtrller");var BulletColCtrllerBase=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.IsLockMode=!1,t.UpdateKey="",t.SeatIndex=0,t.BulletMoney=0,t.PointEObj=[],t}return __extends(t,e),Object.defineProperty(t.prototype,"DetectPointCount",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsSelfPlayer",{get:function(){return this.Data?this.SeatIndex==this.Data.SelfSeatIndex:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SeatData",{get:function(){return this.Data.Seat[this.SeatIndex]},enumerable:!0,configurable:!0}),t.prototype.Init=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){var n,o,n,o,i;return __generator(this,function(a){if(e.prototype.Init.apply(this,t),this.SeatIndex=t[3],this.EObj=t[4],this.IsLockMode=t[5],this.BulletMoney=t[6],this.BulletMoney||(this.BulletMoney=0),this.EObj){for(n=0,o=this.PointEObj.length;o>n;n++)this.PointEObj[n]&&(this.PointEObj[n]=null);for(this.PointEObj=[],n=0,o=4;o>n;n++)i=this.EObj.GetChild("Point_"+n),i&&this.PointEObj.push(i)}return[2]})})},t.prototype.OnHitFish=function(e,t,n){null!=this.Callback&&this.Callback(e,t,n,this.BulletMoney)},t.prototype.AbleToCol=function(e){return e.AbleToCol},t.prototype.DetectHitedFish=function(e){void 0===e&&(e=!0);var n=!1;if(this.Data.SceneStatus!=SceneStatus.Wave&&this.EObj.ActiveSelf){var o=new egret.Point(this.EObj.x,this.EObj.y);t.ShowLog&&(Debug.LogWithFlag("this.IsLockMode",this.IsLockMode,"this.SeatData.HasLockTarget",this.SeatData.HasLockTarget,"this.SeatData.LockedFishID",this.SeatData.LockedFishID),Time.DelayOneFrameAction(function(){t.ShowLog=!1}));for(var i=this.Data.Fishes.Values,a=0,r=i.length;r>a;a++)if(null!=i[a]&&null!=i[a].FishDBObj&&this.AbleToCol(i[a])&&(!this.IsLockMode||!this.SeatData.HasLockTarget||i[a].ID==this.SeatData.LockedFishID)){for(var s=[],l=0,u=Method.Clamp(this.DetectPointCount,0,this.PointEObj.length);u>l;l++)o=this.PointEObj[l].GlobalPosition,o=i[a].FishDBObj.GlobalToLocal(o.x,o.y),s.push(o);for(var l=0,c=s.length;c>l;l++)if(i[a]){var h=Method.LoopRange(l+1,0,c-1),p=new egret.Point(0,0),d=new egret.Point(0,0),g=i[a].FishDBObj.IntersectsSegment(s[l].x,s[l].y,s[h].x,s[h].y,p,d);if(!g){var y=GameSettings.BulletJudgeHitRange+100;y=this.IsLockMode&&this.SeatData.HasLockTarget?CalcTwoPointDistance(this.SeatData.LockedFairyPos.x,this.SeatData.LockedFairyPos.y,this.EObj.x,this.EObj.y):CalcTwoPointDistance(i[a].FishObj.x,i[a].FishObj.y,this.EObj.x,this.EObj.y),y<=GameSettings.BulletJudgeHitRange&&(g=!0)}if(g&&(n=!0,o=i[a].FishDBObj.LocalToGlobal(.5*(p.x+d.x),.5*(p.y+d.y)),o=this.View.RootEObj.GlobalToLocal(o.x,o.y),this.OnHitFish(i[a],o.x,o.y),e))return n}}return n}},t.ShowLog=!1,t}(GameCtrllerBase);__reflect(BulletColCtrllerBase.prototype,"BulletColCtrllerBase");var HttpHandlerBase=function(){function e(){HttpManager.ins.RegisterHandler(this,this.Callback)}return e.prototype.Clear=function(){HttpManager.ins.UnregisterHandler(this)},e.prototype.Init=function(e){void 0===e&&(e=null),this.Callback=e},e.prototype.SetParams=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e.prototype.ExeAction=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]},e.prototype.Send=function(e,t,n){var o=this;if(IsNetworkEnable())HttpManager.ins.Request(e,t,this.Callback,n);else{var i="NetworkError";MsgWindow.ShowMsg_OKOnly(this.GetErrorLang(i),function(){o.OnClickErrorConfirmBtn(i)})}},e.prototype.GetJsonString=function(e){for(var t="",n=0,o=e.length;o>n;n++)t+='"'+e[n].Key+'" : "'+e[n].Value+(n==o-1?'"':'", ');return"{"+t+"}"},e.prototype.OnMsg=function(e,t){},e.prototype.ExeCallback=function(e,t){this.Callback&&this.Callback(e,t)},e.prototype.HandleError=function(e){var t=this;if(StringIsNullOrEmpty(e))return Debug.LogError("Msg = null"),!1;var n=JSON.parse(e);if(n){var o=n.ErrorCode;return StringIsNullOrEmpty(o)||"success"==o.toLowerCase()?!0:(MsgWindow.ShowMsg_OKOnly(this.GetErrorLang(o),function(){t.OnClickErrorConfirmBtn(o)}),!1)}return Debug.LogError("msg 格式不正確 : "+e),!1},e.prototype.OnClickErrorConfirmBtn=function(e){GlobalMethod.ReloadPage()},e.prototype.GetErrorLang=function(e){var t=LanguageManager.GetText("Msg_"+e);return t?t:e},e}();__reflect(HttpHandlerBase.prototype,"HttpHandlerBase",["IHttpHandlerBase"]);var WebSocketHandlerBase=function(){function e(){}return e.prototype.Init=function(e,t,n){void 0===t&&(t=""),void 0===n&&(n=null),this.Connector=e,this.OpCode=t,this.Callback=n},e.prototype.SetParams=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e.prototype.ExeAction=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]},e.prototype.OnConnect=function(){},e.prototype.OnClose=function(){},e.prototype.SendCustomFormat=function(e,t){for(var n="",o=0,i=t.length;i>o;o++)n+='"'+t[o].Key+'" : "'+t[o].Value+(o==i-1?'"':'", ');this.Send('{"Opcode": "'+e+'", "Data": {'+n+"} }")},e.prototype.Send=function(e){ServerDebug.LogWarning("Send : "+e),this.Connector&&this.Connector.Send(e)},e.prototype.OnMsg=function(e){if(!StringIsNullOrEmpty(this.OpCode)){var t=JSON.parse(e);t.OpCode===this.OpCode&&this.OnResponse(e)}},e.prototype.OnResponse=function(e){},e.prototype.ExeCallback=function(e,t){this.Callback&&this.Callback(e,t)},e.prototype.HandleError=function(e){if(StringIsNullOrEmpty(e))return Debug.LogError("Msg = null"),!1;var t=JSON.parse(e);if(t){var n=t.ErrorCode;if(!StringIsNullOrEmpty(n)&&"success"!=n.toLowerCase()){var o=t.OpCode;return Debug.LogError("OpCode",o,"ErrorCode",n),this.OnErrorMsg(n),!1}return!0}return Debug.LogError("msg 格式不正確 : "+e),!1},e.prototype.OnErrorMsg=function(e){var t=this;MsgWindow.ShowMsg_OKOnly(this.GetErrorLang(e),function(){t.OnClickErrorConfirmBtn(e)})},e.prototype.OnClickErrorConfirmBtn=function(e){Debug.LogError("On ClickErrorConfirmBtn : "+e),GlobalMethod.ReloadPage()},e.prototype.GetErrorLang=function(e){var t=LanguageManager.GetText("Msg_"+e);return t?t:e},e}();__reflect(WebSocketHandlerBase.prototype,"WebSocketHandlerBase",["IWebSocketHandlerBase"]);var HitFishEffectType;!function(e){e[e.Boss=3]="Boss",e[e.FishType_22=4]="FishType_22",e[e.FishType_23=5]="FishType_23",e[e.FishType_24=6]="FishType_24",e[e.FishType_25=7]="FishType_25"}(HitFishEffectType||(HitFishEffectType={}));var LotteryType;!function(e){e[e.Type_Small=0]="Type_Small",e[e.Type_Mid=1]="Type_Mid",e[e.Type_Big=2]="Type_Big",e[e.Type_Top=3]="Type_Top",e[e.Type_Best=4]="Type_Best"}(LotteryType||(LotteryType={}));var GameView=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.SpecialWeaponKey="",t.IsGettingSpecialWeapon=!1,t}return __extends(t,e),Object.defineProperty(t.prototype,"SeatData",{get:function(){return this.Data.Seat[this.SeatIndex]},enumerable:!0,configurable:!0}),t.prototype.Init=function(t,n,o){return __awaiter(this,void 0,void 0,function(){var i,a,r,s,r,s,l=this;return __generator(this,function(u){for(e.prototype.Init.call(this,t,n,o),this.LaserObj=FUIManager.GetEObj(this.RootObj,"Seat_"+o+"/Laser"),this.FlameObj=FUIManager.GetEObj(this.RootObj,"Seat_"+o+"/Flame"),this.NuclearObj=FUIManager.GetEObj(this.RootObj,"NuclearEffect"),this.Battery.push(null),this.Battery.push(FUIManager.GetEObj(this.RootObj,"Seat_"+o+"/Battery_Flame")),this.Battery.push(FUIManager.GetEObj(this.RootObj,"Seat_"+o+"/Battery_Nuclear")),this.Battery.push(FUIManager.GetEObj(this.RootObj,"Seat_"+o+"/Battery_Laser")),i=function(e,t){a.ScoreEffectPools.push(new Pool(function(){return FUIManager.CreateEObjFromResourceByPackageName(GlobalValue.PackageName,l.ScoreEffectResName(e))},function(e){e.SetActive(!0)},function(e){e.SetActive(!1)}))},a=this,r=HitFishEffectType.Boss,s=HitFishEffectType.Boss+Method.GetEnumCount(HitFishEffectType);s>r;r++)i(r,s);for(r=0,s=this.Battery.length;s>r;r++)this.Battery[r]&&this.Battery[r].PlayGLoaderAni();return[2]})})},t.prototype.PlayLaserAni=function(e){var t=this;switch(Time.Stop(this.SpecialWeaponKey),e){case"Aim":this.LaserObj.PlayAni(e),this.UpdateUI();break;case"Shoot":this.LaserObj.PlayAni(e);var n="Laser_"+e,o=this.LaserObj.GetChild(n);o?o.PlayGLoaderAni():Debug.LogError("沒有找到龍骨動畫物件 : "+n),this.SpecialWeaponKey=Time.DelayAction(1.5,function(){t.SeatData.IsLaserMode=!1,t.SeatData.CurBatteryIndex=0,t.UpdateUI()})}},t.prototype.PlayFlameAni=function(e){switch(e){case"Shoot":this.FlameObj.PlayAni(e)}},t.prototype.PlayNuclearAni=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:switch(t=e){case"Aim":return[3,1];case"Shoot":return[3,2]}return[3,4];case 1:return this.SeatObj.PlayAni("Battery_Nuclear_Idle"),[3,4];case 2:return this.SeatObj.PlayAni("Battery_Nuclear_Shoot"),this.Battery[this.SeatData.CurBatteryIndex].SetActive(!1),[4,Time.WaitForSecond(2.2)];case 3:return n.sent(),this.NuclearObj.PlayAni(e),[3,4];case 4:return[2]}})})},t.prototype.ScoreEffectResName=function(e){return"CoinEffect_Others_"+(2>=e?HitFishBaseEffectType[e]:HitFishEffectType[e])},t.prototype.ShowEffect_FishType_Boss=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return e=this.ScoreEffectPools[HitFishEffectType.Boss].GetObj(),FUIManager.SetEObjParentToEObj(e,this.MoneyParent),e.x=GlobalValue.EgretElementWidth/2,e.y=GlobalValue.EgretElementHeight/2,e.PlayAni("Show"),this.PlayScreenShake(),[4,Time.WaitForSecond(4)];case 1:return t.sent(),this.ScoreEffectPools[HitFishEffectType.Boss].RecycleObj(e),[2]}})})},t.prototype.ShowEffect_FishType_25=function(e,t,n,o){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(a){switch(a.label){case 0:return i=this.ScoreEffectPools[HitFishEffectType.FishType_25].GetObj(),FUIManager.SetEObjParentToEObj(i,this.SpecialEffectParent),i.x=GlobalValue.EgretElementWidth/2,i.y=GlobalValue.EgretElementHeight/2,i.PlayAni(LotteryType[e]),this.PlayScreenShake(),this.ShowScoreEffect(HitFishBaseEffectType.Big,t,n,o),[4,Time.WaitForSecond(2)];case 1:return a.sent(),this.ScoreEffectPools[HitFishEffectType.FishType_25].RecycleObj(i),[2]}})})},t.prototype.ShowEffect_FishType_24=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return e=this.ScoreEffectPools[HitFishEffectType.FishType_24].GetObj(),e?(FUIManager.SetEObjParentToEObj(e,this.SpecialEffectParent),e.x=GlobalValue.EgretElementWidth/2,e.y=GlobalValue.EgretElementHeight/2,e.PlayAni("Show")):Debug.LogError("沒有核彈特效"),this.Shake_24(),[4,Time.WaitForSecond(1.7)];case 1:return t.sent(),this.ScoreEffectPools[HitFishEffectType.FishType_24].RecycleObj(e),[2]}})})},t.prototype.Shake_24=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,Time.WaitForSecond(.4)];case 1:return e.sent(),this.PlayScreenShake(),AudioPlayer.PlaySound("CannonNuclear_001_mp3"),[2]}})})},t.prototype.ShowEffect_GetSpecialWeapon=function(e,t,n,o){return __awaiter(this,void 0,void 0,function(){var i,a,r,s;return __generator(this,function(l){switch(l.label){case 0:switch(this.IsGettingSpecialWeapon=!0,i=null,e){case WeaponType.Flame:i=HitFishEffectType.FishType_22;break;case WeaponType.Laser:i=HitFishEffectType.FishType_23;break;case WeaponType.Bomb:i=HitFishEffectType.FishType_24}return(a=this.ScoreEffectPools[i].GetObj())?(FUIManager.SetEObjParentToEObj(a,this.SpecialEffectParent),a.x=t,a.y=n,a.PlayAni("Show"),[4,Time.WaitForSecond(1.2)]):[3,3];case 1:switch(l.sent(),r=new Vector2(0,0),s=GameSettings.SeatShootPos[this.SeatIndex],this.SeatIndex){case 0:case 1:case 2:case 3:r.x=0,r.y=20}return FUIManager.MoveEObjToPos(a,.5,s.x+r.x,s.y+r.y,CurveMethod.EaseInOut),[4,Time.WaitForSecond(.6)];case 2:return l.sent(),this.ScoreEffectPools[i].RecycleObj(a),[3,4];case 3:Debug.LogError("沒有獲得"+WeaponType[e]+"特效"),l.label=4;case 4:return this.IsGettingSpecialWeapon=!1,null!=o&&o(),[2]}})})},t.prototype.UpdateBatteryAngle=function(t){this.SeatData.IsNuclearMode&&(t=90),e.prototype.UpdateBatteryAngle.call(this,t),this.LaserObj&&(this.LaserObj.Angle=t),this.FlameObj&&(this.FlameObj.Angle=t)},t.prototype.ChangeBatteryFX=function(e,t){if(Debug.LogWarning("換砲台特效還沒做"),t==GameSettings.FlameWeaponIndex)AudioPlayer.PlaySound("CannonSwitch_002_mp3");else if(t==GameSettings.NuclearWeaponIndex)AudioPlayer.PlaySound("CannonSwitch_002_mp3");else if(t==GameSettings.LaserWeaponIndex)AudioPlayer.PlaySound("CannonSwitch_002_mp3");else{if(this.SeatObj.PlayAni("LvUp"),this.SkipPlayFirstTime)return void(this.SkipPlayFirstTime=!1);AudioPlayer.PlaySound("CannonSwitch_001_mp3")}},t.prototype.UpdateBattery=function(){e.prototype.UpdateBattery.call(this)},t.prototype.UpdateBulletOddsText=function(){this.SeatData.IsFlameMode||this.SeatData.IsLaserMode||this.SeatData.IsNuclearMode?this.BulletOddText&&(this.SeatData.SpecialWeaponShootLeftTime>=0?this.BulletOddText.Text=this.SeatData.SpecialWeaponShootLeftTime.toString():this.BulletOddText.Text=""):e.prototype.UpdateBulletOddsText.call(this)},t}(FishingGameViewBase);__reflect(GameView.prototype,"GameView");var FishingCommonCtrllerBase=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.MinBalance="",t.MaxBalance="",t.RequestGameType="",t.InputInfo="",t.OriAutoExchangeBalance=!1,t}return __extends(t,e),t.prototype.Init=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(o){return e.prototype.Init.apply(this,t),SendTool.Register("OnClickMsgBG",this,this.OnClickMsgBG),SendTool.Register("OnClickCommonBtn",this,this.OnClickCommonBtn),SendTool.Register("GetWalletExchangeResult",this,this.HandleGetWalletExchangeResult),this.View.WalletMoneyInput.InputLimit="0-9",this.View.WalletSlideBar.RegisterSlideValueChangeEvent(function(e){n.OnWalletSlideBar(e)}),this.View.WalletMoneyInput.RegisterInputChangeEvent(function(e){n.OnWalletInputText(e)}),this.View.WalletMoneyInput.RegisterFocusEvent(function(e){n.OnWalletFocus(e)}),[2]})})},t.prototype.Clear=function(){e.prototype.Clear.call(this),this.View.WalletSlideBar.UnregisterSlideValueChangeEvent(),this.View.WalletMoneyInput.UnregisterInputChangeEvent(),this.View.WalletMoneyInput.UnregisterFocusEvent()},t.prototype.OnClickMsgBG=function(){this.WebView&&this.WebView.IsActive&&this.ClickCommonBtn("Btn_CloseRecord")},t.prototype.OnClickWalletBtn=function(){},t.prototype.OnClickWalletConfirmBtn=function(){AudioPlayer.PlaySound("Button_001_mp3"),SendTool.SendData("CallLobbyAPI","ExchangeBalance",this.Data.ExchangeAmount,this.RequestGameType,this.Data.AutoExchangeBalance)},t.prototype.AbleToExchangeBalance=function(e){this.Data.AbleToExchangeBalance=e},t.prototype.OnServerWalletExchange=function(e){this.AbleToExchangeBalance(e),e?MsgWindow.HideMsg():this.Data.NeedToShowExchangeErrorMsg&&MsgWindow.ShowLangMsg_MsgOnly("Msg_Transferring"),this.ExeExchangeDoneCallback(e)},t.prototype.ExeExchangeDoneCallback=function(e){this.ExchangeDoneCallback&&(this.ExchangeDoneCallback(e),this.ExchangeDoneCallback=null),this.View.SetWalletPanelActive(!1)},t.prototype.HandleGetWalletExchangeResult=function(e,t,n,o){if(!GlobalValue.NeedToOpenWallet)return void o(!0);if(!e){var i=LanguageManager.GetText("Msg_ValueError","MinBalance = null");return void MsgWindow.ShowMsg_OKOnly(i)}if(!t){var i=LanguageManager.GetText("Msg_ValueError","MaxBalance = null");return void MsgWindow.ShowMsg_OKOnly(i)}this.Data.AbleToExchangeBalance=!0,this.RequestGameType=n,this.ExchangeDoneCallback=o,BigNumCompareTo(e,"0")==CompareType.Less&&(e="0"),this.MinBalance=e,this.MaxBalance=t,this.InputInfo=e,this.UpdateUI(),this.View.SetWalletPanelActive(!0)},t.prototype.OnWalletFocus=function(e){e||this.UpdateUI()},t.prototype.OnWalletSlideBar=function(e){var t=BigNumSub(this.MaxBalance,this.MinBalance),n=BigNumMul(t,(.01*this.View.WalletSlideBar.SliderValue).toString()),o=BigNumAdd(this.MinBalance,n,0);this.InputInfo=o,this.UpdateUI()},t.prototype.OnWalletInputText=function(e){var t=e,n=BigNum(e);n||(t=e.substring(0,e.length-1)),this.InputInfo=t,this.UpdateUI()},t.prototype.StateBegin=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(this.UpdateUI(),t=e[0]){case GameTypeState.Lobby:this.View.SetIntroPanelActive(!1),this.View.SetRecordPanelActive(!1),this.View.SetWalletPanelActive(!1)}return[2]})})},t.prototype.UpdateUI=function(){if(e.prototype.UpdateUI.call(this),this.MinBalance&&this.MaxBalance){var t=this.InputInfo;t||(t=this.MinBalance),t=t.replace(",",""),BigNumCompareTo(t,this.MinBalance)==CompareType.Less&&(t=this.MinBalance),BigNumCompareTo(t,this.MaxBalance)==CompareType.Greater&&(t=this.MaxBalance);var n=BigNumSub(t,this.MinBalance),o=BigNumSub(this.MaxBalance,this.MinBalance),i=BigNum("0"==o?1:BigNumDiv(n,o));this.View.WalletSlideBar.Touchable="0"!==o,t=BigNumToFixed(t,0),this.Data.ExchangeAmount=t,this.View.WalletSlideBar.SliderValue=i?100*i.toNumber():0}this.View.UpdateUI()},t.prototype.OnClickCommonBtn=function(e){this.ClickCommonBtn(e.Name,e)},t.prototype.ClickCommonBtn=function(e,t){switch(void 0===t&&(t=null),GameDataBase.ClickUIBtn=!0,e){case"IntroBtn":AudioPlayer.PlaySound("Button_001_mp3"),this.View.SetIntroPanelActive(!0);break;case"IntroBtn_Close":case"IntroBtn_AlphaBG":AudioPlayer.PlaySound("Button_001_mp3"),this.View.SetIntroPanelActive(!1);break;case"RecordBtn":if(AudioPlayer.PlaySound("Button_001_mp3"),IsNetworkEnable()){var n=this.GetRecordUrl();this.WebView=new WebView(n,this.View.RecordRefRange.x,this.View.RecordRefRange.y,this.View.RecordRefRange.Width,this.View.RecordRefRange.Height),this.WebView.SetActive(!0),this.View.SetRecordPanelActive(!0)}else MsgWindow.ShowLangMsg_OKOnly("Msg_NetworkError");break;case"Btn_CloseRecord":AudioPlayer.PlaySound("Button_001_mp3"),this.WebView&&(this.WebView.SetActive(!1),this.WebView=null),this.View.SetRecordPanelActive(!1);break;case"AudioBtn":AudioPlayer.PlaySound("Button_001_mp3"),AudioPlayer.SetMute(!AudioPlayer.IsAudioMute);break;case"WalletBtn":GlobalValue.NeedToOpenWallet&&(this.OriAutoExchangeBalance=this.Data.AutoExchangeBalance,this.OnClickWalletBtn());break;case"WalletBtn_Close":case"WalletBtn_AlphaBG":AudioPlayer.PlaySound("Button_001_mp3"),this.Data.AutoExchangeBalance=this.OriAutoExchangeBalance,this.ExeExchangeDoneCallback(!1);break;case"WalletBtn_AutoBuy":AudioPlayer.PlaySound("Button_001_mp3"),this.Data.AutoExchangeBalance=!this.Data.AutoExchangeBalance,this.UpdateUI();break;case"WalletBtn_MinBet":AudioPlayer.PlaySound("Button_001_mp3"),this.InputInfo=this.MinBalance,this.UpdateUI();break;case"WalletBtn_MaxBet":AudioPlayer.PlaySound("Button_001_mp3"),this.InputInfo=this.MaxBalance,this.UpdateUI();break;case"WalletBtn_Confirm":this.Data.AbleToExchangeBalance&&(this.Data.AbleToExchangeBalance=!1,this.Data.ManualCallExchangeBalance=!0,this.OriAutoExchangeBalance=this.Data.AutoExchangeBalance,this.OnClickWalletConfirmBtn());break;case"ExitBtn":this.OnClickExitBtn()}},t.prototype.OnClickExitBtn=function(){AudioPlayer.PlaySound("Button_001_mp3"),MsgWindow.ShowLangMsg_OKCancel("Msg_BackToLobby",function(e,t){GameDataBase.ClickUIBtn=!0,t==MsgWindowBtnType.LeftBtn&&GameManager.ins.ChangeState(GameTypeState.Lobby)})},t.prototype.GetRecordUrl=function(){var e=this.Data.BetRecordDomain+"?lang="+LanguageType[LanguageManager.CurrentLanguage].toLowerCase()+"&token="+GlobalValue.LoginToken;switch(GameManager.ins.CurGameState){case GameTypeState.Lobby:e+="&gameGroup="+GlobalValue.GameGroup;break;case GameTypeState.Game:e+="&gameType="+GlobalValue.GameType}return Debug.LogWithFlag("下注紀錄Url = "+e),e},t}(GameCtrllerBase);__reflect(FishingCommonCtrllerBase.prototype,"FishingCommonCtrllerBase");var Dictionary=function(){function e(e){if(void 0===e&&(e=null),this.Keys=[],this.Values=[],null!=e)for(var t=0;t<e.length;t++)this[e[t].key]=e[t].value,this.Keys.push(e[t].key),this.Values.push(e[t].value)}return e.prototype.GetKeysToArray=function(e){if(IsNullOrUndefined(e))Debug.LogError("<<Dictionary>> GetKeysToArray array isNullOrUndefined");else for(var t=0,n=this.Keys.length;n>t;++t)e.push(this.Keys[t])},e.prototype.GetValuesToArray=function(e){if(IsNullOrUndefined(e))Debug.LogError("<<Dictionary>> GetValuesToArray array isNullOrUndefined");else for(var t=0,n=this.Values.length;n>t;++t)e.push(this.Values[t])},e.prototype.Update=function(e,t){return this.ContainsKey(e)?(this.Remove(e),this.Add(e,t),!0):(this.Add(e,t),!1)},e.prototype.AddWhenNoKey=function(e,t){return this.ContainsKey(e)||this.Add(e,t),this.GetValueByKey(e)},e.prototype.Add=function(e,t){return this[e]=t,this.Keys.push(e),this.Values.push(t),t},e.prototype.Remove=function(e){var t=this.Keys.indexOf(e,0);t>=0&&(this.Keys.splice(t,1),this.Values.splice(t,1),delete this[e])},e.prototype.RemoveByValue=function(e){var t=this.Values.indexOf(e);if(t>=0){var n=this.Keys[t];this.Keys.splice(t,1),this.Values.splice(t,1),delete this[n]}},e.prototype.ContainsKey=function(e){return this.Keys.indexOf(e)>=0},e.prototype.ContainsValue=function(e){return this.Values.indexOf(e)>=0},e.prototype.GetKeyByIndex=function(e){return e>=0&&this.Keys.length>e?this.Keys[e]:null},e.prototype.GetValueByIndex=function(e){return e>=0&&this.Values.length>e?this.Values[e]:null},e.prototype.GetValueByKey=function(e){var t=this.Keys.indexOf(e);return t>=0?this.Values[t]:null},e.prototype.GetKeyByValue=function(e){var t=this.Values.indexOf(e);return t>=0?this.Keys[t]:null},Object.defineProperty(e.prototype,"Count",{get:function(){return this.Keys.length},enumerable:!0,configurable:!0}),e.prototype.Clear=function(){for(var e=0,t=this.Keys;e<t.length;e++){var n=t[e];delete this[n]}for(;this.Keys.length>0||this.Values.length>0;)this.Keys.pop(),this.Values.pop()},e}();__reflect(Dictionary.prototype,"Dictionary");var AppEvent;!function(e){e[e.OnResize=0]="OnResize",e[e.OnAppPause=1]="OnAppPause",e[e.OnAppResume=2]="OnAppResume",e[e.OnPortrait=3]="OnPortrait",e[e.OnLandscape=4]="OnLandscape",e[e.OnTouchBegin=5]="OnTouchBegin",e[e.OnTouchMove=6]="OnTouchMove",e[e.OnTouchEnd=7]="OnTouchEnd",e[e.OnClick=8]="OnClick",e[e.OnSwipBegin=9]="OnSwipBegin",e[e.OnSwiping=10]="OnSwiping",e[e.OnSwipEnd=11]="OnSwipEnd",e[e.OnWindowHidden=12]="OnWindowHidden",e[e.OnWindowFocus=13]="OnWindowFocus",e[e.OnMouseMove=14]="OnMouseMove"}(AppEvent||(AppEvent={}));var LanguageType;!function(e){e[e.CN=0]="CN",e[e.TW=1]="TW",e[e.EN=2]="EN",e[e.KO=3]="KO",e[e.TH=4]="TH",e[e.VN=5]="VN",e[e.ES=6]="ES",e[e.ID=7]="ID",e[e.JP=8]="JP",e[e.IN=9]="IN",e[e.MY=10]="MY",e[e.RU=11]="RU",e[e.MM=12]="MM",e[e.LA=13]="LA",e[e.AR=14]="AR",e[e.IT=15]="IT",e[e.FR=16]="FR",e[e.DE=17]="DE",e[e.PT=18]="PT"}(LanguageType||(LanguageType={}));var GameMode;!function(e){e[e.Formal=0]="Formal",e[e.TestServer=1]="TestServer",e[e.Local=2]="Local"}(GameMode||(GameMode={}));var OSType;!function(e){e[e.iOS=0]="iOS",e[e.Android=1]="Android",e[e.WindowsPhone=2]="WindowsPhone",e[e.WindowsPC=3]="WindowsPC",e[e.MacOS=4]="MacOS",e[e.Unknown=5]="Unknown"}(OSType||(OSType={}));var WebSocketHandler_Login=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.OnConnect=function(){switch(Debug.Log("On Connect"),GlobalValue.GameMode){case GameMode.Formal:case GameMode.TestServer:var e=GlobalValue.GetCustomIntValue("channelId",1),t=GlobalValue.GetCustomStringValue("data","");this.SendCustomFormat("Login",[{Key:"GameType",Value:GlobalValue.GameType},{Key:"Version",Value:GlobalValue.Version},{Key:"ChannelId",Value:e},{Key:"Data",Value:t},{Key:"Token",Value:GlobalValue.LoginToken},{Key:"GameMode",Value:GlobalValue.GameMode}])}},t.prototype.ExeAction=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];switch(e.prototype.ExeAction.apply(this,[t].concat(n)),t){case"JoinRoom":var i='{"Opcode": "JoinRoom", "Data": {"GameType":"'+GlobalValue.GameType+'"}}';this.Send(i)}},t.prototype.OnClose=function(){MsgWindow.ShowLangMsg_OKOnly("SocketConnectFailed",function(){GlobalMethod.ReloadPage()})},t.prototype.OnMsg=function(e){if(this.HandleError(e)){var t=JSON.parse(e),n=t.OpCode;switch(n){case"Login":var o=t.Data;o?(AppData.Account.Token=o.Token,AppData.Account.PlayerName=o.PlayerName,AppData.Account.ReportUrl=o.ReportUrl,this.JoinGameRoom(n,o)):Debug.LogError(n+' 沒有 ["Data"] 欄位');break;case"JoinRoom":var o=t.Data;null!=o&&(AppData.Account.PlayerID=o.PlayerInfo[0].PlayerID,AppData.Account.Money=o.PlayerInfo[0].PlayerBalance);var i='{"Opcode": "Init", "Data": {}}';this.Send(i),this.ExeCallback(n,JSON.stringify(t));break;case"Init":var o=t.Data;if(o){AppData.Account.Symbol=o.Symbol,AppData.Account.MinBetRate=o.MinBetRate,AppData.Account.MaxBetRate=o.MaxBetRate,AppData.Account.CashScale=o.CashScale,AppData.Account.CashDigits=o.CashDigits,AppData.Account.JPCashType=o.JPCashType,AppData.Account.GameWinRates=o.GameWinRates,AppData.Account.BetMultiples=o.BetMultiples,AppData.Account.CoinIndex=o.DefaultRate-1;var a=o.CustomDisplayCashScale;a>0?AppData.Account.CustomDisplayCashScale=1/a:0>a&&(AppData.Account.CustomDisplayCashScale=Math.abs(a)),AppData.Account.BetSizes=o.BetSizes,AppData.Account.BaseBet=o.BaseBet;for(var r=o.DefaultBet,s=0,l=AppData.Account.BetSizes.length;l>s;s++)if(r==AppData.Account.BetSizes[s]){AppData.Account.BetSizeDefaultIndex=s;break}Method.EachArrayItemMultiplyValue(AppData.Account.BetMultiples,AppData.Account.CustomDisplayCashScale),AppData.Account.BetSizes.length>0&&AppData.Account.BetMultiples.length>0?AppData.Account.BetTotal=Method.MultiplyValues(GlobalValue.NumberDigits,AppData.Account.BetSizes[AppData.Account.BetSizeDefaultIndex],AppData.Account.BetMultiples[0],AppData.Account.BaseBet):Debug.LogError("BetSizes.length = 0 or BetMultiples.length = 0"),SendTool.SendData("LastGameData",JSON.stringify(o.LastGameData)),this.ExeCallback(n,JSON.stringify(t))}}}},t.prototype.Send=function(t){switch(GlobalValue.GameMode){case GameMode.Local:var n=JSON.parse(t),o=n.Opcode;WebSocketManager.ins.SendFakeRespMsg(o,-1,null,null);break;default:e.prototype.Send.call(this,t)}},t.prototype.JoinGameRoom=function(e,t){var n=WebSocketManager.ins.GetGameConnector(null);WebSocketManager.ins.EnterRoom(null,this.Callback,null,n,-1),this.ExeCallback(e,JSON.stringify(t))},t}(WebSocketHandlerBase);__reflect(WebSocketHandler_Login.prototype,"WebSocketHandler_Login");var Main=function(e){function t(){var t=e.call(this)||this;t.OnTouchScreenRect=Vector4.Zero,t.PressKey="",t.IsSwiping=!1,t.MainGameGroups=["Game"],t.ConnectSuccess=!1,t.TotalStep=1,t.HandlerCallback_WebSocket=function(e,n){switch(e){case"Login":t.LoadingView&&t.LoadingView.onProgress(1,t.TotalStep);break;case"Init":t.LoadingView&&t.LoadingView.onProgress(2,t.TotalStep),t.ConnectSuccess=!0}},t.HandlerCallback_Photon=function(e){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];switch(e){case PhotonProtocol.LoginAccountResponse:t.ConnectSuccess||t.LoadingView&&t.LoadingView.onProgress(1,t.TotalStep);break;case PhotonProtocol.LoginLobbyResponse:t.ConnectSuccess||t.LoadingView&&t.LoadingView.onProgress(2,t.TotalStep);break;case PhotonProtocol.JoinGameRoomResponse:t.ConnectSuccess||t.LoadingView&&t.LoadingView.onProgress(3,t.TotalStep),t.ConnectSuccess=!0
}};for(var n=document.getElementById("Egret"),o=n.children,i=0,a=o.length;a>i;i++)if("canvas"==o[0].localName){o[0].id="EgretCanvas";break}return t.SetupCanvasEdge(),t.addEventListener(egret.Event.ADDED_TO_STAGE,t.Start,t),t}return __extends(t,e),Object.defineProperty(t,"CurScreenRect",{get:function(){return AppUIBase.GetObjScreenRect(GlobalValue.EgretElementWidth,GlobalValue.EgretElementHeight,GlobalValue.FitWidthRatio,GlobalValue.FitHeightRatio)},enumerable:!0,configurable:!0}),t.prototype.SetupCanvasEdge=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:if(GlobalValue.OSType!=OSType.iOS)return[3,3];e=document.querySelector(".egret-player"),t=100-2*GlobalValue.IOSCanvasEdgeSizePercent,e.style.width=t+"%",e.style.height=t+"%",e.style.top=GlobalValue.IOSCanvasEdgeSizePercent+"%",e.style.left=GlobalValue.IOSCanvasEdgeSizePercent+"%",n.label=1;case 1:return"0px"==e.style.top?(e.style.top=GlobalValue.IOSCanvasEdgeSizePercent+"%",e.style.left=GlobalValue.IOSCanvasEdgeSizePercent+"%",[3,3]):[4,new Promise(function(e){return setTimeout(e,100)})];case 2:return n.sent(),[3,1];case 3:return[2]}})})},t.prototype.SetupMaxThreadCount=function(){RES.setMaxLoadingThread(16)},t.prototype.Start=function(e){var n=this;this.SetupMaxThreadCount(),Time.Init(),Debug.init(GlobalValue.ShowLog),ServerDebug.init(GlobalValue.ShowServerLog),AudioPlayer.SetMute(!0),this.CalcResizeValue(),this.stage.addEventListener(egret.Event.RESIZE,function(){n.CalcResizeValue()},this),SendTool.Register(FUIManager.HandleClickEventAction,this,this.HandleClickFairyObj),SendTool.Register(FUIManager.HandlePressEventAction,this,this.HandlePressFairyObj),SendTool.Register(FUIManager.HandleMouseHoverEventAction,this,this.HandleMouseHoverFairyObj),SendTool.Register(FUIManager.HandleDataEventAction,this,this.HandleFairyObjData),document.addEventListener("visibilitychange",function(){n.OnApplicationPause(document.hidden),document.hidden?SendTool.SendData(AppEvent[AppEvent.OnWindowHidden]):SendTool.SendData(AppEvent[AppEvent.OnWindowFocus])},!1),window.addEventListener("focus",function(){n.OnApplicationPause(!1)}),egret.lifecycle.onPause=function(){WebView.IsActive||n.OnApplicationPause(!0)},egret.lifecycle.onResume=function(){WebView.IsActive||n.OnApplicationPause(!1)};var o=document.querySelector(".BackgroundImage");if(o&&o.setAttribute("style","-webkit-user-select:none; -moz-user-select:none; -o-user-select:none; user-select:none;"),this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(e){n.IsSwiping=!1,n.OnTouchScreenRect=t.CurScreenRect;var o=AppUIBase.GetEgretScreenToFairyPos(n.OnTouchScreenRect,e.stageX,e.stageY);n.PressKey=Time.DelayAction(.3,function(){n.IsSwiping=!0,SendTool.SendData(AppEvent[AppEvent.OnSwipBegin],o.x,o.y)}),SendTool.SendData(AppEvent[AppEvent.OnTouchBegin],o.x,o.y)},this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,function(e){var t=AppUIBase.GetEgretScreenToFairyPos(n.OnTouchScreenRect,e.stageX,e.stageY);n.IsSwiping&&SendTool.SendData(AppEvent[AppEvent.OnSwiping],t.x,t.y),SendTool.SendData(AppEvent[AppEvent.OnTouchMove],t.x,t.y)},this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,function(e){var t=AppUIBase.GetEgretScreenToFairyPos(n.OnTouchScreenRect,e.stageX,e.stageY);Time.UnregisterByKey(n.PressKey),n.IsSwiping?(n.IsSwiping=!1,SendTool.SendData(AppEvent[AppEvent.OnSwipEnd],t.x,t.y)):SendTool.SendData(AppEvent[AppEvent.OnClick],t.x,t.y),SendTool.SendData(AppEvent[AppEvent.OnTouchEnd],t.x,t.y),n.AudioTouchStart(),n.OnApplicationPause(!1)},this),GlobalValue.IsMobile)if(GlobalValue.OSType==OSType.iOS){document.addEventListener("gesturestart",function(e){e.preventDefault()},!1),document.addEventListener("gesturechange",function(e){e.preventDefault()},!1),document.addEventListener("gestureend",function(e){e.preventDefault()},!1);var i=GlobalValue.GetCustomBoolValue("mask",!0);if(i){window.dispatchEvent(new CustomEvent("initMask"));var a=document.querySelector(".mask"),r=document.querySelector(".finger");a.setAttribute("style","position: absolute; z-Index: "+t.SlideTipElementZIndex+"; top: 0px; left: 0px; border: none; padding: 0px; transform: matrix(1, 0, 0, 1, 0, 0); transform-origin: 0% 0% 0px;"),r.setAttribute("style","position: fixed; z-Index: "+t.SlideTipElementZIndex+"; top: 0px; left: 0px; border: none; padding: 0px; transform: matrix(1, 0, 0, 1, 0, 0); transform-origin: 0% 0% 0px;")}}else this.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,window.launchFullscreen,this);var s=GlobalValue.NoSleep;(s||GlobalValue.IsMobile&&!s)&&(window.nosleep=new window.NoSleep,window.nosleep.enable()),this.OnApplicationPause(!1),this.AudioTouchStart(),this.LoadResources()},t.prototype.LoadResources=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return this.stage.addChild(fairygui.GRoot.inst.displayObject),[4,ResManager.LoadConfig("default_"+LanguageType[this.Language]+".res.json","resource/")];case 1:return n.sent(),[4,ResManager.LoadGroup("Preload")];case 2:return n.sent(),this.OnLoadPreloadComplete(),[4,ResManager.LoadGroup("Loading")];case 3:n.sent(),this.OnLoadLoadingComplete(),null!=this.LoadingView&&this.LoadingView.SetText(LanguageManager.GetText("LoadResource","","",!1)),e=0,t=this.MainGameGroups.length,n.label=4;case 4:return t>e?null==this.LoadingView?[3,6]:[4,ResManager.LoadGroup(this.MainGameGroups[e],t-e,this.LoadingView)]:[3,7];case 5:n.sent(),n.label=6;case 6:return e++,[3,4];case 7:return[4,this.LoadExtensionResources()];case 8:return n.sent(),this.OnLoadMainGameComplete(),[2]}})})},t.prototype.OnLoadLoadingComplete=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},t.prototype.OnLoadPreloadComplete=function(){return __awaiter(this,void 0,void 0,function(){var e,n,o=this;return __generator(this,function(i){AppData.SetupGameConfig(ResManager.GetJson("GameConfig_txt")),AppData.SetupCustomConfig(ResManager.GetJson("CustomConfig_txt")),GlobalValue.SetupAppConfig(ResManager.GetJson("AppConfig_txt")),ResManager.SetVersion(GlobalValue.ClientVersion),LanguageManager.SetupLanguage(ResManager.GetResource("Language_txt")),LanguageManager.ChangeLanguage(this.Language),GlobalValue.AllowPortrait=Method.ParseValueToBoolean(GlobalValue.GetAppConfig("AllowPortrait"),!0),this.CalcResizeValue();try{e=ResManager.GetResource("Language_Game_txt"),null!=e?(LanguageManager.SetupLanguage(e),n=LanguageManager.GetText("GameName","","",!1),StringIsNullOrEmpty(n)||(document.title=n)):Debug.LogWarning("可以在「/resource/Preload/」資料夾底下加入「Language_Game.txt」讓Title文字得以多國語言顯示 (記得掛到default.res.json的Preload裡)")}catch(a){Debug.LogError("Setup GameLanguage Error : "+a)}return GlobalValue.IsMobile||Method.ParseValueToBoolean(GlobalValue.GetAppConfig("EnableMouseOver"),!1)&&(document.addEventListener("mousemove",function(e){o.OnTouchScreenRect=t.CurScreenRect;var n=AppUIBase.GetHtmlScreenToFairyPos(o.OnTouchScreenRect,e.x,e.y);SendTool.SendData(AppEvent[AppEvent.OnMouseMove],n.x,n.y)}),mouse.enable(this.stage)),[2]})})},t.prototype.LoadExtensionResources=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,Time.WaitForDeltaTime()];case 1:return e.sent(),[2]}})})},t.prototype.OnLoadMainGameComplete=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:this.InitGameScene(),e=!1,AudioPlayer.SetVersion(GlobalValue.ClientVersion),AudioPlayer.LoadAudios(ResManager.GetResource("Audio.res_json"),function(){e=!0}),t=LanguageManager.GetText("LoadAudio","","",!1),StringIsNullOrEmpty(t)||this.LoadingView.SetText(t),n.label=1;case 1:return e?[3,3]:[4,Time.WaitForDeltaTime()];case 2:return n.sent(),[3,1];case 3:return t=LanguageManager.GetText("ConnectServer","","",!1),StringIsNullOrEmpty(t)||this.LoadingView.SetText(t),[4,this.ConnectServer_HttpLobby()];case 4:return n.sent(),GlobalValue.UseWebSocket?[4,this.ConnectServer_WebSocket()]:[3,6];case 5:return n.sent(),[3,8];case 6:return[4,this.ConnectServer_Photon()];case 7:n.sent(),n.label=8;case 8:return this.OnStartGameReady(),[2]}})})},Object.defineProperty(t.prototype,"UseLobby",{get:function(){return null!=this.LoginLobbyHandler},enumerable:!0,configurable:!0}),t.prototype.ConnectServer_HttpLobby=function(){return __awaiter(this,void 0,void 0,function(){var e,t=this;return __generator(this,function(n){switch(n.label){case 0:if(null==this.LoginLobbyHandler&&(this.LoginLobbyHandler=this.GetLoginLobbyHandler()),!this.UseLobby)return[3,3];e=!0,this.LoginLobbyHandler.Init(function(n,o){switch(t.OnHttpResp(n,o),o){case"LoginLobby":e=!1}}),this.LoginLobbyHandler.ExeAction("LoginLobby"),n.label=1;case 1:return e?[4,Time.WaitForSecond()]:[3,3];case 2:return n.sent(),[3,1];case 3:return[2]}})})},t.prototype.GetLoginLobbyHandler=function(){return null},t.prototype.OnHttpResp=function(e,t){},t.prototype.ConnectServer_WebSocket=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return this.UseLobby?[3,2]:(e=this.GetLoginGameHandler(),[4,this.ConnectWebSocketServer(this.HandlerCallback_WebSocket,e)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.prototype.GetLoginGameHandler=function(){return new WebSocketHandler_Login},t.prototype.ConnectWebSocketServer=function(e,t,n){return void 0===n&&(n=null),__awaiter(this,void 0,void 0,function(){return __generator(this,function(o){switch(o.label){case 0:this.TotalStep=2,this.ConnectSuccess=!1,this.UseLobby&&this.LoadingView&&this.LoadingView.SetActive(!0),this.LoadingView&&this.LoadingView.onProgress(0,this.TotalStep),null==e&&(e=this.HandlerCallback_WebSocket),WebSocketManager.ins.Login(e,t,n),o.label=1;case 1:return this.ConnectSuccess?[3,3]:[4,Time.WaitForSecond()];case 2:return o.sent(),[3,1];case 3:return this.UseLobby&&this.LoadingView&&this.LoadingView.SetActive(!1),[2]}})})},t.prototype.ConnectServer_Photon=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.ConnectPhotonServer(this.HandlerCallback_Photon,PhotonHandler_Login)];case 1:return e.sent(),[2]}})})},t.prototype.ConnectPhotonServer=function(e,t,n){return void 0===n&&(n=null),__awaiter(this,void 0,void 0,function(){return __generator(this,function(o){switch(o.label){case 0:this.TotalStep=3,this.ConnectSuccess=!1,this.LoadingView&&this.LoadingView.onProgress(0,this.TotalStep),PhotonManager.ins.Login(e,t,n),o.label=1;case 1:return this.ConnectSuccess?[3,3]:[4,Time.WaitForSecond()];case 2:return o.sent(),[3,1];case 3:return[2]}})})},Object.defineProperty(t.prototype,"Language",{get:function(){var e=egret.getOption("language"),t=void 0;return void 0!==e&&null!==e&&e.trim().length>0&&(t=LanguageType[e],void 0===t&&(e=e.toLowerCase(),e.indexOf("en")>=0?e=LanguageType[LanguageType.EN]:e.indexOf("cn")>=0||e.indexOf("ch")>=0?e=LanguageType[LanguageType.CN]:e.indexOf("kr")>=0||e.indexOf("ko")>=0?e=LanguageType[LanguageType.KO]:(e.indexOf("ja")>=0||e.indexOf("jp")>=0)&&(e=LanguageType[LanguageType.JP]),t=LanguageType[e]),void 0===t&&(e=e.toUpperCase(),t=LanguageType[e])),t=this.FilterLanguage(t),IsNullOrUndefined(t)?LanguageType.CN:t},enumerable:!0,configurable:!0}),t.prototype.FilterLanguage=function(e){switch(e){case LanguageType.CN:return LanguageType.CN;case LanguageType.TW:return LanguageType.CN;case LanguageType.EN:return LanguageType.EN;case LanguageType.KO:return LanguageType.KO;case LanguageType.TH:return LanguageType.TH;case LanguageType.VN:return LanguageType.VN;case LanguageType.ES:return LanguageType.ES}return LanguageType.CN},t.prototype.HandleFairyObjData=function(e){return __awaiter(this,void 0,void 0,function(){var t,n,o;return __generator(this,function(i){switch(i.label){case 0:if(StringIsNullOrEmpty(e.Data.LanguageKey))return[3,4];i.label=1;case 1:return LanguageManager.IsSetupComplete?[3,3]:[4,Time.WaitForSecond()];case 2:return i.sent(),[3,1];case 3:e.Text=LanguageManager.GetText(e.Data.LanguageKey,"","",!1),StringIsNullOrEmpty(e.Text)&&Debug.LogError("找不到對應文字key : "+e.Data.LanguageKey+"」，文字物件位置："+e.Hierarchy),i.label=4;case 4:if(!IsNullOrUndefined(e.Data.LanguageTransform))for(t=0,n=e.Data.LanguageTransform.length;n>t;t++)if(o=Method.ParseValueToEnum(LanguageType,e.Data.LanguageTransform[t].Language),o==LanguageManager.CurrentLanguage){IsNullOrUndefined(e.Data.LanguageTransform[t].x)||(e.x=Method.ParseValueToNumber(e.Data.LanguageTransform[t].x,e.x)),IsNullOrUndefined(e.Data.LanguageTransform[t].y)||(e.y=Method.ParseValueToNumber(e.Data.LanguageTransform[t].y,e.y)),IsNullOrUndefined(e.Data.LanguageTransform[t].Width)||(e.Width=Method.ParseValueToNumber(e.Data.LanguageTransform[t].Width,e.Width)),IsNullOrUndefined(e.Data.LanguageTransform[t].Height)||(e.Height=Method.ParseValueToNumber(e.Data.LanguageTransform[t].Height,e.Height)),IsNullOrUndefined(e.Data.LanguageTransform[t].FontSize)||(e.FontSize=Method.ParseValueToNumber(e.Data.LanguageTransform[t].FontSize,e.FontSize));break}return[2]}})})},t.prototype.HandleClickFairyObj=function(e){StringIsNullOrEmpty(e.Data.OnClickPlaySoundName)||AudioPlayer.PlaySound(e.Data.OnClickPlaySoundName),StringIsNullOrEmpty(e.Data.OnClickSendEventName)||SendTool.SendData(e.Data.OnClickSendEventName,e)},t.prototype.HandlePressFairyObj=function(e,t){StringIsNullOrEmpty(e.Data.OnPressSendEventName)||SendTool.SendData(e.Data.OnPressSendEventName,e,t)},t.prototype.HandleMouseHoverFairyObj=function(e,t){if(StringIsNullOrEmpty(e.Data.OnMouseHoverSendEventName)||SendTool.SendData(e.Data.OnMouseHoverSendEventName,e,t),!IsNullOrUndefined(e.Data.OnMouseHoverBehaviour)&&!IsNullOrUndefined(e.Data.OnMouseHoverBehaviour.Target)){var n=FUIManager.GetEObjByPackageResource(e.PackageResource,e.Data.OnMouseHoverBehaviour.Target);if(null!=n){if(t){if(!IsNullOrUndefined(e.Data.OnMouseHoverBehaviour.OnHoverInSetCtrller)){var o=e.Data.OnMouseHoverBehaviour.OnHoverInSetCtrller.CtrllerName,i=Method.ParseValueToInt(e.Data.OnMouseHoverBehaviour.OnHoverInSetCtrller.ToSelectedIndex,-1);n.SetSelectedIndex(o,i)}}else if(!IsNullOrUndefined(e.Data.OnMouseHoverBehaviour.OnHoverOutSetCtrller)){var o=e.Data.OnMouseHoverBehaviour.OnHoverOutSetCtrller.CtrllerName,i=Method.ParseValueToInt(e.Data.OnMouseHoverBehaviour.OnHoverOutSetCtrller.ToSelectedIndex,-1);n.SetSelectedIndex(o,i)}}else Debug.LogErrorWithFlag("Target = null : "+e.Data.OnMouseHoverBehaviour.Target)}},t.prototype.AudioTouchStart=function(){AudioPlayer.IsInited||(AudioPlayer.Init(),AudioPlayer.SetBGMActive(!GlobalValue.AudioMute),AudioPlayer.SetSoundActive(!GlobalValue.AudioMute),AudioPlayer.SetBGMVolume(GlobalValue.AudioVolume),AudioPlayer.SetSoundVolume(GlobalValue.AudioVolume),AudioPlayer.IsBGMActive&&GlobalValue.BGMMute&&AudioPlayer.SetBGMActive(!1))},t.prototype.OnApplicationPause=function(e){t.IsApplicationPause!=e&&(t.IsApplicationPause=e,e?SendTool.SendData(AppEvent[AppEvent.OnAppPause]):SendTool.SendData(AppEvent[AppEvent.OnAppResume]))},t.prototype.CalcResizeValue=function(){var e=!1;innerWidth>innerHeight?(e=!1,this.stage.scaleMode=egret.StageScaleMode.FIXED_WIDTH):(e=!0,GlobalValue.AllowPortrait?this.stage.scaleMode=GlobalValue.ScreenScaleMode:(this.stage.orientation="landscape",this.stage.scaleMode=egret.StageScaleMode.SHOW_ALL)),t.ScreenScaleMode=this.stage.scaleMode,t.IsPortrait!=e&&(t.IsPortrait=e,e?SendTool.SendData(AppEvent[AppEvent.OnPortrait]):SendTool.SendData(AppEvent[AppEvent.OnLandscape])),SendTool.SendData(AppEvent[AppEvent.OnResize])},t.SlideTipElementZIndex=101,t.IsApplicationPause=!1,t.IsPortrait=!0,t.ScreenScaleMode=egret.StageScaleMode.FIXED_WIDTH,t}(eui.UILayer);__reflect(Main.prototype,"Main");var FishingGameManagerBase=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.Views=[],t.Ctrllers=[],t}return __extends(t,e),Object.defineProperty(t.prototype,"SceneObj",{get:function(){return null==this.SObj&&(this.SObj=FUIManager.CreateEObjToSceneByPackageName(GlobalValue.PackageName,"Maingame")),this.SObj},enumerable:!0,configurable:!0}),t.prototype.InitData=function(){},t.prototype.Init=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){var t,n,t,n,o,i=this;return __generator(this,function(a){for(this.AppMain=e[0],this.Data=new GameData,this.Data.LockGroup=[],t=0,n=GameSettings.MaxATKSelectBtnCount;n>t;t++)this.Data.LockGroup.push(!1);for(this.InitData(),t=0,n=GameSettings.MaxSeatCount;n>t;t++)o=new SeatData,this.Data.Seat.push(o);return this.CommonView=new CommonView,this.CommonCtrller=new CommonCtrller,this.CommonView.Init(this.SceneObj,this.Data),this.CommonCtrller.Init(this.Data,this.CommonView),this.LobbyView=new LobbyView,this.LobbyCtrller=new LobbyCtrller,this.LobbyView.Init(this.SceneObj),this.LobbyCtrller.Init(null,this.LobbyView),this.SetupState(GameTypeState.Lobby,this.LobbyCtrller,function(){i.EnterLobby()}),this.SetupState(GameTypeState.Game,null,function(){i.EnterGame()}),GlobalValue.UseAutoBot&&(this.BotCtrller=new FishingAutoBotCtrller,this.BotCtrller.Init()),[2]})})},t.prototype.OnHttpResp=function(e,t){switch(t){case"LoginLobby":this.LobbyData=JSON.parse(e),this.LobbyView.SetupData(this.LobbyData),this.LobbyCtrller.SetupData(this.LobbyData);break;case"Fetch":this.LobbyCtrller.OnFetch(e);break;case"ExchangeBalance":this.CommonCtrller.OnServerWalletExchange(!0)}},t.prototype.Start=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.ChangeState(GameTypeState.Lobby),[2]})})},t.prototype.EnterLobby=function(){for(var e=0,t=this.Data.Seat.length;t>e;e++)this.Data.Seat[e]&&this.Data.Seat[e].Clear();for(var n=0,o=this.Views.length;o>n;n++)this.Views[n]&&this.Views[n].Clear(),this.Views[n]=null;for(var i=0,a=this.Ctrllers.length;a>i;i++)this.Ctrllers[i]&&this.Ctrllers[i].Clear(),this.Ctrllers[i]=null;this.Views=[],this.Ctrllers=[],this.Data.CurRoomInfo=null,Time.SkipAwaitSeconds(),WebSocketManager.ins.Disconnect(),this.BotCtrller&&this.BotCtrller.OnEnterLobby()},t.prototype.EnterGame=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,o,i,a;return __generator(this,function(r){switch(r.label){case 0:return e=new WebSocketHandler_GameLogin,[4,this.AppMain.ConnectWebSocketServer(null,e)];case 1:for(r.sent(),t=this.LobbyData.RoomInfo[this.LobbyData.CurRoomIndex],t&&(this.Data.CurRoomInfo=t),n=0,o=GameSettings.MaxSeatCount;o>n;n++)i=null,a=null,n==this.Data.SelfSeatIndex?(i=new GameView_Self,this.MainCtrller=new GameCtrller_Self,a=this.MainCtrller):(i=new GameView,a=new GameCtrller),this.Views.push(i),this.Ctrllers.push(a),this.Views[n].Init(this.SceneObj,this.Data,n),this.Ctrllers[n].Init(this.Data,this.Views[n],function(){Debug.Log("Done Callback")},n),this.Ctrllers[n].Start();return this.BotCtrller&&this.BotCtrller.OnEnterGame(),[2]}})})},t.prototype.OnPlayerJoin=function(e){var t=this.Data.Seat[e.Seat];t&&(t.Setup(e.ID,e.Name,e.Balance),this.Ctrllers[e.Seat].UpdateUI())},t.prototype.OnPlayerLeave=function(e){var t=this.Data.Seat[e.Seat];t&&(t.Clear(),this.Ctrllers[e.Seat].UpdateUI())},t.prototype.ChangeState=function(t,n){void 0===n&&(n=null);for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){switch(i.label){case 0:return Debug.Log("<<GAME MANAGER>> ChangeState : "+GameTypeState[this.CurGameState]+" to "+GameTypeState[t]),[4,e.prototype.ChangeState.apply(this,[t,n].concat(o))];case 1:return i.sent(),this.CommonCtrller.StateBegin(this.CurGameState),[2]}})})},t.prototype.OnErrorMsg=function(e){switch(Debug.Log("Self On ErrorMsg : "+e),e){case"last_order_being_processed":this.Data.AbleToExchangeBalance=!1,this.Data.NeedToShowExchangeErrorMsg&&MsgWindow.ShowMsg_MsgOnly(this.GetErrorLang(e)),this.MainCtrller?this.MainCtrller.ReRequestExchangeBalance():Debug.LogError("MainCtrller = null 無法重Call換錢");break;case"TransactionFailed":this.Data.TransferFailedTimes++,this.Data.TransferFailedTimes<3?this.MainCtrller.ReRequestExchangeBalance():(this.Data.TransferFailedTimes=0,this.ShowErrorMsg(e));break;case"SinglewalletInsufficientBalance":GameManager.ins.CommonCtrller.OnServerWalletExchange(!0),this.Data.NeedToShowExchangeErrorMsg&&this.ShowErrorMsg(e);break;default:this.ShowErrorMsg(e)}},t.prototype.ShowErrorMsg=function(e){var t=this;MsgWindow.ShowMsg_OKOnly(this.GetErrorLang(e),function(){t.OnClickErrorConfirmBtn(e)})},t.prototype.OnClickErrorConfirmBtn=function(e){switch(e){case"invalid_account":case"InvalidAccount":case"ParameterError":case"idle_too_long":case"wallet_transaction_playerInSpin":GlobalMethod.ReturnToHome();break;case"SystemError":case"JoinGameDataError":case"JoinGameErrorPlayerIsJoin":case"NetworkError":GlobalMethod.ReloadPage();break;case"TransactionFailed":case"SinglewalletInsufficientBalance":}},t.prototype.GetErrorLang=function(e){var t=LanguageManager.GetText("Msg_"+e);return t?t:e},t}(StateMachineFramework);__reflect(FishingGameManagerBase.prototype,"FishingGameManagerBase");var LobbyData=function(){function e(){this.CurRoomIndex=0,this.IsGettingBalance=!1}return e}();__reflect(LobbyData.prototype,"LobbyData");var RoomInfoData=function(){function e(){}return e}();__reflect(RoomInfoData.prototype,"RoomInfoData");var FishBase=function(){function e(e,t,n,o,i,a,r){this.Transform=new Transform,this._waitForCollisionCalculation=!1,this._overlap=!1,this.Id=e,this.MovementSpeed=t,this.Transform.Position=n,this.Price=i,this.HitRate=a,this.Angle=o,this.Collider=r,null!=this.Collider&&(this.Collider.Transform=this.Transform)}return e}();__reflect(FishBase.prototype,"FishBase");var WebSocketFakeDataBase=function(){function e(){}return e.prototype.GetFakeResponse=function(e,t){var n="WebSocketResp_"+(t>=0?e+"_"+t:e)+"_txt",o=ResManager.GetJson(n);return JSON.stringify(o)},e}();__reflect(WebSocketFakeDataBase.prototype,"WebSocketFakeDataBase",["IWebSocketFakeResponse"]);var BulletCtrllerBase=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ToX=0,t.ToY=0,t.NextAngle=0,t.TimeCounter=0,t.NeedDuration=0,t}return __extends(t,e),Object.defineProperty(t.prototype,"DetectPointCount",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Speed",{get:function(){return 1e3},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"HitOneStop",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.Init=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return e.prototype.Init.apply(this,t),[2]})})},t.prototype.Clear=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];Time.UnregisterByKey(this.UpdateKey)},t.prototype.Shoot=function(e,t,n){var o=this;this.Clear(),this.EObj.SetPosition(e,t),this.EObj.Angle=n,this.IsLockMode&&null!=this.SeatData.LockedFairyPos?(this.ToX=this.SeatData.LockedFairyPos.x,this.ToY=this.SeatData.LockedFairyPos.y):this.CalcNextPoint(e,t,n);var i=0;this.UpdateKey=Time.RegisterFixUpdateAndStopKey(function(e){i+=e,i>100&&o.DetectHitedFish(o.HitOneStop)&&o.HitOneStop?o.Clear():o.Move(e/1e3)},this.UpdateKey)},t.prototype.Move=function(e){if(this.TimeCounter+=e,this.Data.SceneStatus==SceneStatus.Wave&&(this.IsLockMode=!1,this.CalcNextPoint(this.EObj.x,this.EObj.y,this.EObj.Angle)),this.IsLockMode&&null!=this.SeatData.LockedFairyPos)this.ToX=this.SeatData.LockedFairyPos.x,this.ToY=this.SeatData.LockedFairyPos.y,this.EObj.Angle=Method.CalcTwoPosAngle(this.EObj.x,this.EObj.y,this.SeatData.LockedFairyPos.x,this.SeatData.LockedFairyPos.y);else{this.IsLockMode&&(this.IsLockMode=!1,this.CalcNextPoint(this.EObj.x,this.EObj.y,this.EObj.Angle));var t=Math.abs(this.ToX-this.EObj.x),n=Math.abs(this.ToY-this.EObj.y);(this.TimeCounter>this.NeedDuration||t<=GameSettings.BulletBufferRange&&n<=GameSettings.BulletBufferRange)&&(this.EObj.Angle=this.NextAngle,this.OnHitEdge(this.EObj.x,this.EObj.y,this.NextAngle),this.CalcNextPoint(this.ToX,this.ToY,this.NextAngle))}var o=CalcTwoPointDistance(this.EObj.x,this.EObj.y,this.ToX,this.ToY)/this.Speed;this.EObj.x+=(this.ToX-this.EObj.x)/o*e,this.EObj.y+=(this.ToY-this.EObj.y)/o*e},t.prototype.OnHitEdge=function(e,t,n){},t.prototype.CalcNextPoint=function(e,t,n){if(this.ToX=e,this.ToY=t,this.NextAngle=0,this.TimeCounter=0,n=Method.FixAngle(n),0==n)this.NextAngle=180-n,this.ToX=GlobalValue.EgretElementWidth;else if(90==n)this.NextAngle=-n,this.ToY=0;else if(180==n)this.NextAngle=180-n,this.ToX=0;else if(270==n)this.NextAngle=-n,this.ToY=GlobalValue.EgretElementHeight;else{var o=-MathTan(n,1/0);90>n?(this.NextAngle=180-n,this.ToX=GlobalValue.EgretElementWidth,this.ToY=o*(this.ToX-e)+t,this.ToY<0&&(this.NextAngle=-n,this.ToY=0,this.ToX=(this.ToY-t)/o+e)):180>n?(this.NextAngle=180-n,this.ToX=0,this.ToY=o*(this.ToX-e)+t,this.ToY<0&&(this.NextAngle=-n,this.ToY=0,this.ToX=(this.ToY-t)/o+e)):270>n?(this.NextAngle=180-n,this.ToX=0,this.ToY=o*(this.ToX-e)+t,this.ToY>GlobalValue.EgretElementHeight&&(this.NextAngle=-n,this.ToY=GlobalValue.EgretElementHeight,this.ToX=(this.ToY-t)/o+e)):360>n&&(this.NextAngle=180-n,this.ToX=GlobalValue.EgretElementWidth,this.ToY=o*(this.ToX-e)+t,this.ToY>GlobalValue.EgretElementHeight&&(this.NextAngle=-n,this.ToY=GlobalValue.EgretElementHeight,this.ToX=(this.ToY-t)/o+e))}this.NeedDuration=CalcTwoPointDistance(e,t,this.ToX,this.ToY)/this.Speed},t}(BulletColCtrllerBase);__reflect(BulletCtrllerBase.prototype,"BulletCtrllerBase");var FishCtrllerBase=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.FishObjsPool=new Dictionary,t.WaveKey="",t.ClearFlag=!1,t}return __extends(t,e),Object.defineProperty(t.prototype,"CurScreenRect",{get:function(){return AppUIBase.GetObjScreenRect(GlobalValue.EgretElementWidth,GlobalValue.EgretElementHeight,GlobalValue.FitWidthRatio,GlobalValue.FitHeightRatio)},enumerable:!0,configurable:!0}),t.prototype.WaitForSpecialWeapon=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return this.Data.Seat[e].AbleToEnableSpecialWeapon?[3,2]:[4,Time.WaitForSecond()];case 1:return n.sent(),[3,0];case 2:return GameManager.ins.Ctrllers[e].EnableSpecialWeaponMode(t),[2]}})})},t.prototype.Init=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(o){return e.prototype.Init.apply(this,t),SendTool.Register(AppEvent[AppEvent.OnClick],this,function(e,t){if(!n.View.IsUIEnable)for(var o=n.View.RootEObj.LocalToGlobal(e,t),i=n.Data.Fishes.Keys,a=0,r=i.length;r>a;a++){var s=n.Data.Fishes.GetValueByKey(i[a]);if(s){if(null==s.FishDBObj||0==s.AbleToCol)continue;if(null==s.FishDBObj.GObj)continue;var l=s.FishDBObj.GlobalToLocal(o.x,o.y),u=s.FishDBObj.ContainsPoint(l.x,l.y);if(u)return void n.Callback(s)}}}),[2]})})},t.prototype.OnUpdateFish=function(e){if(e){var t=!1;e.AddFish.length>0&&(Time.UnregisterByKey(this.WaveKey),this.Data.SceneStatus=SceneStatus.Normal);for(var n=0,o=e.DieOrRemoveFish.length;o>n;n++)e.DieOrRemoveFish[n].Hit&&(this.OnHitOrKillFish(e.DieOrRemoveFish[n]),this.Data.Seat[e.DieOrRemoveFish[n].HitSeat]&&(e.DieOrRemoveFish[n].ErrorCode?"success"==e.DieOrRemoveFish[n].ErrorCode.toLowerCase()?t=!0:Debug.LogError("DieOrRemoveFish 收到 ErrorCode : "+e.DieOrRemoveFish[n].ErrorCode):t=!0,t&&(this.Data.Seat[e.DieOrRemoveFish[n].HitSeat].Balance=e.DieOrRemoveFish[n].PlayerBalance,this.Data.Seat[e.DieOrRemoveFish[n].HitSeat].BulletMoney=e.DieOrRemoveFish[n].PlayerBulletPool,Debug.LogWarning("DieOrRemoveFish 收到 Balance : "+e.DieOrRemoveFish[n].PlayerBalance+" / Pool : "+e.DieOrRemoveFish[n].PlayerBulletPool)))),e.DieOrRemoveFish[n].HitDieRemove&&this.RemoveFish(e.DieOrRemoveFish[n].FishID);if(null!=e.AddFish)for(var n=0,o=e.AddFish.length;o>n;n++)this.AddFish(e.AddFish[n]);if(null!=e.HitUpdateBalance)for(var n=0,o=e.HitUpdateBalance.length;o>n;n++)this.Data.Seat[e.HitUpdateBalance[n].HitSeat]&&(e.HitUpdateBalance[n].ErrorCode?"success"==e.HitUpdateBalance[n].ErrorCode.toLowerCase()?t=!0:Debug.LogError("HitUpdateBalance 收到 ErrorCode : "+e.HitUpdateBalance[n].ErrorCode):t=!0,t&&(this.Data.Seat[e.HitUpdateBalance[n].HitSeat].Balance=e.HitUpdateBalance[n].PlayerBalance,this.Data.Seat[e.HitUpdateBalance[n].HitSeat].BulletMoney=e.HitUpdateBalance[n].PlayerBulletPool,Debug.LogWarning("HitUpdateBalance 收到 Balance : "+e.HitUpdateBalance[n].PlayerBalance+" / Pool : "+e.HitUpdateBalance[n].PlayerBulletPool)));if(t)for(var n=0,o=GameManager.ins.Views.length;o>n;n++){var i=GameManager.ins.Views[n];null!=i&&i.UpdateBalance()}}},t.prototype.OnFishWave=function(e){var t=this;this.Data.SceneStatus=SceneStatus.Wave,this.View.OnFishWave(e);var n=200,o=0,i=0,a=[],r=1680/this.View.FishWaveDuration;Time.UnregisterByKey(this.WaveKey),this.WaveKey=Time.RegisterFixUpdate(function(e){if(o=e/1e3,i+=o,i>=3){n+=r*o,a=t.Data.Fishes.Keys;for(var s=0,l=a.length;l>s;s++){var u=t.Data.Fishes.GetValueByKey(a[s]);u&&u.FishObj&&n>u.FishObj.x&&t.OnWaveHitFish(u,n)}}})},t.prototype.OnFishWaveWarning=function(e){this.Data.SceneStatus=SceneStatus.Wave,this.View.OnFishWaveWarning(e)},t.prototype.OnWaveHitFish=function(e,t){e.FishWave=!0,this.View.UpdateFishMove(e,t,e.FishObj.y,e.FishObj.Rotation)},t.prototype.AddFish=function(e){return __awaiter(this,void 0,void 0,function(){var t,n=this;return __generator(this,function(o){switch(o.label){case 0:return t=this.GenerateFish(e.FishID,e.FSType),null==t?(Debug.LogError("沒辦法生成魚 : "+e.FishID+" Type : "+FishType[e.FSType]),[2]):(t.FishObj.SetActive(!1),[4,Time.WaitForSecond()]);case 1:return o.sent(),null==t.FishObj?(Debug.LogError("已經被清掉?"+Method.GetLogValueFormat("fishData.ID",e.FishID,"FSType",e.FSType)),[2]):null==t.FishDBObj.GObj?(Debug.LogError("龍骨動畫有問題 "+Method.GetLogValueFormat("fishData.ID",e.FishID,"FSType",e.FSType)),this.RemoveFish(e.FishID),[2]):(this.OnAddFish(e,t),t.FishObj.x=e.X,t.FishObj.y=e.Y,t.FishObj.Rotation=e.Angle,t.FishObj.SetActive(!0),this.PlayIdleAni(t),FishPathLogic.RunFish(e,function(e,t,o){var i=n.Data.Fishes.GetValueByKey(e);n.Data.SceneStatus==SceneStatus.Wave&&i.FishWave||n.UpdateFishTransform(i,t,o)}),[2])}})})},t.prototype.PlayIdleAni=function(e){e.FishObj.PlayGLoaderAni(),e.FishObj.PlayAni("idle"),e.FishDBObj.PlayAni("idle")},t.prototype.UpdateFishTransform=function(e,t,n){this.View.UpdateFishMove(e,t.x,t.y,n)},t.prototype.GenerateFish=function(e,t){var n=null,o="FishObj_"+FishType[t];this.FishObjsPool.ContainsKey(t)||this.FishObjsPool.Add(t,new Pool(function(){return FUIManager.GetDynamicEObjByPackageName(GlobalValue.PackageName,o)},function(e){e.SetActive(!0)},function(e){e.SetActive(!1)}));var i=this.FishObjsPool[t];return n=i.GetObj(),null==n?(Debug.LogError("生成魚 : "+o+" 有問題, FSType = "+t),null):(FUIManager.SetEObjParentToEObj(n,this.View.FishParent),this.Data.Fishes.ContainsKey(e)?(Debug.LogWithFlag("沒有移除就有 ADD FISH ID : "+e),null):(this.Data.Fishes.Add(e,new FishData(e,n,t)),this.Data.Fishes.GetValueByKey(e)))},t.prototype.Clear=function(){var e=this;this.ClearFlag=!0,Time.UnregisterByKey(this.WaveKey);for(var t=this.Data.Fishes.Keys,n=0,o=t.length;o>n;n++)this.RemoveFish(t[0]);Time.DelayOneFrameAction(function(){e.ClearFlag=!1})},t.prototype.RemoveFish=function(e){var t=this.Data.Fishes.GetValueByKey(e);null!=t&&(FishPathLogic.RemoveFish(e),this.FishObjsPool.ContainsKey(t.FishType)||this.FishObjsPool.Add(t.FishType,new Pool),this.RecycleFish(e,t.FishType,t.FishObj),t.Clear(),t=null,this.Data.Fishes.Remove(e))},t.prototype.RecycleFish=function(e,t,n){return __awaiter(this,void 0,void 0,function(){var o,i;return __generator(this,function(a){return n.x=4*GlobalValue.EgretElementWidth,n.y=4*GlobalValue.EgretElementHeight,o=this.Data.Fishes.GetValueByKey(e),o&&(o.FishObj&&o.FishObj.StopPlayingAni(!1,!1),o.FishDBObj&&o.FishDBObj.StopAni()),i=this.FishObjsPool[t],i&&n?i.RecycleObj(n):Debug.LogError(t+" 回收物件「"+n+"」失敗"),[2]
})})},t}(GameCtrllerBase);__reflect(FishCtrllerBase.prototype,"FishCtrllerBase");var ProgramSyntax=function(){function e(){}return e}();__reflect(ProgramSyntax.prototype,"ProgramSyntax");var Vector2=function(){function e(e,t){this.x=0,this.y=0,this.x=e,this.y=t}return e.prototype.toString=function(){return"("+this.x+", "+this.y+")"},Object.defineProperty(e,"Zero",{get:function(){return new e(0,0)},enumerable:!0,configurable:!0}),e}();__reflect(Vector2.prototype,"Vector2");var Vector2Range=function(){function e(e,t,n,o){this.Min=new Vector2(e,t),this.Max=new Vector2(n,o)}return e.prototype.GetRandomPoint=function(){return new Vector2(Method.RandomRange(this.Min.x,this.Max.x),Method.RandomRange(this.Min.y,this.Max.y))},e.prototype.GetRandomIntPoint=function(){return new Vector2(Method.RandomIntRange(this.Min.x,this.Max.x),Method.RandomIntRange(this.Min.y,this.Max.y))},e}();__reflect(Vector2Range.prototype,"Vector2Range");var Vector3=function(){function e(e,t,n){this.x=0,this.y=0,this.z=0,this.x=e,this.y=t,this.z=n}return e.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},Object.defineProperty(e,"Zero",{get:function(){return new e(0,0,0)},enumerable:!0,configurable:!0}),e}();__reflect(Vector3.prototype,"Vector3");var Vector4=function(){function e(e,t,n,o){this.x=0,this.y=0,this.z=0,this.w=0,this.x=e,this.y=t,this.z=n,this.w=o}return e.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},Object.defineProperty(e,"Zero",{get:function(){return new e(0,0,0,0)},enumerable:!0,configurable:!0}),e}();__reflect(Vector4.prototype,"Vector4");var FishingGameCtrllerBase_Self=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.CurShootTime=0,t.IsSwiping=!1,t.AbleSelectType=[],t.AFKLockShootKey="",t.GetBalanceKey="",t.ReqBalance="",t.AutoBuyIn=!1,t}return __extends(t,e),t.prototype.AbleToRotateBattery=function(){return this.Data.IsAFKMode||this.Data.IsLockMode||this.View.IsUIEnable?!1:!0},t.prototype.Init=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){var n,o=this;return __generator(this,function(i){return e.prototype.Init.apply(this,t),this.FishCtrller=new FishCtrller,this.FishCtrller.Init(this.Data,this.View,function(e){o.OnTouchFish(e)}),n=new WebSocketHandler_ThisGame,this.SocketHandler=WebSocketManager.ins.RegisterHandler(n,"ThisGame",function(e,t){o.OnSocketCallback(e,t)}),this.Data.AFKBulletLeftCount=GameSettings.AFKShootBulletCount[this.Data.AFKBulletCountIndex],SendTool.Register(AppEvent[AppEvent.OnTouchBegin],this,function(e,t){o.IsSwiping=!1,o.SeatData.CurMouseFairyPos=new Vector2(e,t)}),SendTool.Register(AppEvent[AppEvent.OnSwipBegin],this,function(e,t){o.IsSwiping=!0,o.AbleToRotateBattery()&&(o.UpdateTouchBattery(e,t),o.EnableAutoShoot())}),SendTool.Register(AppEvent[AppEvent.OnSwiping],this,function(e,t){o.AbleToRotateBattery()&&o.UpdateTouchBattery(e,t)}),SendTool.Register(AppEvent[AppEvent.OnSwipEnd],this,function(e,t){o.OnSwipEnd(e,t)}),SendTool.Register(AppEvent[AppEvent.OnClick],this,function(e,t){o.OnTouchTap(e,t)}),GlobalValue.IsMobile||(document.addEventListener("keyup",function(e){e.which==KeyCode.Escape&&GameManager.ins.CommonCtrller.ClickCommonBtn("ExitBtn")}),SendTool.Register(AppEvent[AppEvent.OnMouseMove],this,function(e,t){if(o.AbleToRotateBattery()&&!o.IsSwiping){Main.CurScreenRect;o.SeatData.CurMouseFairyPos=new Vector2(e,t),o.CurAngle=Method.CalcTwoPosAngle(o.ShootPoint.x,o.ShootPoint.y,e,t),o.UpdateBattery()}})),SendTool.Register("OnClickGameBtn",this,this.OnClickGameBtn),[2]})})},t.prototype.Clear=function(){e.prototype.Clear.call(this),this.FishCtrller.Clear(),this.DisableAFKMode(),this.DisableAutoShoot(),this.DisableLockFishAutoShoot(),WebSocketManager.ins.UnregisterHandler(this.SocketHandler,""),SendTool.UnregisterActionAllMethod("OnClickGameBtn"),SendTool.UnregisterActionAllMethod(AppEvent[AppEvent.OnTouchBegin]),SendTool.UnregisterActionAllMethod(AppEvent[AppEvent.OnSwipBegin]),SendTool.UnregisterActionAllMethod(AppEvent[AppEvent.OnSwiping]),SendTool.UnregisterActionAllMethod(AppEvent[AppEvent.OnSwipEnd]),SendTool.UnregisterActionAllMethod(AppEvent[AppEvent.OnClick]),SendTool.UnregisterActionAllMethod(AppEvent[AppEvent.OnMouseMove])},t.prototype.OnSwipEnd=function(e,t){this.IsSwiping=!1,this.DisableAutoShoot()},t.prototype.OnTouchTap=function(e,t){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(o){switch(o.label){case 0:return[4,Time.WaitForDeltaTime()];case 1:return o.sent(),GameDataBase.ClickUIBtn?(GameDataBase.ClickUIBtn=!1,[2]):this.AbleToRotateBattery()?(this.UpdateTouchBattery(e,t),this.SeatData.CurMouseFairyPos=new Vector2(e,t),this.CurAngle=Method.CalcTwoPosAngle(this.ShootPoint.x,this.ShootPoint.y,this.SeatData.CurMouseFairyPos.x,this.SeatData.CurMouseFairyPos.y),n=(Time.MsTime-this.CurShootTime)/1e3,n<GameSettings.ShootInterval[this.SeatData.ShootSpeed]?[2]:(this.CurShootTime=Time.MsTime,this.ClientShootBullet(),[2])):[2]}})})},t.prototype.ClientShootBullet=function(t){void 0===t&&(t=!1),e.prototype.ClientShootBullet.call(this,t)},t.prototype.UpdateTouchBattery=function(e,t){this.SeatData.CurMouseFairyPos=new Vector2(e,t),this.CurAngle=Method.CalcTwoPosAngle(this.ShootPoint.x,this.ShootPoint.y,this.SeatData.CurMouseFairyPos.x,this.SeatData.CurMouseFairyPos.y),this.UpdateUI()},t.prototype.Start=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return e.prototype.Start.apply(this,t),this.SocketHandler.ExeAction("Init"),this.View.SetSeatEffectActive(),this.InvokeBalance(),this.PlayBGM(),[2]})})},t.prototype.AbleToShootBullet=function(){var t=e.prototype.AbleToShootBullet.call(this);return!t&&this.SeatData.BulletCount>=GameSettings.SceneMaxBulletCount&&this.View.SetNoBulletTipActive(),t},t.prototype.OnTouchFish=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return!this.Data.IsLockMode||this.Data.IsAFKMode?[3,2]:e?(this.SeatData.LockedFishID=e.ID,this.LockCtrller.StartLockTarget(this.SeatData.CurMouseFairyPos.x,this.SeatData.CurMouseFairyPos.y),[4,Time.WaitForSecond()]):[3,2];case 1:t.sent(),this.EnableLockFishAutoShoot(),t.label=2;case 2:return[2]}})})},Object.defineProperty(t.prototype,"FilterSelectType",{get:function(){return[]},enumerable:!0,configurable:!0}),t.prototype.SetupAbleSelectType=function(){this.AbleSelectType=[];for(var e=this.Data.FishSetting.Values,t=0,n=e.length;n>t;t++){var o=e[t];this.Data.LockGroup[o.GroupIndex]&&this.FilterSelectType.indexOf(o.FishType)<0&&this.AbleSelectType.push(o.FishType)}},t.prototype.EnableSpecialWeaponMode=function(t){this.View.PlayerCtrlBtn&&this.View.PlayerCtrlBtn.SetActive(!1),e.prototype.EnableSpecialWeaponMode.call(this,t)},t.prototype.DisableSpecialWeaponMode=function(t){this.View.PlayerCtrlBtn&&this.View.PlayerCtrlBtn.SetActive(!0),e.prototype.DisableSpecialWeaponMode.call(this,t)},t.prototype.EnableAFKMode=function(){if(this.Data.IsAFKMode=!0,this.Data.EnableAFKBulletLimit&&(this.Data.AFKBulletLeftCount=GameSettings.AFKShootBulletCount[this.Data.AFKBulletCountIndex]),this.SetupAbleSelectType(),!StringIsNullOrEmpty(this.SeatData.LockedFishID)){var e=this.Data.Fishes[this.SeatData.LockedFishID];e?this.AbleSelectType.indexOf(e.FishType)<0&&this.SeatData.ClearLockTarget():this.SeatData.ClearLockTarget()}this.InvokeAFKAutoShoot()},t.prototype.InvokeAFKAutoShoot=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n=this;return __generator(this,function(o){switch(o.label){case 0:return this.Data.IsAFKMode?StringIsNullOrEmpty(this.SeatData.LockedFishID)?(this.SeatData.LockedFishID=this.GetAFKModeLockTarget(),StringIsNullOrEmpty(this.SeatData.LockedFishID)?[3,2]:(e=this.Data.Fishes[this.SeatData.LockedFishID])?(this.LockCtrller.StartLockTarget(e.x,e.y),[4,Time.WaitForSecond()]):[3,2]):[3,2]:[2];case 1:o.sent(),o.label=2;case 2:return t=!0,MsgWindow.IsActive?t=!1:!StringIsNullOrEmpty(this.SeatData.LockedFishID)&&this.AbleToShootBullet()&&(this.Data.EnableAFKBulletLimit?this.Data.AFKBulletLeftCount>0?(this.Data.AFKBulletLeftCount--,this.ClientShootBullet(!0)):t=!1:this.ClientShootBullet(!0)),Time.UnregisterByKey(this.AFKLockShootKey),t?this.AFKLockShootKey=Time.DelayAction(GameSettings.ShootInterval[this.SeatData.ShootSpeed],function(){n.InvokeAFKAutoShoot()}):this.DisableAFKMode(),[2]}})})},t.prototype.GetAFKModeLockTarget=function(){if(this.Data.SceneStatus==SceneStatus.Wave||0==this.Data.Fishes.Count)return"";for(var e=[],t=this.Data.Fishes.Values,n=0,o=t.length;o>n;n++)if(this.AbleSelectType.indexOf(t[n].FishType)>=0){if(t[n].x<0||t[n].x>GlobalValue.EgretElementWidth||t[n].y<0||t[n].y>GlobalValue.EgretElementHeight)continue;e.indexOf(t[n].ID)<0?e.push(t[n].ID):Debug.LogError("場上有重複ID的魚 : "+Method.GetLogValueFormat("FishType",t[n].FishType,"ID",t[n].ID))}var i=Method.RandomIntRange(0,e.length-1);return e[i]},t.prototype.DisableAFKMode=function(){this.Data.IsAFKMode=!1,this.Data.AFKBulletLeftCount=0,this.Data.EnableAFKBulletLimit=!1,Time.UnregisterByKey(this.AFKLockShootKey),Method.EachArrayItemSetValue(this.Data.LockGroup,!1),this.SeatData.ClearLockTarget()},t.prototype.InvokeBalance=function(){var e=this;this.SocketHandler.ExeAction("GetBalance",this.SeatData.PlayerID),this.GetBalanceKey=Time.StopAndDelayAction(5,function(){e.InvokeBalance()},this.GetBalanceKey)},t.prototype.ShootBullet=function(t,n,o){var i=this.Data.BetOdd[this.SeatData.CurBulletIndex];i||(i=0);var a=this.Data.ExchangeAmount&&this.Data.AutoExchangeBalance;if(a){var r=BigNum(this.Data.ExchangeAmount);if(null!=r){var s=r.toNumber();this.SeatData.DisplayBalance-i<=.5*s&&(this.Data.AbleToExchangeBalance?(this.Data.AbleToExchangeBalance=!1,this.Data.ManualCallExchangeBalance=!1,this.ReRequestExchangeBalance()):Debug.LogError("目前狀態無法要錢 : AbleToExchangeBalance = "+this.Data.AbleToExchangeBalance))}}this.SeatData.DisplayBalance>=i?(e.prototype.ShootBullet.call(this,t,n,o),AudioPlayer.PlaySound("CannonBullet_00"+(n+1)+"_mp3"),this.OnShootBullet(t,n,o)):(this.DisableAFKMode(),this.DisableAutoShoot(),this.DisableLockFishAutoShoot(),a?this.Data.AbleToExchangeBalance?this.View.SetMoneyNotEnoughTipActive():MsgWindow.ShowLangMsg_MsgOnly("Msg_Transferring"):(Debug.LogError("目前狀態無法要錢 : AbleToExchangeBalance = "+this.Data.AbleToExchangeBalance),this.View.SetMoneyNotEnoughTipActive()))},t.prototype.OnShootBullet=function(e,t,n){this.SocketHandler.ExeAction("ShootBullet",this.SeatData.PlayerID,this.SeatIndex,e,t,n,this.SeatData.LockedFishID)},t.prototype.OnBulletHitFish=function(t,n,o){e.prototype.OnBulletHitFish.call(this,t,n,o),AudioPlayer.PlaySound("CannonBulletHit_001_mp3"),this.SocketHandler.ExeAction("HitFish",this.SeatData.PlayerID,this.SeatIndex,t,this.Data.BetOdd[n],o)},t.prototype.ReRequestExchangeBalance=function(){this.OnClickWalletConfirmBtn(this.ReqBalance,this.AutoBuyIn)},t.prototype.OnClickWalletConfirmBtn=function(e,t){this.ReqBalance=e,this.AutoBuyIn=t,this.ReqBalance||(this.ReqBalance=this.Data.ExchangeAmount),this.SocketHandler.ExeAction("ExchangeBalance",this.ReqBalance,this.AutoBuyIn)},t.prototype.OnFishWave=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.FishCtrller.OnFishWave(e),[4,Time.WaitForSecond(3)];case 1:return t.sent(),AudioPlayer.PlayBGM("BgmFish_001_mp3",1.5),[2]}})})},t.prototype.OnFishWaveWarning=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return this.FishCtrller.OnFishWaveWarning(e),AudioPlayer.PlayBGM("BgmFish_001_mp3",1.5),[2]})})},t.prototype.PlayBGM=function(){AudioPlayer.PlayBGM("Bgm_001_mp3",1.5)},t.prototype.OnUpdateFish=function(e){this.FishCtrller.OnUpdateFish(e)},t.prototype.OnServerShootBullet=function(e){e&&(this.SeatData.BulletMoney=e.PlayerBulletPool),this.UpdateUI()},t.prototype.OnServerShootSpecialBullet=function(e){},t.prototype.OnServerChangeBattery=function(e){},t.prototype.OnSocketCallback=function(e,t){switch(e){case"GetGameInitDataResult":var n=JSON.parse(t);this.OnServerInitData(n)}},t.prototype.OnServerInitData=function(e){this.FishCtrller.Clear();var t=Method.ParseValueToInt(e.FixedTimeMS,32);t&&(Time.FIXED_UPDATE_DELTA_TIME=t),(!Time.FIXED_UPDATE_DELTA_TIME||Time.FIXED_UPDATE_DELTA_TIME<=0)&&(Time.FIXED_UPDATE_DELTA_TIME=32);var n=Method.ParseValueToInt(e.BackGroundID,-1);if(this.View.SetupBG(n),e.FishGroup)for(var o=0,i=e.FishGroup.length;i>o;o++){var a=new FishSettingData(e.FishGroup[o].FSType,e.FishGroup[o].Group,e.FishGroup[o].MinOdd,e.FishGroup[o].MaxOdd);this.Data.FishSetting.Update(e.FishGroup[o].FSType,a)}if(e.AllBet){this.Data.BetOdd=[];for(var o=0,i=e.AllBet.length;i>o;o++)this.Data.BetOdd.push(e.AllBet[o])}for(var o=0,i=e.AddFish.length;i>o;o++)this.FishCtrller.AddFish(e.AddFish[o]);e.FreeGameCount&&e.FreeGameCount>0&&(this.SeatData.SpecialWeaponBulletCount=e.FreeGameCount,this.EnableSpecialWeaponMode(WeaponType.Dragon)),this.FixFishSettingData(),this.UpdateUI()},t.prototype.FixFishSettingData=function(){for(var e=0,t=this.FilterSelectType.length;t>e;e++){var n=this.FilterSelectType[e],o=this.Data.FishSetting[n];o&&(o.GroupIndex=3)}},t.prototype.OnClickGameBtn=function(e){Debug.LogWarningWithFlag("Game Ctrller ("+this.IsActive+") On ClickGameBtn : "+e.FullPath),this.ClickGameBtn(e.Name,e)},t.prototype.ClickGameBtn=function(e,t){if(void 0===t&&(t=null),this.IsActive)if(GameDataBase.ClickUIBtn=!0,e.indexOf("AFKBtn_Lock_")>=0){AudioPlayer.PlaySound("Button_001_mp3");var n=Method.GetLastStringAsIndex(e);this.Data.LockGroup[n]=!this.Data.LockGroup[n],this.UpdateUI()}else switch(e){case"EnableAutoShootBtn":this.EnableAutoShoot();break;case"Button_SideBar1":case"Button_SideBar1a":AudioPlayer.PlaySound("Button_001_mp3");break;case"RightBtn_0":case"RightBtn_1":case"RightBtn_2":case"RightBtn_3":AudioPlayer.PlaySound("ButtonCannon_001_mp3"),this.SeatData.CurBulletIndex=Method.LoopRange(this.SeatData.CurBulletIndex+1,0,GameSettings.MaxBatteryCount-1),this.SeatData.CurBatteryIndex=Method.LoopRange(this.SeatData.CurBatteryIndex+1,0,GameSettings.MaxBatteryCount-1),this.UpdateUI(),this.SocketHandler.ExeAction("ChangeBullet",this.SeatIndex,this.SeatData.CurBulletIndex);break;case"LeftBtn_0":case"LeftBtn_1":case"LeftBtn_2":case"LeftBtn_3":AudioPlayer.PlaySound("ButtonCannon_001_mp3"),this.SeatData.CurBulletIndex=Method.LoopRange(this.SeatData.CurBulletIndex-1,0,GameSettings.MaxBatteryCount-1),this.SeatData.CurBatteryIndex=Method.LoopRange(this.SeatData.CurBatteryIndex-1,0,GameSettings.MaxBatteryCount-1),this.UpdateUI(),this.SocketHandler.ExeAction("ChangeBullet",this.SeatIndex,this.SeatData.CurBulletIndex);break;case"SpeedBtn_0":case"SpeedBtn_1":case"SpeedBtn_2":AudioPlayer.PlaySound("Button_001_mp3"),this.SeatData.ShootSpeed=Method.GetLastStringAsIndex(t.Name),this.UpdateUI();break;case"EnableLockBtn":AudioPlayer.PlaySound("ButtonSpecial_001_mp3"),this.Data.IsLockMode=!this.Data.IsLockMode,this.Data.IsLockMode?this.DisableAFKMode():this.DisableLockFishAutoShoot(),this.UpdateUI();break;case"EnableAFKBtn":AudioPlayer.PlaySound("ButtonSpecial_001_mp3"),this.Data.IsAFKMode?this.DisableAFKMode():(this.Data.IsLockMode=!1,this.DisableLockFishAutoShoot(),this.View.SetAFKPanelActive(!0)),this.UpdateUI();break;case"AFKBtn_Confirm":AudioPlayer.PlaySound("Button_001_mp3");for(var o=!1,i=0,a=this.Data.LockGroup.length;a>i;i++)if(this.Data.LockGroup[i]){o=!0;break}o&&this.EnableAFKMode(),this.View.SetAFKPanelActive(!1),this.UpdateUI();break;case"AFKBtn_Close":case"AFKBtn_AlphaBG":AudioPlayer.PlaySound("Button_001_mp3"),this.DisableAFKMode(),this.View.SetAFKPanelActive(!1);break;case"AFKBtn_Add":AudioPlayer.PlaySound("Button_001_mp3"),this.Data.AFKBulletCountIndex=Method.Clamp(this.Data.AFKBulletCountIndex+1,0,GameSettings.AFKShootBulletCount.length-1),this.Data.AFKBulletLeftCount=GameSettings.AFKShootBulletCount[this.Data.AFKBulletCountIndex],this.UpdateUI();break;case"AFKBtn_Sub":AudioPlayer.PlaySound("Button_001_mp3"),this.Data.AFKBulletCountIndex=Method.Clamp(this.Data.AFKBulletCountIndex-1,0,GameSettings.AFKShootBulletCount.length-1),this.Data.AFKBulletLeftCount=GameSettings.AFKShootBulletCount[this.Data.AFKBulletCountIndex],this.UpdateUI();break;case"AFKBtn_Checkbox":AudioPlayer.PlaySound("Button_001_mp3"),this.Data.EnableAFKBulletLimit=!this.Data.EnableAFKBulletLimit,this.UpdateUI();break;case"AFKBtn_SelectAll":AudioPlayer.PlaySound("Button_001_mp3");for(var r=!0,i=0,a=this.Data.LockGroup.length;a>i;i++)if(!this.Data.LockGroup[i]){r=!1;break}r?Method.EachArrayItemSetValue(this.Data.LockGroup,!1):Method.EachArrayItemSetValue(this.Data.LockGroup,!0),this.UpdateUI()}},t.prototype.UpdateBattery=function(){if(this.AbleToRotateBattery())switch(this.SeatIndex){case 0:case 1:this.SeatData.CurMouseFairyPos.y>0&&this.SeatData.CurMouseFairyPos.y<this.ShootPoint.y&&this.View.UpdateBatteryAngle(this.CurAngle);break;case 2:case 3:this.SeatData.CurMouseFairyPos.y>this.ShootPoint.y&&this.SeatData.CurMouseFairyPos.y<GlobalValue.EgretElementHeight&&this.View.UpdateBatteryAngle(this.CurAngle)}},t.prototype.UpdateUI=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.UpdateBattery(),this.View.UpdateUI()},t.prototype.OnServerGetBalance=function(t,n){void 0===n&&(n="0"),this.Data.TransferFailedTimes=0,e.prototype.OnServerGetBalance.call(this,t,n)},t}(GameCtrller);__reflect(FishingGameCtrllerBase_Self.prototype,"FishingGameCtrllerBase_Self");var PhotonHandlerBase=function(){function e(){this.HandlerKey=""}return e.prototype.Init=function(e,t){void 0===t&&(t=null),this.Connector=e,this.Callback=t},e.prototype.ExeAction=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]},e.prototype.SetParams=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e.prototype.OnConnect=function(){},e.prototype.OnClose=function(){},e.prototype.Send=function(e,t){void 0===t&&(t=null),this.Connector&&this.Connector.Send(e,t)},e.prototype.OnMsg=function(e,t){},e.prototype.ExeCallback=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.Callback&&this.Callback.apply(this,[e].concat(t))},e.prototype.HandleError=function(e){var t=this;return IsNullOrUndefined(e)?(Debug.LogWarning("errorCode is Null or Undefined"),!0):e==PhotonErrorCode.Success?!0:(MsgWindow.ShowMsg_OKOnly(PhotonErrorCode[e]+" ("+e+")",function(){t.OnClickErrorConfirmBtn(PhotonErrorCode[e])}),!1)},e.prototype.OnClickErrorConfirmBtn=function(e){GlobalMethod.ReloadPage()},e}();__reflect(PhotonHandlerBase.prototype,"PhotonHandlerBase",["IPhotonHandlerBase"]);var FishingLobbyCtrllerBase=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.FirstTimeEnter=!0,t.FetchKey="",t.AllowEnterRoom=!1,t}return __extends(t,e),t.prototype.Init=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return e.prototype.Init.apply(this,t),this.FirstTimeEnter=!0,SendTool.Register("OnClickLobbyBtn",this,this.OnClickLobbyBtn),[2]})})},t.prototype.SetupData=function(e){this.Data=e},t.prototype.StateBegin=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return e.prototype.StateBegin.apply(this,t),this.UpdateUI(),this.View.SetRoomPanelActive(!0),this.PlayBGM(),this.FirstTimeEnter?(this.FirstTimeEnter=!1,this.OnFetch("")):(this.AllowEnterRoom=!1,this.ExeFetch(),this.Data.IsGettingBalance=!0,this.UpdateUI()),[2]})})},Object.defineProperty(t.prototype,"FetchIntervalDuration",{get:function(){return GlobalValue.GetCustomFloatValue("fetch",30)},enumerable:!0,configurable:!0}),t.prototype.ExeFetch=function(){SendTool.SendData("CallLobbyAPI","Fetch")},t.prototype.OnFetch=function(e){var t=this;this.AllowEnterRoom=!0,this.Data.IsGettingBalance=!1,this.UpdateUI(),this.FetchKey=Time.StopAndDelayAction(this.FetchIntervalDuration,function(){t.ExeFetch()},this.FetchKey)},t.prototype.PlayBGM=function(){AudioPlayer.PlayBGM("Bgm_001_mp3",1.5)},t.prototype.StateEnd=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return e.prototype.StateEnd.apply(this,t),Time.Stop(this.FetchKey),this.View.SetRoomPanelActive(!1),[2]})})},t.prototype.OnClickLobbyBtn=function(e){Debug.LogWarningWithFlag("Lobby Ctrller ("+this.IsActive+") On ClickLobbyBtn : "+e.Name),this.ClickLobbyBtn(e.Name,e)},t.prototype.ClickLobbyBtn=function(e,t){var n=this;if(void 0===t&&(t=null),e.indexOf("Room_")>=0){this.Data.CurRoomIndex=Method.GetLastStringAsIndex(e);var o=this.Data.RoomInfo[this.Data.CurRoomIndex];if(o)if(this.AllowEnterRoom)if(AudioPlayer.PlaySound("Button_001_mp3"),BigNumCompareTo(this.Data.Balance,o.MinBalance)==CompareType.Less)MsgWindow.ShowLangMsg_OKOnly("Msg_MinBalanceNotEnough",function(e,t){});else{var i=o.MaxBalance;BigNumCompareTo(this.Data.Balance,i)==CompareType.Less&&(i=this.Data.Balance),SendTool.SendData("GetWalletExchangeResult",o.MinBalance,i,o.GameType,function(e){e&&(n.AllowEnterRoom=!1,n.View.PlayEnterRoomAni(n.Data.CurRoomIndex,function(){GlobalValue.LoginIP=o.SocketDomain,GlobalValue.GameType=o.GameType,GameManager.ins.ChangeState(GameTypeState.Game)}))})}else Debug.LogError("還未收到Fetch成功訊息，不允許進入房間")}},t.prototype.UpdateUI=function(){this.View.UpdateUI()},t}(GameCtrllerBase);__reflect(FishingLobbyCtrllerBase.prototype,"FishingLobbyCtrllerBase");var SceneStatus;!function(e){e[e.Normal=0]="Normal",e[e.Wave=1]="Wave"}(SceneStatus||(SceneStatus={}));var GameDataBase=function(){function e(){this.TransferFailedTimes=0,this.ManualCallExchangeBalance=!1,this.AutoExchangeBalance=!1,this.AbleToExchangeBalance=!0,this.ExchangeAmount="",this.SceneStatus=SceneStatus.Normal,this.IsAFKMode=!1,this.IsLockMode=!1,this.BetRecordDomain="",this.PlayerName="",this.SelfSeatIndex=0,this.EnableAFKBulletLimit=!1,this.AFKBulletLeftCount=0,this.AFKBulletCountIndex=0,this.Seat=[],this.Fishes=new Dictionary,this.FishSetting=new Dictionary,this.BetOdd=[]}return Object.defineProperty(e.prototype,"NeedToShowExchangeErrorMsg",{get:function(){if(this.ManualCallExchangeBalance)return!0;if(this.AutoExchangeBalance){var e=this.Seat[this.SelfSeatIndex];if(e){var t=this.BetOdd[e.CurBulletIndex];if(t&&e.DisplayBalance>=t)return!1}}return!0},enumerable:!0,configurable:!0}),e.ClickUIBtn=!1,e}();__reflect(GameDataBase.prototype,"GameDataBase");var FishSettingData=function(){function e(e,t,n,o){this.FishType=e,this.GroupIndex=t,this.MinOdd=n,this.MaxOdd=o}return e.prototype.toString=function(){return Method.GetLogValueFormat("FishType",this.FishType,"GroupIndex",this.GroupIndex,"MinOdd",JSON.stringify(this.MinOdd),"MaxOdd",JSON.stringify(this.MaxOdd))},e}();__reflect(FishSettingData.prototype,"FishSettingData");var SeatDataBase=function(){function e(){this.PlayerID="",this.PlayerName="",this.Balance=0,this.BulletMoney=0,this.BulletCount=0,this.AbleToShootSpecialWeapon=!1,this.AbleToEnableSpecialWeapon=!1,this.SpecialWeaponBulletCount=0,this.SpecialWeaponShootLeftTime=-1,this.CurBulletIndex=0,this.CurBatteryIndex=0,this.LastBatteryIndex=-1,this.ShootSpeed=2,this.CurMouseFairyPos=Vector2.Zero}return Object.defineProperty(e.prototype,"DisplayBalance",{get:function(){IsNullOrUndefined(this.BulletMoney)&&(this.BulletMoney=0),isNaN(this.BulletMoney)&&(this.BulletMoney=0),this.BulletMoney<0&&(this.BulletMoney=0);var e=this.Balance-this.BulletMoney;return 0>e&&(e=0),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HasLockTarget",{get:function(){return!StringIsNullOrEmpty(this.LockedFishID)},enumerable:!0,configurable:!0}),e.prototype.ClearLockTarget=function(){this.LockedFishID="",this.LockedFairyPos=null,this.LockedFishType=0},e.prototype.Setup=function(e,t,n){this.PlayerID=e,this.PlayerName=t,this.Balance=n,Debug.LogError("Setup "+this.PlayerName+" Balance : "+n)},e.prototype.Clear=function(){Debug.LogError("Clear "+this.PlayerName+" Balance"),this.ClearLockTarget(),this.PlayerID="",this.PlayerName="",this.Balance=0,this.CurBulletIndex=0,this.CurBatteryIndex=0,this.LastBatteryIndex=-1,this.SpecialWeaponBulletCount=0,this.SpecialWeaponShootLeftTime=-1,this.AbleToEnableSpecialWeapon=!1},e}();__reflect(SeatDataBase.prototype,"SeatDataBase");var FishingCommonViewBase=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.FishOddText=new Dictionary,t}return __extends(t,e),t.prototype.Init=function(t,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(o){switch(o.label){case 0:return e.prototype.Init.call(this,t),this.Data=n,this.RecordRefRange=FUIManager.GetEObj(this.RootObj,"RecordPanel/RecordRefRange"),this.RecordPanel=FUIManager.GetEObj(this.RootObj,"RecordPanel"),this.IntroPanel=FUIManager.GetEObj(this.RootObj,"IntroPanel"),this.AudioBtn=FUIManager.GetEObj(this.RootObj,"SideBar/AudioBtn"),this.WalletBtn=FUIManager.GetEObj(this.RootObj,"SideBar/WalletBtn"),this.LeaveBtn=FUIManager.GetEObj(this.RootObj,"SideBar/ExitBtn"),this.LeaveBtn.Enabled=!1,this.WalletBtn_AutoBuy=FUIManager.GetEObj(this.RootObj,"WalletPanel/WalletBtn_AutoBuy"),this.WalletPanel=FUIManager.GetEObj(this.RootObj,"WalletPanel"),this.WalletSlideBar=FUIManager.GetEObj(this.RootObj,"WalletPanel/SlideBar"),this.WalletMoneyInput=FUIManager.GetEObj(this.RootObj,"WalletPanel/Input_Money"),this.WalletMoneyText=FUIManager.GetEObj(this.RootObj,"WalletPanel/Text_Money"),[4,Time.WaitForSecond()];case 1:return o.sent(),[2]}})})},t.prototype.SetRecordPanelActive=function(e){this.RecordPanel.SetActive(e)},t.prototype.SetWalletPanelActive=function(e){this.WalletPanel&&this.WalletPanel.SetActive(e)},t.prototype.SetIntroPanelActive=function(e){if(this.IntroPanel&&this.IntroPanel.SetActive(e),e)for(var t=this.Data.FishSetting.Values,n=0,o=t.length;o>n;n++){var i=t[n],a=this.FishOddText[i.FishType];if(a&&i.MinOdd&&i.MaxOdd)if(i.MinOdd.length==i.MaxOdd.length)for(var r=0,s=i.MinOdd.length;s>r;r++)a[r]&&(a[r].Text=this.GetOddsTextString(i.MinOdd[r],i.MaxOdd[r]));else Debug.LogError(i.FishType+" Max跟Min的Odd資料不等長")}},t.prototype.GetOddsTextString=function(e,t){return e==t?"x"+e:"x"+e+"~"+t},t.prototype.UpdateUI=function(){this.AudioBtn&&(this.AudioBtn.Selected=AudioPlayer.IsAudioMute),this.WalletBtn&&(GlobalValue.NeedToOpenWallet||(this.WalletBtn.Enabled=!1)),this.WalletBtn_AutoBuy&&(this.WalletBtn_AutoBuy.Selected=this.Data.AutoExchangeBalance);var t=Method.ToFixedString(BigNumMul(this.Data.ExchangeAmount,GlobalValue.ServerToClientMoneyScale.toString()),GlobalValue.NumberDigits,!0);this.WalletMoneyText.Text=t,this.WalletMoneyInput.InputText=t,e.prototype.UpdateUI.call(this)},t}(AppUIBase);__reflect(FishingCommonViewBase.prototype,"FishingCommonViewBase");var FishingGameViewBase_Self=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AFKPanelOddText=[],t.PingKey="",t.ABGIndex=-1,t.CurBGIndex=0,t.BGUrl=[],t.SpecialFishTipKey="",t.PlayerTipKey="",t.MinOdds=[],t.MaxOdds=[],t.WarningTipKey="",t}return __extends(t,e),Object.defineProperty(t.prototype,"IsUIEnable",{get:function(){return this.IsBaseUIEnable()},enumerable:!0,configurable:!0}),t.prototype.IsBaseUIEnable=function(){return this.AFKPanel.ActiveSelf||this.IntroPanel.ActiveSelf||this.RecordPanel.ActiveSelf||this.WalletPanel.ActiveSelf||MsgWindow.IsActive?!0:this.Data.SceneStatus==SceneStatus.Wave?!0:MsgWindow.IsActive?!0:!1},t.prototype.Clear=function(){this.SetAFKPanelActive(!1),e.prototype.Clear.call(this)},t.prototype.Init=function(t,n,o){return __awaiter(this,void 0,void 0,function(){var i,a,r;return __generator(this,function(s){switch(s.label){case 0:return e.prototype.Init.call(this,t,n,o),this.GameBG=FUIManager.GetEObj(this.RootObj,"GameBG"),this.FishWaveAni=FUIManager.GetEObj(this.RootObj,"Tran_FishWave"),this.BGChangeMask=FUIManager.GetEObj(this.RootObj,"BGChangeMask"),this.RecordPanel=FUIManager.GetEObj(this.RootObj,"RecordPanel"),this.SeatEffect=FUIManager.GetEObj(this.RootObj,"SeatEffect_"+o),this.LockedFish=FUIManager.GetEObj(this.RootObj,"LockedFish_"+o),this.LockedFishIcon=FUIManager.GetEObj(this.RootObj,"LockedFish_"+o+"/Icon"),this.AFKPanel=FUIManager.GetEObj(this.RootObj,"AFKPanel"),this.WalletPanel=FUIManager.GetEObj(this.RootObj,"WalletPanel"),this.IntroPanel=FUIManager.GetEObj(this.RootObj,"IntroPanel"),this.SideBar=FUIManager.GetEObj(this.RootObj,"SideBar"),this.AudioBtn=FUIManager.GetEObj(this.RootObj,"SideBar/AudioBtn"),this.SpecialFishTip=FUIManager.GetEObj(this.RootObj,"SpecialFishTip"),this.AFKLockBtns=FUIManager.GetGroupEObjs("AFKLockBtns"),null==this.AFKLockBtns&&(this.AFKLockBtns=[]),this.EnableAFKBtn=FUIManager.GetEObj(this.RootObj,"EnableAFKBtn"),this.EnableLockBtn=FUIManager.GetEObj(this.RootObj,"EnableLockBtn"),this.AFKBtn_Add=FUIManager.GetEObj(this.RootObj,"AFKPanel/AFKBtn_Add"),this.AFKBtn_Sub=FUIManager.GetEObj(this.RootObj,"AFKPanel/AFKBtn_Sub"),this.AFKBtn_Checkbox=FUIManager.GetEObj(this.RootObj,"AFKPanel/AFKBtn_Checkbox"),this.AFKBtn_BulletCount=FUIManager.GetEObj(this.RootObj,"AFKPanel/Text_BulletCount"),this.WarningTip=FUIManager.GetEObj(this.RootObj,"WarningTip"),this.PlayerTip=FUIManager.GetEObj(this.RootObj,"PlayerTip"),this.PlayerTipText=FUIManager.GetEObj(this.RootObj,"PlayerTip/Text"),this.NetSpeedText=FUIManager.GetEObj(this.RootObj,"RoomInfo/Text_NetSpeed"),i=FUIManager.GetEObj(this.RootObj,"RoomInfo/Text_RoomType"),i&&(a="-",this.Data.CurRoomInfo&&(r=this.Data.CurRoomInfo.MinBalance,r&&(r=Method.ToFixedString(BigNumMul(r,GlobalValue.ServerToClientMoneyScale.toString()),GlobalValue.NumberDigits,!0),a=LanguageManager.GetText("FishRoomTypeText",r.toString()))),i.Text=a),this.RoomPanel=FUIManager.GetEObj(this.RootObj,"RoomPanel"),this.RoomPanel&&this.RoomPanel.SetActive(!1),[4,Time.WaitForSecond()];case 1:return s.sent(),this.PlayerCtrlBtn&&this.PlayerCtrlBtn.SetActive(!0),this.InvokeUpdatePing(),this.UpdateBG(),[2]}})})},t.prototype.InvokeUpdatePing=function(){var e=this,t=WebSocketManager.ins.GetPing();this.NetSpeedText&&(this.NetSpeedText.Text=t.toFixed(0)),this.PingKey=Time.StopAndDelayAction(3,function(){e.InvokeUpdatePing()},this.PingKey)},t.prototype.ScoreEffectResName=function(e){return"CoinEffect_Self_"+(2>=e?HitFishBaseEffectType[e]:HitFishEffectType[e])},t.prototype.SetSettlement=function(e){this.Settlement.PlayAni("Self");var t=this.Settlement.GetChild("Text_Self");e>=0?t.Text=Method.ToFixedString(MathMul(e,GlobalValue.ServerToClientMoneyScale).toString(),GlobalValue.NumberDigits,!0):t.Text=""},t.prototype.SetSeatEffectActive=function(){var e=this;this.SeatEffect&&(this.SeatEffect.SetActive(!0),this.SeatEffect.PlayAni("t0"),Time.DelayAction(4,function(){e.SeatEffect.SetActive(!1)}))},Object.defineProperty(t.prototype,"AssignBGIndex",{get:function(){return this.ABGIndex},set:function(e){return isNaN(e)?(e=0,void Debug.LogError("Set BG Index = NAN")):(this.ABGIndex=e,Debug.LogWarning("Set BG Index : "+e),void(isNaN(this.ABGIndex)&&(this.ABGIndex=-1)))},enumerable:!0,configurable:!0}),t.prototype.SetupBG=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.AssignBGIndex=e,[4,Time.WaitForSecond()];case 1:return t.sent(),this.UpdateBG(),[2]}})})},t.prototype.UpdateBG=function(){this.GameBG&&(-1==this.AssignBGIndex?this.BGUrl[this.CurBGIndex]&&(this.GameBG.Icon=this.BGUrl[this.CurBGIndex]):this.BGUrl[this.AssignBGIndex]&&(this.GameBG.Icon=this.BGUrl[this.AssignBGIndex]))},t.prototype.PlayFishWaveTip=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.WarningTip&&(this.WarningTip.SetActive(!0),this.WarningTip.PlayAni("FishWave")),AudioPlayer.PlaySound("RemindFish_001_mp3"),[4,Time.WaitForSecond(3)];case 1:return e.sent(),this.WarningTip&&this.WarningTip.SetActive(!1),[2]}})})},t.prototype.OnFishWave=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return e&&(this.AssignBGIndex=e.BackGroundID),[4,this.PlayFishWaveTip(e)];
case 1:return t.sent(),this.FishWaveAni.SetActive(!0),this.FishWaveAni.PlayAni("t0"),AudioPlayer.PlaySound("RemindFishWaves_001_mp3"),FUIManager.FadeEObjToAlpha(this.BGChangeMask,this.FishWaveDuration,1,CurveMethod.EaseOut),[4,Time.WaitForSecond(this.FishWaveDuration)];case 2:return t.sent(),this.CurBGIndex=Method.LoopRange(this.CurBGIndex+1,0,this.BGUrl.length-1),this.UpdateBG(),this.FishWaveAni.SetActive(!1),[4,Time.WaitForSecond()];case 3:return t.sent(),FUIManager.FadeEObjToAlpha(this.BGChangeMask,1,0,CurveMethod.EaseOut),[2]}})})},t.prototype.OnFishWaveWarning=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.PlayFishWaveTip(e)];case 1:return t.sent(),[2]}})})},t.prototype.PlaySpecialFishTip=function(e){var t=this;AudioPlayer.PlaySound("RemindSpecial_001_mp3"),this.SpecialFishTip&&(this.SpecialFishTip.SetActive(!0),this.SpecialFishTip.PlayAni("FSType_"+e),this.SpecialFishTipKey=Time.StopAndDelayAction(4.5,function(){t.SpecialFishTip.SetActive(!1)},this.SpecialFishTipKey))},t.prototype.SetNoBulletTipActive=function(){var e=this;this.PlayerTipText.Text=LanguageManager.GetText("Msg_MaxBulletLimit"),this.PlayerTip.SetActive(!0),this.PlayerTipKey=Time.StopAndDelayAction(2.5,function(){e.PlayerTip.SetActive(!1)},this.PlayerTipKey)},t.prototype.SetMoneyNotEnoughTipActive=function(){var e=this;this.PlayerTipText.Text=LanguageManager.GetText("Msg_MoneyNotEnough"),this.PlayerTip.SetActive(!0),this.PlayerTipKey=Time.StopAndDelayAction(2.5,function(){e.PlayerTip.SetActive(!1)},this.PlayerTipKey)},t.prototype.SetAFKPanelActive=function(e){if(this.AFKPanel&&this.AFKPanel.SetActive(e),e){this.MinOdds=[9999,9999,9999],this.MaxOdds=[0,0,0];for(var t=this.Data.FishSetting.Values,n=0,o=t.length;o>n;n++){var i=t[n];switch(i.GroupIndex){case 0:case 1:case 2:this.MinOdds[i.GroupIndex]>i.MinOdd[0]&&i.MinOdd[0]>0&&(this.MinOdds[i.GroupIndex]=i.MinOdd[0]),this.MaxOdds[i.GroupIndex]<i.MaxOdd[i.MaxOdd.length-1]&&i.MaxOdd[i.MaxOdd.length-1]>0&&(this.MaxOdds[i.GroupIndex]=i.MaxOdd[i.MaxOdd.length-1])}}}},t.prototype.PlayWarningTip=function(e){var t=this;this.WarningTip&&this.WarningTip.SetActive(!0),this.WarningTipKey=Time.StopAndDelayAction(3.5,function(){t.WarningTip&&t.WarningTip.SetActive(!1)},this.WarningTipKey)},t.prototype.UpdateUI=function(){this.EnableAFKBtn.Selected=this.Data.IsAFKMode,this.EnableLockBtn.Selected=this.Data.IsLockMode,this.AudioBtn&&(this.AudioBtn.Selected=AudioPlayer.IsAudioMute);for(var t=0,n=this.Data.LockGroup.length;n>t;t++)this.AFKLockBtns[t]?this.AFKLockBtns[t].Selected=this.Data.LockGroup[t]:Debug.LogError("AFKLockBtns["+t+"] = null (沒有設定Group為'AFKLockBtns')");this.AFKBtn_Checkbox&&(this.AFKBtn_Checkbox.Selected=this.Data.EnableAFKBulletLimit),this.AFKBtn_Add&&(this.AFKBtn_Add.Enabled=this.Data.EnableAFKBulletLimit),this.AFKBtn_Sub&&(this.AFKBtn_Sub.Enabled=this.Data.EnableAFKBulletLimit),this.AFKBtn_BulletCount&&(this.AFKBtn_BulletCount.Text=GameSettings.AFKShootBulletCount[this.Data.AFKBulletCountIndex].toString()),e.prototype.UpdateUI.call(this)},t}(GameView);__reflect(FishingGameViewBase_Self.prototype,"FishingGameViewBase_Self");var ServerValueParseBase=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._CorParamDic=null,this.ServerMsg=e[0]}return Object.defineProperty(e.prototype,"CorParamDic",{get:function(){return null==this._CorParamDic&&(this._CorParamDic=this.GetCorParamDic),this._CorParamDic},enumerable:!0,configurable:!0}),e.prototype.GetMsgValue=function(e,t){if(!IsNullOrUndefined(this.ServerMsg)){var n=Method.ParseValueToEnum(e,t),o=this.ServerMsg[n];if(IsNullOrUndefined(o)){var i=e[n];o=this.ServerMsg[i]}if(this.CorParamDic.ContainsKey(n)){var a=this.CorParamDic[n];return a.GetValue(o)}return o}return null},e.prototype.SetMsgValue=function(e,t,n){if(!IsNullOrUndefined(this.ServerMsg)){var o=Method.ParseValueToEnum(e,t),i=this.ServerMsg[o];if(IsNullOrUndefined(i)){var a=e[o];i=this.ServerMsg[a],this.ServerMsg[a]=n}else this.ServerMsg[o]=n}},e}();__reflect(ServerValueParseBase.prototype,"ServerValueParseBase");var FishingLobbyViewBase=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.RoomBtn=[],t.RoomOdds=[],t.RoomTitle=[],t.RoomIntro=[],t.PingKey="",t}return __extends(t,e),t.prototype.SetupData=function(e){this.Data=e},t.prototype.Init=function(t){return __awaiter(this,void 0,void 0,function(){var n,o;return __generator(this,function(i){if(e.prototype.Init.call(this,t)){for(this.RoomPanel=FUIManager.GetEObj(this.RootObj,"RoomPanel"),this.PlayerName=FUIManager.GetEObj(this.RootObj,"RoomPanel/UI_Player/Text_Player"),this.Money=FUIManager.GetEObj(this.RootObj,"RoomPanel/UI_Money/Text_Money"),this.NetSpeedText=FUIManager.GetEObj(this.RootObj,"RoomPanel/UI_Top/Text_Wifi"),n=0;;){if(o=FUIManager.GetEObj(this.RootObj,"RoomPanel/Room_"+n),!o)break;this.RoomOdds.push(o.GetChild("Text_Money")),this.RoomIntro.push(o.GetChild("Text_Info")),this.RoomTitle.push(o.GetChild("Text_Title")),this.RoomBtn.push(o),this.OnGetRoomBtn(o,n),o.SetActive(!1),n++}this.InvokeUpdatePing()}return[2]})})},t.prototype.PlayEnterRoomAni=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return t&&t(),[2]})})},t.prototype.OnGetRoomBtn=function(e,t){e&&e.PlayAni("t0")},t.prototype.InvokeUpdatePing=function(){var e=this,t=HttpManager.ins.GetPing();this.NetSpeedText&&(this.NetSpeedText.Text=t.toFixed(0)),this.PingKey=Time.StopAndDelayAction(3,function(){e.InvokeUpdatePing()},this.PingKey)},t.prototype.SetRoomPanelActive=function(e){this.RoomPanel.SetActive(e),this.RootEObj.SetSelectedIndex("Contorl_Menu",e?1:0)},t.prototype.UpdateUI=function(){if(this.PlayerName.Text=this.Data.NickName,this.Data.IsGettingBalance)this.Money.Text="-";else{var e=AppData.Account.Symbol?AppData.Account.Symbol:"";this.Money.Text=e+Method.ToFixedString(BigNumMul(this.Data.Balance,GlobalValue.ServerToClientMoneyScale.toString()),GlobalValue.NumberDigits,!0)}if(this.Data.RoomInfo)for(var t=0,n=this.Data.RoomInfo.length;n>t;t++)if(this.RoomBtn[t]){var o="-",i=this.Data.RoomInfo[t].MinBalance;i=i?Method.ToFixedString(BigNumMul(i,GlobalValue.ServerToClientMoneyScale.toString()),GlobalValue.NumberDigits,!0):Method.ToFixedString("0",GlobalValue.NumberDigits,!0),o=LanguageManager.GetText("FishRoomTypeText",i),this.RoomOdds[t]&&(this.RoomOdds[t].Text=o),this.RoomBtn[t].SetActive(!0),this.RoomBtn[t].Enabled=this.Data.RoomInfo[t].IsActive,this.RoomIntro[t]&&(this.RoomIntro[t].Text=""),this.RoomTitle[t]&&(this.RoomTitle[t].Text=LanguageManager.GetText("FishRoomTitle_"+t))}else Debug.LogError("有資料但素材缺少按鈕 : "+t)},t}(AppUIBase);__reflect(FishingLobbyViewBase.prototype,"FishingLobbyViewBase");var HttpHandler_LoginLobby=function(e){function t(){var t=e.call(this)||this;return t.ReloadUrl="",t.ExchangeUrl="",SendTool.Register("CallLobbyAPI",t,t.ExeAction),t}return __extends(t,e),t.prototype.ExeAction=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];switch(e.prototype.ExeAction.apply(this,[t].concat(n)),t){case"ExchangeBalance":var i=n[0],a=n[1],r=n[2],s=this.GetJsonString([{Key:"Token",Value:GlobalValue.LoginToken},{Key:"GameType",Value:a},{Key:"GameBalance",Value:i},{Key:"IsAutoBalance",Value:r}]);this.Send(this.ExchangeUrl,s,t);break;case"LoginLobby":case"Fetch":var l=GlobalValue.GetCustomIntValue("channelId",1),u=GlobalValue.GetCustomStringValue("data",""),s="";switch(t){case"LoginLobby":s=this.GetJsonString([{Key:"GameGroup",Value:GlobalValue.GameGroup},{Key:"Version",Value:GlobalValue.Version},{Key:"ChannelId",Value:l},{Key:"Data",Value:u},{Key:"GameMode",Value:GlobalValue.GameMode}]),this.Send(GlobalValue.LoginIP,s,t);break;case"Fetch":this.ReloadUrl?(s=this.GetJsonString([{Key:"GameGroup",Value:GlobalValue.GameGroup},{Key:"Version",Value:GlobalValue.Version},{Key:"ChannelId",Value:l},{Key:"Data",Value:u},{Key:"Token",Value:GlobalValue.LoginToken},{Key:"GameMode",Value:GlobalValue.GameMode}]),this.Send(this.ReloadUrl,s,t)):Debug.LogError("Login沒有回傳Fetch的Url")}}},t.prototype.Send=function(t,n,o){switch(GlobalValue.GameMode){case GameMode.Local:var i=ResManager.GetResource("HttpResp_"+o+"_txt");HttpManager.ins.SendResponse(i);break;default:e.prototype.Send.call(this,t,n,o)}},t.prototype.OnMsg=function(e,t){if(this.HandleError(e)){switch(t){default:Debug.Log("收到「"+t+"」 : "+e)}switch(t){case"LoginLobby":this.OnMsg_LoginLobby(e,t);break;case"Fetch":this.OnMsg_Fetch(e,t);break;case"ExchangeBalance":this.OnMsg_Exchange(e,t)}}},t.prototype.OnMsg_LoginLobby=function(e,t){var n=JSON.parse(e);AppData.Account.Symbol=n.Symbol,GlobalValue.LoginToken=n.Token,GlobalValue.NeedToOpenWallet=Method.ParseValueToBoolean(n.OpenWallet,!0),this.ReloadUrl=n.ReloadUrl,this.ExchangeUrl=n.ExchangeUrl;for(var o=0,i=n.RoomInfo.length;i>o;o++)n.RoomInfo[o].BetOdds&&(n.RoomInfo[o].Odds=Method.ParseValueToArray(n.RoomInfo[o].BetOdds));this.ExeCallback(JSON.stringify(n),t)},t.prototype.OnMsg_Fetch=function(e,t){var n=JSON.parse(e);GlobalValue.LoginToken=n.Token,this.ExeCallback(JSON.stringify(n),t)},t.prototype.OnMsg_Exchange=function(e,t){},t.prototype.OnClickErrorConfirmBtn=function(t){switch(t){case"NetworkError":break;default:e.prototype.OnClickErrorConfirmBtn.call(this,t)}},t}(HttpHandlerBase);__reflect(HttpHandler_LoginLobby.prototype,"HttpHandler_LoginLobby");var WeaponType;!function(e){e[e.None=0]="None",e[e.Laser=1]="Laser",e[e.Bomb=2]="Bomb",e[e.Dragon=3]="Dragon",e[e.Dragon_2=4]="Dragon_2",e[e.Dragon_3=5]="Dragon_3",e[e.Drill=6]="Drill",e[e.Flame=7]="Flame"}(WeaponType||(WeaponType={}));var FishingWebSocketHandlerBase_ThisGame=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.WaitForResumeResult=!1,t}return __extends(t,e),t.prototype.Init=function(t,n,o){var i=this;void 0===n&&(n=""),void 0===o&&(o=null),e.prototype.Init.call(this,t,n,o),SendTool.Register(AppEvent[AppEvent.OnAppPause],this,function(){i.OnApplicationPause(!0)}),SendTool.Register(AppEvent[AppEvent.OnAppResume],this,function(){i.OnApplicationPause(!1)}),SendTool.Register(AppEvent[AppEvent.OnWindowHidden],this,function(){i.OnWindowFocus(!0)}),SendTool.Register(AppEvent[AppEvent.OnWindowFocus],this,function(){i.OnWindowFocus(!1)})},t.prototype.ExeAction=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o="",i="";switch(e){case"Init":GlobalValue.GameMode==GameMode.Local&&this.SimulateFakeData(),i="GetGameInitData",o='{"Opcode": "'+i+'", "Data": null}',this.Send(o),this.StartCalcPing(i);break;case"ResumeUpdate":i="GetRequestAgain",o='{"Opcode": "'+i+'", "Data": null}',this.Send(o);break;case"GetBalance":var a=t[0];i="GetBalance",o='{"Opcode": "'+i+'", "Data": null}',this.Send(o),this.StartCalcPing(i);break;case"ExchangeBalance":var r=t[0],s=!1;i="ExchangeBalance",o='{"Opcode": "'+i+'","Data": {"GameBalance": "'+r+'","IsAutoBalance": "'+s+'"}}',Debug.LogError("Send ExchangeBalance : "+o),this.Send(o),this.StartCalcPing(i);break;case"ShootBullet":var a=t[0],l=t[1],u=t[2],c=t[3],h=t[4]%360,p=t[5];i="ShootBullet",o='{"Opcode": "'+i+'","Data": {"PlayerID": "'+a+'","BulletID": "'+u+'","PlayerSeat": "'+l+'","ShootAngle": "'+h+'","BulletIndex": "'+c+'","LockedFishID": "'+p+'"}}',this.Send(o),this.StartCalcPing(i);break;case"ShootSpecialBullet":var a=t[0],l=t[1],h=t[2],d=t[3],g=GameSettings.SeatShootPos[l],y=0,f=0;g&&(y=g.x,f=g.y),y||(y=0),f||(f=0),i="ShootSpecialBullet",o='{"Opcode": "'+i+'","Data": {"PlayerID": "'+a+'","PlayerSeat": "'+l+'","ShootAngle": "'+h+'","BulletType": "'+d+'","BulletX": "'+y+'","BulletY": "'+f+'"}}',this.Send(o),this.StartCalcPing(i);break;case"ChangeBullet":var l=t[0],c=t[1];i="ChangeBullet",o='{"Opcode": "'+i+'","Data": {"PlayerSeat": "'+l+'","BulletIndex": "'+c+'"}}',this.Send(o),this.StartCalcPing(i);break;case"HitFish":var a=t[0],l=t[1],u=t[2],m=t[3],S=t[4];i="HitFish",o='{"Opcode": "'+i+'","Data": {"PlayerID": "'+a+'","BulletID": "'+u+'","PlayerSeat": "'+l+'","BulletBet": "'+m+'","FishID": "'+S.ID+'"}}',Debug.LogWarning(">> Send HitFish : "+o),this.Send(o);break;case"SpecialHitFish":var a=t[0],l=t[1],b=t[2],d=t[3];0!=b.length&&(i="SpecialHitFish",o='{"Opcode": "'+i+'","Data": {"PlayerID": "'+a+'","PlayerSeat": "'+l+'","FishID": "'+b+'","BulletType": "'+d+'"}}',Debug.LogWarning(">> Send SpecialHitFish : "+o),this.Send(o))}},t.prototype.SimulateFakeData=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},t.prototype.StartCalcPing=function(e){WebSocketManager.ins.StartCalcPing(e)},t.prototype.StopCalcPing=function(e){WebSocketManager.ins.StopCalcPing(e)},t.prototype.OnApplicationPause=function(e){GlobalValue.IsMobile&&this.ExeResumeUpdate(e)},t.prototype.OnWindowFocus=function(e){GlobalValue.IsMobile||this.ExeResumeUpdate(e)},t.prototype.ExeResumeUpdate=function(e){e?this.WaitForResumeResult=!0:this.ExeAction("ResumeUpdate")},t.prototype.Send=function(t){var n=JSON.parse(t),o=n.Opcode;switch(GlobalValue.GameMode){case GameMode.Local:WebSocketManager.ins.SendFakeRespMsg(o,-1,null,n);break;default:e.prototype.Send.call(this,t)}},t.prototype.OnMsg=function(e){if(e){var t=JSON.parse(e);if(t){var n=t.OpCode;switch(n){case"UpdateFish":break;default:Debug.Log("收到「"+n+"」 : "+JSON.stringify(t.Data))}switch(n){case"GetGameInitDataResult":var o=t.Data;null!=this.Callback&&this.Callback(n,JSON.stringify(o)),this.WaitForResumeResult=!1,this.StopCalcPing("GetGameInitData");break;case"GetBalanceResult":var o=t.Data;if(o){var i=!1;o.ErrorCode?"success"==o.ErrorCode.toLowerCase()?i=!0:Debug.LogError("GetBalanceResult 收到 ErrorCode : "+o.ErrorCode):i=!0,i&&(o.Ext?(Debug.LogWarning("OnServer GetBalanceResult 收到 Balance : "+o.PlayerBalance+" / Pool : "+o.Ext.PlayerBulletPool),GameManager.ins.Ctrllers[o.Ext.PlayerSeat].OnServerGetBalance(o.PlayerBalance.toString(),o.Ext.PlayerBulletPool.toString())):Debug.LogError("GetBalance Data Error : Ext = Null"))}this.StopCalcPing("GetBalance");break;case"ExchangeBalance":var o=t.Data;if(o){Debug.LogWarning("OnServer ExchangeBalance 收到 Balance : "+o.GameBalance+" / Pool : 強制清空 / Status : "+o.Status);var a=!1,r=o.Status;if(r)switch(r){case"Transferring":GameManager.ins.CommonCtrller.OnServerWalletExchange(!1);break;case"TransferComplete":a=!0;break;default:var s=LanguageManager.GetText("Msg_ValueError","status = "+r);MsgWindow.ShowMsg_OKOnly(s),Debug.LogError("未知轉換分狀態 : "+r),GameManager.ins.CommonCtrller.OnServerWalletExchange(!0)}else a=!0;a&&(GameManager.ins.MainCtrller.OnServerGetBalance(o.GameBalance),GameManager.ins.CommonCtrller.OnServerWalletExchange(!0))}this.StopCalcPing("ExchangeBalance");break;case"ShootBulletResult":var o=t.Data;o&&GameManager.ins.Ctrllers[o.PlayerSeat].OnServerShootBullet(o),this.StopCalcPing("ShootBullet");break;case"ShootSpecialBulletResult":var o=t.Data;o&&GameManager.ins.Ctrllers[o.PlayerSeat].OnServerShootSpecialBullet(o),this.StopCalcPing("ShootSpecialBullet");break;case"GetSpecialBulletResult":var o=t.Data;o&&GameManager.ins.Ctrllers[o.PlayerSeat].OnServerGetSpecialBullet(o);break;case"ChangeBulletResult":var o=t.Data;o&&GameManager.ins.Ctrllers[o.PlayerSeat].OnServerChangeBattery(o),this.StopCalcPing("ChangeBullet");break;case"ShowWave":Debug.LogErrorWithFlag("收到ShowWave");var o=t.Data;GameManager.ins.MainCtrller.OnFishWave(o);break;case"InitShowWave":Debug.LogErrorWithFlag("收到InitShowWave");var o=t.Data;GameManager.ins.MainCtrller.OnFishWaveWarning(o);break;case"ShowWaveEnd":GameManager.ins.MainCtrller.PlayBGM();break;case"UpdateFish":if(this.WaitForResumeResult)return;var o=t.Data;o&&GameManager.ins.MainCtrller.OnUpdateFish(o);break;case"RoomPlayerNotifyJoin":var o=t.Data;if(o){var l=GameManager.ins.Data.Seat[o.Seat];l&&(l.Setup(o.ID,o.Name,o.Balance),GameManager.ins.Ctrllers[o.Seat].UpdateUI())}break;case"RoomPlayerNotifyLeave":var o=t.Data;if(o){var l=GameManager.ins.Data.Seat[o.Seat];l&&(l.Clear(),GameManager.ins.Ctrllers[o.Seat].UpdateUI())}}}}},t.prototype.OnErrorMsg=function(e){GameManager.ins.OnErrorMsg(e)},t}(WebSocketHandlerBase);__reflect(FishingWebSocketHandlerBase_ThisGame.prototype,"FishingWebSocketHandlerBase_ThisGame");var GameState;!function(e){e[e.None=-1]="None",e[e.WaitForNextRound=0]="WaitForNextRound",e[e.PrepareBetting=1]="PrepareBetting",e[e.BetSelection=2]="BetSelection",e[e.WaitForServerResponse=3]="WaitForServerResponse",e[e.PlayShow=4]="PlayShow",e[e.ShowSettlement=5]="ShowSettlement"}(GameState||(GameState={}));var GameStateCtrllerBase=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.MaxGameStateIndex=0,t}return __extends(t,e),t.prototype.ChangeState=function(t,n){void 0===n&&(n=null);for(var o=[],i=2;i<arguments.length;i++)o[i-2]=arguments[i];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){switch(i.label){case 0:return Debug.Log("<<GameStateCtrller>> ChangeState : "+GameState[this.CurGameState]+" to "+GameState[t]),[4,e.prototype.ChangeState.apply(this,[t,n].concat(o))];case 1:return i.sent(),[2]}})})},t.prototype.NextState=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,o,i;return __generator(this,function(a){switch(a.label){case 0:switch(e=Number(this.CurGameState),t=null,n=null,o=this.GetStateListData(this.CurGameState),i=e){case GameState.BetSelection:return[3,1];case GameState.WaitForServerResponse:return[3,1];case GameState.PlayShow:return[3,2]}return[3,3];case 1:return e=this.GetNotEmptyState(e+1),o.AddIndex(),[3,7];case 2:return n=o.GetNextState(),t=o.GetNextFunction(),null==n&&null==t?e=this.GetNotEmptyState(e+1):(e=this.GetNotEmptyState(GameState.BetSelection),o.AddIndex()),[3,7];case 3:return n=o.GetNextState(),t=o.GetNextFunction(),null!=n||null!=t?[3,4]:(this.ResetStateListDataIndex(),e=this.GetNotEmptyState(e+1),[3,6]);case 4:return[4,this.ChangeState(this.CurGameState,n)];case 5:return a.sent(),o.AddIndex(),[2];case 6:return[3,7];case 7:return[4,this.ChangeState(e)];case 8:return a.sent(),[2]}})})},t.prototype.GetNotEmptyState=function(e){for(var t=Method.LoopRange(e,0,this.MaxGameStateIndex),n=this.GetStateListData(t),o=n.GetState(),i=n.GetFunction(),a=0;n.IsEmpty||null==o&&null==i;)if(t=Method.LoopRange(t+1,0,this.MaxGameStateIndex),n=this.GetStateListData(t),o=n.GetState(),i=n.GetFunction(),a++,a>this.MaxGameStateIndex){Debug.LogError("所有狀態的狀態機或方法皆為空");break}return t},t.prototype.StateReadyToBegin=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},t.prototype.StateBegin=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.IsActive=!0,[2]})})},t.prototype.StateEnd=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.IsActive=!1,[2]})})},t.prototype.StateClose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},t.prototype.Init=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return this.MaxGameStateIndex=Method.GetEnumMaxIndex(GameState),e.prototype.Init.apply(this,t),[2]})})},t.prototype.SetActive=function(e){},t.prototype.Clear=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];(n=this.View).Clear.apply(n,e);var n},t.prototype.UpdateUI=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];(n=this.View).UpdateUI.apply(n,[this.Data].concat(e));var n},t}(GameCtrllerBase);__reflect(GameStateCtrllerBase.prototype,"GameStateCtrllerBase");var WebSocketRespData_Game=function(){function e(){this.Symbol="",this.MinBetRate=0,this.MaxBetRate=0,this.CashScale=0,this.CashDigits=0,this.JPCashType=JPCashType.Default,this.DefaultRate=0,this.BetSizes=[],this.BetMultiples=[],this.BaseBet=0,this.DefaultBet=0,this.GameWinRates=[],this.CustomDisplayCashScale=0}return e}();__reflect(WebSocketRespData_Game.prototype,"WebSocketRespData_Game");var WebSocketRespData_GetBalance=function(){function e(){this.Money="0"}return e}();__reflect(WebSocketRespData_GetBalance.prototype,"WebSocketRespData_GetBalance");var WebSocketRespData_GetJackpot=function(){function e(){this.GameID=0,this.JackpotMoney=[]}return e}();__reflect(WebSocketRespData_GetJackpot.prototype,"WebSocketRespData_GetJackpot");var WebSocketRespData_JoinRoom=function(){function e(){}return e}();__reflect(WebSocketRespData_JoinRoom.prototype,"WebSocketRespData_JoinRoom");var PlayerInfoData=function(){function e(){}return e}();__reflect(PlayerInfoData.prototype,"PlayerInfoData");var WebSocketRespData_Login=function(){function e(){this.PlayerName="",this.Token="",this.ReportUrl=""}return e}();__reflect(WebSocketRespData_Login.prototype,"WebSocketRespData_Login");var WebSocketConnector=function(){function e(e,t){void 0===t&&(t=!1);var n=this;this.EnableLog=!0,this.IsConnected=!1,this.Url="",this.Handlers=new Dictionary,this.ConnectListener=function(){n.OnConnect()},this.CloseListener=function(){n.OnClose()},this.RespListener=function(e){n.OnReceiveMsg(n.Socket.readUTF())},this.ErrorListener=function(e){n.OnError(e)},this.Url=e,this.EnableLog=t,this.Socket=new egret.WebSocket,this.Socket.addEventListener(egret.Event.CONNECT,this.ConnectListener,this),this.Socket.addEventListener(egret.Event.CLOSE,this.CloseListener,this),this.Socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.RespListener,this),this.Socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.ErrorListener,this)}return e.prototype.ExeHandlerAction=function(e,t){for(var n=null,o=this.Handlers.Keys,i=0,a=o.length;a>i;i++)for(var r=this.Handlers[o[i]],s=0,l=r.length;l>s;s++)n=r[s],n?n.ExeAction(e,t):Debug.LogWarning("handler = null");return this},e.prototype.Connect=function(){this.Socket?(this.IsConnected&&(Debug.LogWarning("該Socket已經有連線，執行斷線再重新連線動作"),this.Disconnect()),this.Socket.connectByUrl(this.Url)):Debug.LogError("Socket = null")},e.prototype.Disconnect=function(){Debug.LogErrorWithFlag("Call Disconnect"),this.Socket?this.Socket.close():Debug.LogError("Socket = null")},e.prototype.Clear=function(){for(var e=null,t=this.Handlers.Keys,n=0,o=t.length;o>n;n++){var i=this.Handlers[t[0]];if(i)for(var a=0,r=i.length;r>a;a++)e=i[a],e&&e.Clear&&e.Clear(),e=null;i=null,this.Handlers.Remove(t[0])}this.Socket.removeEventListener(egret.Event.CONNECT,this.ConnectListener,this),this.Socket.removeEventListener(egret.Event.CLOSE,this.CloseListener,this),this.Socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.RespListener,this),this.Socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.ErrorListener,this),this.Socket=null},e.prototype.OnConnect=function(){Debug.LogWithFlag("On Connect"),this.IsConnected=!0;for(var e=null,t=this.Handlers.Keys,n=0,o=t.length;o>n;n++)for(var i=this.Handlers[t[n]],a=0,r=i.length;r>a;a++)e=i[a],e?e.OnConnect():Debug.LogWarning("handler = null")},e.prototype.OnClose=function(){Debug.LogErrorWithFlag("On Close"),this.IsConnected=!1;for(var e=null,t=this.Handlers.Keys,n=0,o=t.length;o>n;n++)for(var i=this.Handlers[t[n]],a=0,r=i.length;r>a;a++)e=i[a],e?e.OnClose():Debug.LogWarning("handler = null")},e.prototype.OnError=function(e){return this.Disconnect(),IsNullOrUndefined(e)?!0:(Debug.LogErrorWithFlag("On Error : "+e),MsgWindow.ShowLangMsg_OKOnly("SocketError",function(){GlobalMethod.ReloadPage()}),!1)},e.prototype.Send=function(e){return this.IsConnected?void(this.Socket&&this.Socket.writeUTF(e)):void Debug.LogWarning("沒有該Socket連線，無法Send Msg")},e.prototype.OnReceiveMsg=function(e){for(var t=null,n=this.Handlers.Keys,o=0,i=n.length;i>o;o++)for(var a=this.Handlers[n[o]],r=0,s=a.length;s>r;r++)t=a[r],t?t.OnMsg(e):Debug.LogWarning("handler = null");this.EnableLog&&ServerDebug.Log("<<WebSocket>> Receive msg : "+e),SendTool.SendData(WebSocketManager.RespEventAction,e)},e.prototype.RegisterHandler=function(e,t,n){void 0===n&&(n=null);var o=this.Handlers.GetValueByKey(t);return null==o&&(o=[]),o.indexOf(e)<0&&o.push(e),e.Init(this,t,n),this.Handlers.Update(t,o),e},e.prototype.UnregisterHandler=function(e,t){var n=this.Handlers.GetValueByKey(t);if(null!=n){var o=n.indexOf(e);o>=0&&n.splice(o,1)}},e.prototype.UnregisterOpcodeAllHandlers=function(e){this.Handlers.Remove(e)},e}();__reflect(WebSocketConnector.prototype,"WebSocketConnector");var WebSocketManager=function(){function e(){this.DefaultType=0,this.Connectors=new Dictionary,this.Handlers=new Dictionary,this.PingDic=new Dictionary,this.PingKeyDic=new Dictionary}return Object.defineProperty(e,"ins",{get:function(){return null==this.Instance&&(this.Instance=new e),this.Instance},enumerable:!0,configurable:!0}),e.prototype.RegisterGetFakeDataHandler=function(e){this.GetFakeDataHandler=e},e.prototype.RegisterHandler=function(e,t,n){void 0===n&&(n=null);var o=this.GetConnector();return o.RegisterHandler(e,t,n)},e.prototype.UnregisterHandler=function(e,t){var n=this.GetConnector();n.UnregisterHandler(e,t)},e.prototype.UnregisterOpcodeAllHandlers=function(e){var t=this.GetConnector();t.UnregisterOpcodeAllHandlers(e)},e.prototype.GetConnector=function(e,t){void 0===e&&(e=this.DefaultType),void 0===t&&(t=null);var n=this.Connectors.GetValueByKey(e);return null==n&&(n=null==t?new WebSocketConnector(GlobalValue.LoginIP,GlobalValue.ShowServerLog):t),this.Connectors.Update(e,n),n},e.prototype.Disconnect=function(e){void 0===e&&(e=this.DefaultType);var t=this.Connectors.GetValueByKey(e);t&&(t.Disconnect(),t.Clear(),t=null,this.Connectors.Remove(e))},e.prototype.GetGameConnector=function(e){void 0===e&&(e=null);var t=e;return null==t&&(this.GameServerConnector||(this.GameServerConnector=this.GetConnector()),t=this.GameServerConnector),t},e.prototype.GetHandler=function(e,t){var n=this.Handlers.GetValueByKey(e);return null==n&&(n=new t),this.Handlers.Update(e,n),n},e.prototype.GetGameHandler=function(e){void 0===e&&(e=null);var t="GameHandler",n=this.Handlers.GetValueByKey(t);return null==n&&(n=null==e?new WebSocketHandler_Game:new e),this.Handlers.Update(t,n),n},e.prototype.Login=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null);var o=n;null==o&&(o=this.GetConnector(this.DefaultType));var i="Login";if(o.RegisterHandler(t,i,e),null==this.GetFakeDataHandler)o.Connect();else{var a=this.GetFakeResponseMsg(i);o.OnReceiveMsg(a)}return o},e.prototype.EnterRoom=function(e,t,n,o,i){void 0===n&&(n=null),void 0===o&&(o=null),void 0===i&&(i=-1);var a="JoinRoom",r=this.GetGameConnector(o),s=null==n?this.GetGameHandler():n;return this.SendGameRequest(a,t,s,r,i,e)},e.prototype.GetJackpot=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null);var o="GetJackpot",i=this.GetGameConnector(n),a=null==t?this.GetHandler(o,WebSocketHandler_GetJackpot):t;return this.SendGameRequest(o,e,a,i)},e.prototype.GetBalance=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null);var o="GetBalance",i=this.GetGameConnector(n),a=null==t?this.GetHandler(o,WebSocketHandler_GetBalance):t;return this.SendGameRequest("GetBalance",e,a,i)},e.prototype.GetSlotGameResult=function(e,t,n,o,i,a){void 0===o&&(o=-1),void 0===i&&(i=null),void 0===a&&(a=null);var r=SlotGameResultType[e],s=this.GetGameConnector(a),l=null==i?this.GetGameHandler():i;return this.SendGameRequest(r,n,l,s,o,t)},e.prototype.GetBorderGameResult=function(e,t,n,o,i){void 0===n&&(n=-1),void 0===o&&(o=null),void 0===i&&(i=null);var a="GetBorderGameResult",r=this.GetGameConnector(i),s=null==o?this.GetGameHandler():o;return this.SendGameRequest(a,t,s,r,n,e)},e.prototype.SendGameRequest=function(e,t,n,o,i,a){void 0===n&&(n=null),void 0===o&&(o=null),void 0===i&&(i=-1),void 0===a&&(a=null);var r=o;null==r&&(r=this.GetConnector(this.DefaultType));var s=n;if(null==s&&(s=this.GetGameHandler()),s==this.GetGameHandler()?r.RegisterHandler(s,"GameHandler",t):r.RegisterHandler(s,e,t),null==this.GetFakeDataHandler)r.ExeHandlerAction(e,a);else{var l=this.GetFakeResponseMsg(e,i,a);r.OnReceiveMsg(l)}return r},e.prototype.SendFakeRespMsg=function(e,t,n,o){void 0===t&&(t=-1),void 0===n&&(n=null),void 0===o&&(o=null);var i=n;if(null==i&&(i=this.GetConnector(this.DefaultType)),null==this.GetFakeDataHandler)Debug.LogError("正式機不支援 SendFakeRespMsg，除非有Register GetFakeDataHandler");else{var a=this.GetFakeResponseMsg(e,t,o);i.OnReceiveMsg(a)}},e.prototype.GetFakeResponseMsg=function(e,t,n){void 0===t&&(t=-1),void 0===n&&(n=null);var o=this.GetFakeDataHandler.GetFakeResponse(e,t,n);return null!=this.GetFakeDataHandler&&null==o?(Debug.LogError("可能沒有把假資料掛到default.res的Json裡"),null):o},e.prototype.StartCalcPing=function(e){this.PingDic.ContainsKey(e)||this.PingDic.Add(e,new PingData);var t=this.PingDic[e];t.TimeKey=Time.Register(function(e){t.TimeCounter+=e})},e.prototype.StopCalcPing=function(e){if(this.PingDic.ContainsKey(e)){var t=this.PingDic[e];t.SetToHistory(),Time.UnregisterByKey(t.TimeKey)}},e.prototype.GetPing=function(){for(var e=0,t=this.PingDic.Values,n=t.length,o=0;n>o;o++){var i=t[o];e+=i.Ping}return 0==n&&(n=1),e/n},e.RespEventAction="OnWebSocketResponse",e}();__reflect(WebSocketManager.prototype,"WebSocketManager");var WebSocketHandler_Game=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.ExeAction=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];switch(e.prototype.ExeAction.apply(this,[t].concat(n)),t){case SlotGameResultType[SlotGameResultType.GetSlotNormalGameResult]:var i="0";i=BigNumDiv(AppData.Account.BetTotal.toString(),AppData.Account.BaseBet.toString(),GlobalValue.NumberDigits),this.SendCustomFormat(t,[{Key:"Bet",Value:i}]);break;case SlotGameResultType[SlotGameResultType.GetSlotFreeGameResult]:var a=n[0];this.SendCustomFormat(t,a);break;case SlotGameResultType[SlotGameResultType.GetSlotBonusGameResult]:var r=n[0];this.SendCustomFormat(t,r);break;case"GetBorderGameResult":var s=n[0];this.SendCustomFormat(t,s)}},t.prototype.OnMsg=function(e){if(this.HandleError(e)){var t=JSON.parse(e),n=t.OpCode;switch(n){case SlotGameResultType[SlotGameResultType.GetSlotNormalGameResult]:case SlotGameResultType[SlotGameResultType.GetSlotFreeGameResult]:case SlotGameResultType[SlotGameResultType.GetSlotBonusGameResult]:case"GetBorderGame":var o=t.Data;o?this.ExeCallback(n,JSON.stringify(o)):Debug.LogError(n+' 沒有 ["Data"] 欄位')}}},t.prototype.JoinGameRoomFinish=function(e,t){this.ExeCallback(e,JSON.stringify(t))},t}(WebSocketHandlerBase);__reflect(WebSocketHandler_Game.prototype,"WebSocketHandler_Game");var WebSocketHandler_GetBalance=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.ExeAction=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];switch(e.prototype.ExeAction.apply(this,[t].concat(n)),t){case"GetBalance":this.SendCustomFormat(t,[])}},t.prototype.OnMsg=function(e){if(this.HandleError(e)){var t=JSON.parse(e),n=t.OpCode;switch(n){case"GetBalance":var o=t.Data;o?this.ExeCallback(n,JSON.stringify(o)):Debug.LogError(n+' 沒有 ["Data"] 欄位')}}},t}(WebSocketHandlerBase);__reflect(WebSocketHandler_GetBalance.prototype,"WebSocketHandler_GetBalance");var WebSocketHandler_GetJackpot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.ExeAction=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];switch(e.prototype.ExeAction.apply(this,[t].concat(n)),t){case"GetJackpot":this.SendCustomFormat(t,[{Key:"SessionID",Value:AppData.Account.SessionID},{Key:"GameID",Value:GlobalValue.GameID}])}},t.prototype.OnMsg=function(e){if(this.HandleError(e)){var t=JSON.parse(e),n=t.OpCode;switch(n){case"GetJackpot":var o=t.Data;if(o){for(var i=Method.ParseValueToInt(GlobalValue.GameID),a=0,r=o.length;r>a;a++)if(o[a].GameID==i){this.ExeCallback(n,JSON.stringify(o[a]));break}}else Debug.LogError(n+' 沒有 ["Data"] 欄位')
}}},t}(WebSocketHandlerBase);__reflect(WebSocketHandler_GetJackpot.prototype,"WebSocketHandler_GetJackpot");var PingData=function(){function e(){this.TimeKey="",this.TimeCounter=0,this.History=[]}return e.prototype.SetToHistory=function(){this.History.push(this.TimeCounter),this.TimeCounter=0},Object.defineProperty(e.prototype,"Ping",{get:function(){for(var e=0,t=this.History.length,n=0;t>n;n++)e+=this.History[n];return e/t},enumerable:!0,configurable:!0}),e}();__reflect(PingData.prototype,"PingData");var ConnectDirectionType;!function(e){e[e.BeforeLogin=1]="BeforeLogin",e[e.ClientServer=2]="ClientServer",e[e.ServerClient=3]="ServerClient",e[e.ServerServer=4]="ServerServer"}(ConnectDirectionType||(ConnectDirectionType={}));var WebSocketHandlerMiddlewareBase=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(WebSocketHandlerBase);__reflect(WebSocketHandlerMiddlewareBase.prototype,"WebSocketHandlerMiddlewareBase");var WalletType;!function(e){e[e.None=0]="None",e[e.Seamless=1]="Seamless",e[e.Transfer=2]="Transfer"}(WalletType||(WalletType={}));var JPCashType;!function(e){e[e.Default=0]="Default",e[e.Int=1]="Int",e[e.Float=2]="Float"}(JPCashType||(JPCashType={}));var SlotSpinSpeed;!function(e){e[e.Normal=0]="Normal",e[e.Fast=1]="Fast",e[e.InstantStop=2]="InstantStop"}(SlotSpinSpeed||(SlotSpinSpeed={}));var AccountData=function(){function e(){this.PlayerID="",this.PlayerName="",this.Money="",this.Token="",this.ReportUrl="",this.WalletType=WalletType.None,this.NickName="",this.SessionID="",this.LobbyID=0,this.Symbol="",this.MaxBetRate=0,this.MinBetRate=0,this.BetSizeDefaultIndex=0,this.BetSizes=[],this.BetMultiples=[],this.BaseBet=0,this.BetTotal=0,this.GameWinRates=[],this.CashScale=0,this.CashDigits=0,this.JPCashType=JPCashType.Default,this.CustomDisplayCashScale=1,this.CoinIndex=0}return e}();__reflect(AccountData.prototype,"AccountData");var GameSettingsData=function(){function e(){this.GetJackpotIntervalDuration=3,this.SlotSpinSpeed=SlotSpinSpeed.Normal,this.SlotAutoSpinTimes=10,this.SlotAutoSpinTimesArray=[10,20,30,50,80,100],this.MaxSlotSymbolIndex=0,this.SlotDefaultDisplayBoard=[],this.ShowSingleLine=!1,this.LineTimes=0,this.ShowBigWin=!0,this.MarqueeTipIntervalDuration=6,this.ShowWinLoop=!0}return e}();__reflect(GameSettingsData.prototype,"GameSettingsData");var AppData=function(){function e(){}return e.SetupGameConfig=function(e){this.GameSettings=e},e.SetupCustomConfig=function(e){this.CustomConfigText=e},e.GetCustomConfig=function(e){return IsNullOrUndefined(this.CustomConfigText[e])?(Debug.LogError("GetCustomConfig Failure: "+e),""):this.CustomConfigText[e]},e.Account=new AccountData,e.GameSettings=new GameSettingsData,e}();__reflect(AppData.prototype,"AppData");var GlobalValue=function(){function e(){}return Object.defineProperty(e,"GameMode",{get:function(){var e=Method.ParseValueToEnum(GameMode,Method.ParseValueToInt(egret.getOption("gameMode"),GameMode.Formal));return IsNullOrUndefined(e)?GameMode.Formal:e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"UserAgent",{get:function(){return navigator.userAgent},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Domain",{get:function(){return"//"+window.location.hostname},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsHttps",{get:function(){return window.location.protocol.indexOf("https")>=0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"LoginIP",{get:function(){return this.AssignIP?this.AssignIP:e.GetAppConfig("IP")},set:function(e){this.AssignIP=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NumberDigits",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ClientToServerMoneyScale",{get:function(){return 100},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ServerToClientMoneyScale",{get:function(){return MathDiv(1,this.ClientToServerMoneyScale)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsConnectVer",{get:function(){return this.GameMode==GameMode.Formal||this.GameMode==GameMode.TestServer},enumerable:!0,configurable:!0}),Object.defineProperty(e,"IsMobile",{get:function(){return egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OSType",{get:function(){var e=egret.Capabilities.os.replace(" ","");return OSType[e]},enumerable:!0,configurable:!0}),Object.defineProperty(e,"PackageName",{get:function(){return e.GetAppConfig("PackageName")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GameGroup",{get:function(){return e.GetAppConfig("GameGroup")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GameID",{get:function(){return this.AssignGameID?this.AssignGameID:e.GetAppConfig("GameID")},set:function(e){this.AssignGameID=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"GameType",{get:function(){return this.AssignGameType?this.AssignGameType:e.GetAppConfig("GameType")},set:function(e){this.AssignGameType=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"UseWebSocket",{get:function(){return Method.ParseValueToBoolean(e.GetAppConfig("UseWebSocket"),!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"UseAutoBot",{get:function(){return Method.ParseValueToBoolean(egret.getOption("autoBot").toLowerCase(),!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ShowLog",{get:function(){return Method.ParseValueToBoolean(egret.getOption("debug").toLowerCase(),!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ShowServerLog",{get:function(){return Method.ParseValueToBoolean(egret.getOption("serverDebug").toLowerCase(),!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Version",{get:function(){var e=this.GetAppConfig("Version");return StringIsNullOrEmpty(e)?"0.01":e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ClientVersion",{get:function(){var e=this.GetAppConfig("ClientVersion");return StringIsNullOrEmpty(e)?"":e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"ScreenScaleMode",{get:function(){var e=Method.ParseValueToInt(egret.getOption("scaleMode"),0/0);switch(e){case 0:return egret.StageScaleMode.SHOW_ALL;case 1:return egret.StageScaleMode.FIXED_WIDTH}return egret.StageScaleMode.FIXED_WIDTH},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EgretElement",{get:function(){return null==this._Egret&&(this._Egret=document.getElementById("Egret")),this._Egret},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EgretElementWidth",{get:function(){return Method.ParseValueToFloat(this.EgretElement.getAttribute("data-content-width"),1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"EgretElementHeight",{get:function(){return Method.ParseValueToFloat(this.EgretElement.getAttribute("data-content-height"),1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FitWidthRatio",{get:function(){return Method.ParseValueToFloat(this.EgretElement.getAttribute("data-fit-width-ratio"),9)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"FitHeightRatio",{get:function(){return Method.ParseValueToFloat(this.EgretElement.getAttribute("data-fit-height-ratio"),16)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NoSleep",{get:function(){return Method.ParseValueToBoolean(egret.getOption("noSleep").toLowerCase(),!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AudioMute",{get:function(){return Method.ParseValueToBoolean(egret.getOption("mute").toLowerCase(),!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"BGMMute",{get:function(){return Method.ParseValueToBoolean(egret.getOption("bgmMute").toLowerCase(),!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"AudioVolume",{get:function(){return Method.ParseValueToNumber(egret.getOption("volume"),100)/100},enumerable:!0,configurable:!0}),Object.defineProperty(e,"HomeUrl",{get:function(){return decodeURIComponent(Method.ParseValueToString(egret.getOption("homeUrl"),""))},enumerable:!0,configurable:!0}),Object.defineProperty(e,"HomeCallMethod",{get:function(){return Method.ParseValueToString(egret.getOption("homeCallback"),"")},enumerable:!0,configurable:!0}),e.GetCustomBoolValue=function(e,t){return void 0===t&&(t=!1),Method.ParseValueToBoolean(egret.getOption(e),t)},e.GetCustomStringValue=function(e,t){void 0===t&&(t="");var n=egret.getOption(e);return IsNullOrUndefined(n)||StringIsNullOrEmpty(n)?t:n},e.GetCustomIntValue=function(e,t){return void 0===t&&(t=-1),Method.ParseValueToInt(egret.getOption(e),t)},e.GetCustomFloatValue=function(e,t){return void 0===t&&(t=-1),Method.ParseValueToNumber(egret.getOption(e),t)},e.SetupAppConfig=function(e){this.AppConfig=e},e.GetAppConfig=function(e){return IsNullOrUndefined(this.AppConfig[e])?(Debug.LogError("GetAppConfig Failure: "+e),""):this.AppConfig[e]},e.NeedToOpenWallet=!0,e.LoginToken="",e.LoginServer="",e.AssignIP="",e.AssignGameID="",e.AssignGameType="",e.AllowPortrait=!0,e.IOSCanvasEdgeSizePercent=5,e}();__reflect(GlobalValue.prototype,"GlobalValue");var FieldType;!function(e){e[e.Boolean=0]="Boolean",e[e.Byte=1]="Byte",e[e.Short=2]="Short",e[e.Int=3]="Int",e[e.Float=4]="Float",e[e.Long=5]="Long",e[e.String=6]="String",e[e.Double=7]="Double",e[e.Object=8]="Object",e[e.Array=9]="Array",e[e.DicValueArray=10]="DicValueArray",e[e.NumberArray=11]="NumberArray"}(FieldType||(FieldType={}));var FieldValue=function(){function e(e,t){void 0===t&&(t=null),this.FieldType=e,this.DefaultValue=t}return e.prototype.GetValue=function(e){switch(this.FieldType){case FieldType.Boolean:return Method.ParseValueToBoolean(e,this.DefaultValue);case FieldType.Byte:case FieldType.Short:case FieldType.Int:case FieldType.Long:return Method.ParseValueToInt(e,this.DefaultValue);case FieldType.Float:case FieldType.Double:return Method.ParseValueToNumber(e,this.DefaultValue);case FieldType.String:return Method.ParseValueToString(e,this.DefaultValue);case FieldType.Object:return Method.ParseValueToAny(e,this.DefaultValue);case FieldType.Array:return Method.ParseValueToArray(e,this.DefaultValue);case FieldType.DicValueArray:return Method.ParseDicValueToArray(e);case FieldType.NumberArray:for(var t=[],n=Method.ParseValueToString(e),o=n.split(","),i=0,a=o.length;a>i;i++)t.push(Method.ParseValueToNumber(o[i],this.DefaultValue));return t}},e}();__reflect(FieldValue.prototype,"FieldValue");var PhotonConnector=function(e){function t(t,n){void 0===n&&(n=!1);var o=e.call(this,t)||this;return o.EnableLog=!0,o.Handlers=new Dictionary,Debug.Log("Connect url = "+t),o.EnableLog=n,e.prototype.addPeerStatusListener.call(o,Photon.PhotonPeer.StatusCodes.connecting,function(){o.OnConnecting()}),e.prototype.addPeerStatusListener.call(o,Photon.PhotonPeer.StatusCodes.connect,function(){o.OnConnect()}),e.prototype.addPeerStatusListener.call(o,Photon.PhotonPeer.StatusCodes.connectFailed,function(){o.OnConnectFailed()}),e.prototype.addPeerStatusListener.call(o,Photon.PhotonPeer.StatusCodes.disconnect,function(){o.OnDisconnect()}),e.prototype.addPeerStatusListener.call(o,Photon.PhotonPeer.StatusCodes.connectClosed,function(){o.OnClose()}),e.prototype.addPeerStatusListener.call(o,Photon.PhotonPeer.StatusCodes.error,function(){o.OnError()}),e.prototype.addPeerStatusListener.call(o,Photon.PhotonPeer.StatusCodes.timeout,function(){o.OnTimeout()}),e.prototype.addResponseListener.call(o,ConnectDirectionType.ServerClient,function(e){o.OnReceiveMsg(e)}),o}return __extends(t,e),Object.defineProperty(t.prototype,"IsClosing",{get:function(){return this.isClosing()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsConnected",{get:function(){return this.isConnected()},enumerable:!0,configurable:!0}),t.prototype.RegisterHandler=function(e,t){return void 0===t&&(t=null),null==e?(Debug.LogError("沒有Handler"),null):(e.Init(this,t),void this.Handlers.Update(e.HandlerKey,e))},t.prototype.GetHandlerByKey=function(e){var t=this.Handlers.GetValueByKey(e);return t},t.prototype.UnregisterHandler=function(e){this.Handlers.RemoveByValue(e)},t.prototype.UnregisterHandlerByKey=function(e){this.Handlers.Remove(e)},t.prototype.SetParams=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this},t.prototype.ExeHandlerAction=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var o=null,i=this.Handlers.Values,a=0,r=i.length;r>a;a++)o=i[a],o.ExeAction.apply(o,[e].concat(t));return this},t.prototype.Connect=function(){return this.IsConnected&&(Debug.LogWarning("該Socket已經有連線，執行斷線再重新連線動作"),this.Disconnect()),e.prototype.connect.call(this,0),this},t.prototype.Disconnect=function(){e.prototype.disconnect.call(this)},t.prototype.OnConnecting=function(){Debug.Log("On Connecting")},t.prototype.OnConnect=function(){Debug.Log("On Connect");for(var e=null,t=this.Handlers.Values,n=0,o=t.length;o>n;n++)e=t[n],e.OnConnect()},t.prototype.OnDisconnect=function(){Debug.Log("On Disconnect")},t.prototype.OnClose=function(){Debug.Log("On Close");for(var e=null,t=this.Handlers.Values,n=0,o=t.length;o>n;n++)e=t[n],e.OnClose()},t.prototype.OnConnectFailed=function(){Debug.Log("On Connect Failed"),MsgWindow.ShowLangMsg(MsgWindowType.TwoBtn,"SocketConnectFailed","Retry","Cancel",function(e,t){switch(t){case MsgWindowBtnType.LeftBtn:GlobalMethod.ReloadPage();break;case MsgWindowBtnType.RightBtn:GlobalMethod.ReturnToHome()}})},t.prototype.OnError=function(){Debug.Log("On Error"),this.Disconnect(),MsgWindow.ShowLangMsg_OKOnly("SocketError",function(){GlobalMethod.ReloadPage()})},t.prototype.OnTimeout=function(){Debug.Log("On Timeout"),MsgWindow.ShowLangMsg_OKOnly("SocketTimeout",function(){GlobalMethod.ReloadPage()})},t.prototype.Send=function(e,t){void 0===t&&(t=null);var n=new PhotonMsgBuilder;if(null!=t)for(var o=0,i=t.length;i>o;o++)n.Add(t[o].Key,t[o].Value,t[o].ValueType);this.SendRequest(e,n)},t.prototype.SendRequest=function(e,t){if(!this.IsConnected||this.IsClosing)return void Debug.LogWarning("沒有該Socket連線，無法Send Msg");var n;if(e>PhotonProtocol.PlayerMessageBegin&&e<PhotonProtocol.PlayerMessageEnd){var o=new PhotonMsgBuilder;o.Add(0,e,FieldType.Int),o.Add(1,t.Msgs,FieldType.Object),n=o.Msgs,this.RequestProtocol=PhotonProtocol.PlayerMessage}else n=t.Msgs,this.RequestProtocol=e;var i=new PhotonMsgBuilder;i.Add(PhotonTransFieldType.MessageID,this.RequestProtocol,FieldType.Int),i.Add(PhotonTransFieldType.RemoteType,PhotonConnetorType.Client,FieldType.Int),i.Add(PhotonTransFieldType.Data,n,FieldType.Object),i.Add(PhotonTransFieldType.SelfDefinedType,!0,FieldType.Boolean),this.EnableLog&&ServerDebug.Log("<<Photon>> Send Request : "+PhotonProtocol[e]+" / param : "+n),this.sendOperation(ConnectDirectionType.ClientServer,i.Msgs,!0)},t.prototype.OnReceiveMsg=function(e){if(0!=Method.ParseValueToInt(e.errCode,0))return void MsgWindow.ShowMsgWithTitle_OKOnly(PhotonProtocol[this.RequestProtocol]+" Socket Error",e.errMsg,function(){GlobalMethod.ReturnToHome()});var t=e.vals,n=t[PhotonTransFieldType.MessageID],o=(t[PhotonTransFieldType.RemoteType],t[PhotonTransFieldType.Data]);if(n===PhotonProtocol.PlayerMessage&&(n=o[0],o=o[1]),this.EnableLog&&ServerDebug.Log("<<Photon>> Receive msg : "+JSON.stringify(o).replace(/\\/g,"")),n===PhotonProtocol.KickPlayer){var i=Method.ParseValueToString(9e4+o[0]),a=LanguageManager.GetText(i);return void MsgWindow.ShowMsg_OKOnly(a,function(){GlobalMethod.ReturnToHome()})}this.OnHandleResponse(n,o)},t.prototype.OnHandleResponse=function(e,t){SendTool.SendData(PhotonManager.RespEventAction,e,t);for(var n=null,o=this.Handlers.Values,i=0,a=o.length;a>i;i++)n=o[i],n.OnMsg(e,t)},t}(Photon.PhotonPeer);__reflect(PhotonConnector.prototype,"PhotonConnector");var KeyCode;!function(e){e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.Escape=27]="Escape",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.ScrollLock=145]="ScrollLock",e[e.Pause=19]="Pause",e[e.BackQuote=192]="BackQuote",e[e.Alpha0=48]="Alpha0",e[e.Alpha1=49]="Alpha1",e[e.Alpha2=50]="Alpha2",e[e.Alpha3=51]="Alpha3",e[e.Alpha4=52]="Alpha4",e[e.Alpha5=53]="Alpha5",e[e.Alpha6=54]="Alpha6",e[e.Alpha7=55]="Alpha7",e[e.Alpha8=56]="Alpha8",e[e.Alpha9=57]="Alpha9",e[e.Minus=189]="Minus",e[e.Equals=187]="Equals",e[e.Backspace=8]="Backspace",e[e.Tab=9]="Tab",e[e.LeftBracket=219]="LeftBracket",e[e.RightBracket=221]="RightBracket",e[e.Backslash=220]="Backslash",e[e.CapsLock=20]="CapsLock",e[e.Semicolon=186]="Semicolon",e[e.Return=13]="Return",e[e.LeftShift=16]="LeftShift",e[e.Comma=188]="Comma",e[e.Period=190]="Period",e[e.Slash=191]="Slash",e[e.LeftControl=17]="LeftControl",e[e.LeftWindows=91]="LeftWindows",e[e.LeftAlt=18]="LeftAlt",e[e.Space=32]="Space",e[e.Menu=93]="Menu",e[e.Insert=45]="Insert",e[e.Home=36]="Home",e[e.PageUp=33]="PageUp",e[e.Delete=46]="Delete",e[e.End=35]="End",e[e.PageDown=34]="PageDown",e[e.LeftArrow=37]="LeftArrow",e[e.UpArrow=38]="UpArrow",e[e.RightArrow=39]="RightArrow",e[e.DownArrow=40]="DownArrow",e[e.Numlock=144]="Numlock",e[e.KeypadEnter=13]="KeypadEnter",e[e.KeypadMultiply=106]="KeypadMultiply",e[e.KeypadPlus=107]="KeypadPlus",e[e.KeypadMinus=109]="KeypadMinus",e[e.KeypadPeriod=110]="KeypadPeriod",e[e.KeypadDivide=111]="KeypadDivide",e[e.Keypad0=96]="Keypad0",e[e.Keypad1=97]="Keypad1",e[e.Keypad2=98]="Keypad2",e[e.Keypad3=99]="Keypad3",e[e.Keypad4=100]="Keypad4",e[e.Keypad5=101]="Keypad5",e[e.Keypad6=102]="Keypad6",e[e.Keypad7=103]="Keypad7",e[e.Keypad8=104]="Keypad8",e[e.Keypad9=105]="Keypad9"}(KeyCode||(KeyCode={}));var OpenWindowTargetType;!function(e){e[e._blank=0]="_blank",e[e._self=1]="_self",e[e._parent=2]="_parent",e[e._top=3]="_top"}(OpenWindowTargetType||(OpenWindowTargetType={}));var GlobalMethod=function(){function e(){}return e.OpenURL=function(e,t){return window.open(e,OpenWindowTargetType[t])},e.ReturnToHome=function(){var e=GlobalValue.HomeCallMethod;StringIsNullOrEmpty(e)||null!=window[e]&&window[e](),StringIsNullOrEmpty(GlobalValue.HomeUrl)?(window.location.href="about:blank",window.close()):this.OpenURL(GlobalValue.HomeUrl,OpenWindowTargetType._self)},e.ReloadPage=function(e){location.reload(e)},e.CloseWindow=function(){this.OpenURL("",OpenWindowTargetType._self).close()},e.ClearCookie=function(e){for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var o=t[n].split("=");if(o[0]==e){document.cookie=t[n]+"=;expires="+new Date(0).toUTCString();break}}},e.ClearAllCookies=function(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++)document.cookie=e[t]+"=;expires="+new Date(0).toUTCString()},e}();__reflect(GlobalMethod.prototype,"GlobalMethod");var CurveMethod;!function(e){e[e.Linear=0]="Linear",e[e.EaseIn=1]="EaseIn",e[e.EaseOut=2]="EaseOut",e[e.EaseInOut=3]="EaseInOut"}(CurveMethod||(CurveMethod={}));var CurveValue=function(){function e(){}return e.GetValue=function(e){switch(e=this.GetEnumIndex(CurveMethod,e)){case CurveMethod.Linear:return this.LinearValue;case CurveMethod.EaseIn:return this.EaseInValue;case CurveMethod.EaseOut:return this.EaseOutValue;case CurveMethod.EaseInOut:return this.EaseInOutValue}return this.CustomValues[Number(e)-this.GetEnumCount(CurveMethod)]},e.GetEnumIndex=function(e,t){if(!isNaN(t))return t;var n=-1,o=0,i=isNaN(t)?t.toString():e[t];for(var a in e)if(isNaN(Number(a))){if(a===i){n=o;break}o++}return n},e.GetEnumCount=function(e){var t=0;for(var n in e)isNaN(parseInt(n))||t++;return t},e.CustomValues=[],e.LinearValue=[0,.01694915,.03389831,.05084746,.06779661,.08474576,.1016949,.1186441,.1355932,.1525424,.1694915,.1864407,.2033898,.220339,.2372881,.2542373,.2711864,.2881356,.3050847,.3220339,.338983,.3559321,.3728813,.3898304,.4067796,.4237287,.4406779,.457627,.4745762,.4915253,.5084745,.5254236,.5423728,.559322,.5762712,.5932204,.6101695,.6271187,.6440679,.6610171,.6779662,.6949154,.7118646,.7288138,.7457629,.7627121,.7796613,.7966105,.8135597,.8305088,.847458,.8644072,.8813564,.8983055,.9152547,.9322039,.9491531,.9661022,.9830514,1],e.EaseInValue=[0,.0002872738,.001149095,.002585464,.004596381,.007181845,.01034186,.01407642,.01838552,.02326917,.02872737,.03476012,.04136742,.04854925,.05630564,.06463659,.07354207,.0830221,.09307668,.1037058,.1149095,.1266877,.1390405,.1519678,.1654696,.179546,.194197,.2094225,.2252225,.2415971,.2585463,.27607,.2941683,.3128411,.3320885,.3519104,.3723069,.3932779,.4148234,.4369436,.4596382,.4829074,.5067512,.5311695,.5561624,.5817298,.6078717,.6345882,.6618793,.6897449,.7181851,.7471998,.776789,.8069528,.8376912,.8690041,.9008915,.9333535,.9663901,1],e.EaseOutValue=[0,.03361103,.06664751,.09910945,.1309968,.1623097,.193048,.2232117,.2528009,.2818156,.3102556,.3381212,.3654122,.3921286,.4182706,.4438379,.4688308,.493249,.5170927,.5403619,.5630565,.5851766,.6067221,.6276931,.6480896,.6679115,.6871588,.7058315,.7239298,.7414535,.7584026,.7747773,.7905774,.8058029,.8204539,.8345303,.8480322,.8609595,.8733124,.8850906,.8962942,.9069234,.916978,.926458,.9353635,.9436945,.9514509,.9586327,.96524,.9712728,.9767309,.9816146,.9859237,.9896582,.9928182,.9954037,.9974146,.9988509,.9997128,1],e.EaseInOutValue=[0,.0008520832,.00336938,.007493463,.0131659,.02032827,.02892214,.03888908,.05017066,.06270845,.07644403,.09131896,.1072748,.1242532,.1421956,.1610437,.180739,.2012231,.2224375,.2443238,.2668237,.2898786,.3134302,.33742,.3617896,.3864805,.4114344,.4365927,.4618971,.4872892,.5127105,.5381026,.5634071,.5885655,.6135194,.6382103,.66258,.6865698,.7101215,.7331764,.7556763,.7775627,.7987772,.8192612,.8389565,.8578047,.8757471,.8927255,.9086813,.9235563,.9372919,.9498296,.9611112,.9710781,.979672,.9868343,.9925067,.9966307,.999148,1],e}();__reflect(CurveValue.prototype,"CurveValue");var Debug=function(){function e(){}return e.init=function(e){this.ShowDebug=e},e.Log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ShowDebug&&console.log(this.FrontString+this.GetLogString.apply(this,e))},e.LogWarning=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ShowDebug&&console.warn(this.FrontString+this.GetLogString.apply(this,e))},e.LogError=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ShowDebug&&console.error(this.FrontString+this.GetLogString.apply(this,e))},e.LogAlert=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ShowDebug&&alert(this.FrontString+this.GetLogString.apply(this,e))},e.LogOnHtml=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(this.Log.apply(this,t),GlobalValue.GetCustomBoolValue("htmlLog",!1)){var o="LogMsg",i=document.getElementById(o);if(null==i){i=document.createElement("div"),i.id=o,i.setAttribute("style","position: fixed; z-Index: "+e.HtmlLogElementZIndex+"; top: 0px; left: 0px; border: none; padding: 0px; color:white;");var a=document.getElementById("Egret");null!=a&&document.body.insertBefore(i,a.nextSibling)}if(null!=i){var r=new Date,s=r.getHours()+":"+r.getMinutes()+":"+Method.GetFixIntNumberWithZeroString(r.getSeconds(),60);this.Msg.push(s+" | "+this.FrontString+this.GetLogString.apply(this,t));for(var l="";this.Msg.length>this.MsgLimitCount;)Method.ArrayRemoveItemAt(this.Msg,0);for(var u=0,c=this.Msg;u<c.length;u++){var h=c[u];l+=h+"<br />"}i.innerHTML=l,i.style.backgroundColor="rgba(0, 0, 0, 0.5)"}}},e.HideHtmlLogMsg=function(){var e=document.getElementById("LogMsg");null!=e&&(e.innerHTML="",e.style.backgroundColor="rgba(0, 0, 0, 0)")},e.LogWithFlag=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ShowDebug&&console.log(this.FrontString+"--------------- "+this.GetLogString.apply(this,e)+" ---------------")},e.LogWarningWithFlag=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ShowDebug&&console.warn(this.FrontString+"--------------- "+this.GetLogString.apply(this,e)+" ---------------")},e.LogErrorWithFlag=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ShowDebug&&console.error(this.FrontString+"--------------- "+this.GetLogString.apply(this,e)+" ---------------")},e.GetLogString=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return null!=e&&e.length>0?1==e.length?e[0]:this.GetLogValueFormat.apply(this,e):""},e.GetLogValueFormat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="",o=e.length;o%2!=0&&o--;for(var i=0;o>i;i++)n+=i%2==0?"["+(null==e[i]?"NULL_KEY":e[i])+" = ":(null==e[i]?"NULL_VALUE":e[i])+"]";return n},e.HtmlLogElementZIndex=100,e.FrontString="",e.ShowDebug=!0,e.MsgLimitCount=10,e.Msg=[],e}();__reflect(Debug.prototype,"Debug");var PhotonConnetorType;!function(e){e[e.Unknown=0]="Unknown",e[e.Client=1]="Client",e[e.Login=2]="Login",e[e.Game=3]="Game"}(PhotonConnetorType||(PhotonConnetorType={}));var PhotonTransFieldType;!function(e){e[e.MessageID=0]="MessageID",e[e.SenderID=1]="SenderID",e[e.RemoteType=2]="RemoteType",e[e.Data=3]="Data",e[e.SelfDefinedType=4]="SelfDefinedType"}(PhotonTransFieldType||(PhotonTransFieldType={}));var PhotonProtocol;!function(e){e[e.LoginAccountRequest=0]="LoginAccountRequest",e[e.LoginAccountResponse=1]="LoginAccountResponse",e[e.LoginLobbyRequest=2]="LoginLobbyRequest",e[e.LoginLobbyResponse=3]="LoginLobbyResponse",e[e.KickPlayer=4]="KickPlayer",e[e.PlayerMessage=1e5]="PlayerMessage",e[e.PlayerMessageBegin=100001]="PlayerMessageBegin",e[e.LobbyChangeNicknameRequest=100002]="LobbyChangeNicknameRequest",e[e.LobbyChangeNicknameResponse=100003]="LobbyChangeNicknameResponse",e[e.JoinGameRoomRequest=100004]="JoinGameRoomRequest",e[e.JoinGameRoomResponse=100005]="JoinGameRoomResponse",e[e.LeaveGameRoomRequest=100006]="LeaveGameRoomRequest",e[e.LeaveGameRoomResponse=100007]="LeaveGameRoomResponse",e[e.GetSlotGameResultRequest=100008]="GetSlotGameResultRequest",e[e.GetSlotGameResultResponse=100009]="GetSlotGameResultResponse",e[e.UseItemRequest=100010]="UseItemRequest",e[e.UseRewardItemResponse=100011]="UseRewardItemResponse",e[e.UseFullPlateItemResponse=100012]="UseFullPlateItemResponse",e[e.UseMoneyItemResponse=100013]="UseMoneyItemResponse",e[e.UseItemFaild=100014]="UseItemFaild",e[e.RetrieveCouponsPrizeRequest=100015]="RetrieveCouponsPrizeRequest",e[e.RetrieveCouponsPrizeResponse=100016]="RetrieveCouponsPrizeResponse",e[e.RetrieveOtherPlayerByNickRequest=100017]="RetrieveOtherPlayerByNickRequest",e[e.RetrieveOtherPlayerByGidRequest=100018]="RetrieveOtherPlayerByGidRequest",e[e.RetrieveOtherPlayerResponse=100019]="RetrieveOtherPlayerResponse",e[e.RetrieveFreezeMoneyAmountRequest=100020]="RetrieveFreezeMoneyAmountRequest",e[e.RetrieveFreezeMoneyAmountResponse=100021]="RetrieveFreezeMoneyAmountResponse",e[e.RetrieveTraderRequest=100022]="RetrieveTraderRequest",e[e.RetrieveTraderResponse=100023]="RetrieveTraderResponse",e[e.RemoveTraderRequest=100024]="RemoveTraderRequest",e[e.RemoveTraderResponse=100025]="RemoveTraderResponse",e[e.SetTradePasswordRequest=100026]="SetTradePasswordRequest",e[e.SetTradePasswordResponse=100027]="SetTradePasswordResponse",e[e.CreateNewTradeRequest=100028]="CreateNewTradeRequest",e[e.CreateNewTradeResponse=100029]="CreateNewTradeResponse",e[e.ReplyTradeRequest=100030]="ReplyTradeRequest",e[e.ReplyTradeResponse=100031]="ReplyTradeResponse",e[e.CheckNewTradeRequest=100032]="CheckNewTradeRequest",e[e.CheckNewTradeResponse=100033]="CheckNewTradeResponse",e[e.RetrieveTradeTransactionRequest=100034]="RetrieveTradeTransactionRequest",e[e.RetrieveTradeTransactionResponse=100035]="RetrieveTradeTransactionResponse",e[e.ExpiredTradeRequest=100036]="ExpiredTradeRequest",e[e.ExpiredTradeResponse=100037]="ExpiredTradeResponse",e[e.BulletinRequest=100038]="BulletinRequest",e[e.BulletinResponse=100039]="BulletinResponse",e[e.MarqueeRequest=100040]="MarqueeRequest",e[e.MarqueeResponse=100041]="MarqueeResponse",e[e.RetrieveScratchCardRequest=100042]="RetrieveScratchCardRequest",e[e.RetrieveScratchCardResponse=100043]="RetrieveScratchCardResponse",e[e.RetrieveScratchCardRecordRequest=100044]="RetrieveScratchCardRecordRequest",e[e.RetrieveScratchCardRecordResponse=100045]="RetrieveScratchCardRecordResponse",e[e.UseScratchCardRequest=100046]="UseScratchCardRequest",e[e.UseScratchCardResponse=100047]="UseScratchCardResponse",e[e.RetrieveLotteryInfoRequest=100048]="RetrieveLotteryInfoRequest",e[e.RetrieveLotteryInfoResponse=100049]="RetrieveLotteryInfoResponse",e[e.RetrieveLotteryInfoResponseRepeat=100050]="RetrieveLotteryInfoResponseRepeat",e[e.RetrieveLotteryHistoryRequest=100051]="RetrieveLotteryHistoryRequest",e[e.RetrieveLotteryHistoryResponse=100052]="RetrieveLotteryHistoryResponse",e[e.RetrieveLotteryHistoryResponseRepeat=100053]="RetrieveLotteryHistoryResponseRepeat",e[e.ExchangeLotteryTicketsRequest=100054]="ExchangeLotteryTicketsRequest",e[e.ExchangeLotteryTicketsResponse=100055]="ExchangeLotteryTicketsResponse",e[e.DealPurchaseRequest=100056]="DealPurchaseRequest",e[e.DealPurchaseResponse=100057]="DealPurchaseResponse",e[e.PurchaseTransactionRequest=100058]="PurchaseTransactionRequest",e[e.PurchaseTransactionResponse=100059]="PurchaseTransactionResponse",e[e.QueryLotteryMoneyRequest=100060]="QueryLotteryMoneyRequest",e[e.QueryLotteryMoneyResponse=100061]="QueryLotteryMoneyResponse",e[e.ClientCheckNewDistributionMessageRequest=100062]="ClientCheckNewDistributionMessageRequest",e[e.ProductListRequest=100063]="ProductListRequest",e[e.ProductListResponse=100064]="ProductListResponse",e[e.SyncMultiPlayerGame=100065]="SyncMultiPlayerGame",e[e.PurchasePayPalRequest=100066]="PurchasePayPalRequest",e[e.PurchasePayPalResponse=100067]="PurchasePayPalResponse",e[e.GetBalanceRequest=100068]="GetBalanceRequest",e[e.GetBalanceResponse=100069]="GetBalanceResponse",e[e.GetBorderGameRequest=100070]="GetBorderGameRequest",e[e.GetBorderGameResponse=100071]="GetBorderGameResponse",e[e.PlayerMessageEnd=2e5]="PlayerMessageEnd",e[e.ChannelListRequest=200001]="ChannelListRequest",e[e.ChannelListResponse=200002]="ChannelListResponse",e[e.ChannelJoinRequest=200003]="ChannelJoinRequest",e[e.ChannelJoinResponse=200004]="ChannelJoinResponse",e[e.ChannelContentRequest=200005]="ChannelContentRequest",e[e.ChannelContentResponse=200006]="ChannelContentResponse",e[e.ChannelTalkRequest=200007]="ChannelTalkRequest",e[e.ChannelTalkResponse=200008]="ChannelTalkResponse",e[e.ChannelPlayerListRequest=200009]="ChannelPlayerListRequest",e[e.ChannelPlayerListResponse=200010]="ChannelPlayerListResponse",e[e.PrivateChannelListRequest=200011]="PrivateChannelListRequest",e[e.PrivateChannelListResponse=200012]="PrivateChannelListResponse",e[e.PrivateChannelContentRequest=200013]="PrivateChannelContentRequest",e[e.PrivateChannelContentResponse=200014]="PrivateChannelContentResponse",e[e.PrivateChannelTalkRequest=200015]="PrivateChannelTalkRequest",e[e.PrivateChannelTalkResponse=200016]="PrivateChannelTalkResponse",e[e.GameroomListRequest=200017]="GameroomListRequest",e[e.GameroomListResponse=200018]="GameroomListResponse",e[e.GetDistributionRequest=200019]="GetDistributionRequest",e[e.GetDistributionResponse=200020]="GetDistributionResponse",e[e.GameTypeOccupiedCountRequest=200021]="GameTypeOccupiedCountRequest",e[e.GameTypeOccupiedCountResponse=200022]="GameTypeOccupiedCountResponse",e[e.GetJackpotRequest=200023]="GetJackpotRequest",e[e.GetJackpotResponse=200024]="GetJackpotResponse",e[e.LadderInfoRequest=200025]="LadderInfoRequest",e[e.LadderInfoResponse=200026]="LadderInfoResponse",e[e.SendDistributionRequest=200027]="SendDistributionRequest",e[e.ClientCheckNewMessageRequest=200028]="ClientCheckNewMessageRequest",e[e.ClientCheckNewMessageResponse=200029]="ClientCheckNewMessageResponse",e[e.ClientCheckNewDistributionMessageResponse=200030]="ClientCheckNewDistributionMessageResponse",e[e.ClientCheckNewDistributionGetItemResponse=200031]="ClientCheckNewDistributionGetItemResponse",e[e.SendPlayerReportRequest=200032]="SendPlayerReportRequest",e[e.SendPlayerReportResponse=200033]="SendPlayerReportResponse",e[e.AccountBindingRequest=200034]="AccountBindingRequest",e[e.AccountBindingResponse=200035]="AccountBindingResponse",e[e.ThirdPartyFinancePurchaseUpdateResponse=200036]="ThirdPartyFinancePurchaseUpdateResponse",e[e.LoginAccountRequest_Formal=200037]="LoginAccountRequest_Formal",e[e.LoginAccountResponse_Formal=200038]="LoginAccountResponse_Formal",e[e.ServerMsgBegin=200039]="ServerMsgBegin",e[e.ServerConnected=200040]="ServerConnected",e[e.ServerDisconnected=200041]="ServerDisconnected",e[e.ClientConnected=200042]="ClientConnected",e[e.ClientDisconnected=200043]="ClientDisconnected",e[e.ServerWelcome=200044]="ServerWelcome",e[e.Account2LoadNewClientLoginRequest=200045]="Account2LoadNewClientLoginRequest",e[e.Load2AccountNewClientLoginResponse=200046]="Load2AccountNewClientLoginResponse",e[e.Load2LobbyNewClientLoginRequest=200047]="Load2LobbyNewClientLoginRequest",e[e.Lobby2LoadNewClientLoginResponse=200048]="Lobby2LoadNewClientLoginResponse",e[e.Load2LobbyKickPlayerRequest=200049]="Load2LobbyKickPlayerRequest",e[e.Lobby2LoadKickPlayerResponse=200050]="Lobby2LoadKickPlayerResponse",e[e.Lobby2LoadPlayerEnteredRequest=200051]="Lobby2LoadPlayerEnteredRequest",e[e.Load2LobbyPlayerEnteredResponse=200052]="Load2LobbyPlayerEnteredResponse",e[e.Lobby2LoadPlayerJoinGame=200053]="Lobby2LoadPlayerJoinGame",e[e.Lobby2LoadPlayerLeaveGame=200054]="Lobby2LoadPlayerLeaveGame",e[e.Load2AccountPlayerEnteredRequest=200055]="Load2AccountPlayerEnteredRequest",e[e.Account2LoadPlayerEnteredResponse=200056]="Account2LoadPlayerEnteredResponse",e[e.Lobby2GameJoinGameRequest=200057]="Lobby2GameJoinGameRequest",e[e.Game2LobbyJoinGameResponse=200058]="Game2LobbyJoinGameResponse",e[e.Lobby2GameLeaveGameRequest=200059]="Lobby2GameLeaveGameRequest",e[e.Game2LobbyLeaveGameResponse=200060]="Game2LobbyLeaveGameResponse",e[e.Lobby2GameClearReserveRoomRequest=200061]="Lobby2GameClearReserveRoomRequest",e[e.Lobby2GameGameroomListRequest=200062]="Lobby2GameGameroomListRequest",e[e.Game2LobbyGameroomListResponse=200063]="Game2LobbyGameroomListResponse",e[e.Lobby2ChatChannelListRequest=200064]="Lobby2ChatChannelListRequest",e[e.Chat2LobbyChannelListResponse=200065]="Chat2LobbyChannelListResponse",e[e.Game2LobbyJackpotChanged=200066]="Game2LobbyJackpotChanged",e[e.Game2LobbyGameroomStatusChanged=200067]="Game2LobbyGameroomStatusChanged",e[e.Lobby2GamePlayGameRequest=200068]="Lobby2GamePlayGameRequest",e[e.Game2LobbyPlayGameResponse=200069]="Game2LobbyPlayGameResponse",e[e.Game2LobbySyncGameResponse=200070]="Game2LobbySyncGameResponse",e[e.Chat2LobbyClientJoinRequest=200071]="Chat2LobbyClientJoinRequest",e[e.Lobby2ChatClientJoinResponse=200072]="Lobby2ChatClientJoinResponse",e[e.Game2LobbyMultiPlayerResultSave=200073]="Game2LobbyMultiPlayerResultSave",e[e.Chat2LobbyGameLogRequest=200074]="Chat2LobbyGameLogRequest",e[e.Lobby2_ChatGameLogResponse=200075]="Lobby2_ChatGameLogResponse",e[e.Lobby2ChatPlayerLeaveChannel=200076]="Lobby2ChatPlayerLeaveChannel",e[e.Chat2LobbyClientGotNewMessage=200077]="Chat2LobbyClientGotNewMessage",e[e.Lobby2ChatClientGotNewMessage=200078]="Lobby2ChatClientGotNewMessage",e[e.Lobby2ChatChangeNicknameRequest=200079]="Lobby2ChatChangeNicknameRequest",e[e.Chat2LobbyChangeNicknameResponse=200080]="Chat2LobbyChangeNicknameResponse",e[e.RpcToLobbyBySessionId=200081]="RpcToLobbyBySessionId",e[e.RpcToLobbyByAccountId=200082]="RpcToLobbyByAccountId",e[e.Lobby2FinanceUseMoneyItemRequest=200083]="Lobby2FinanceUseMoneyItemRequest",e[e.Finance2LobbyUseMoneyItemResponse=200084]="Finance2LobbyUseMoneyItemResponse",e[e.Lobby2FinanceUseFullPlateItemRequest=200085]="Lobby2FinanceUseFullPlateItemRequest",e[e.Finance2LobbyUseFullPlateItemResponse=200086]="Finance2LobbyUseFullPlateItemResponse",e[e.Lobby2FinanceGameResultChangeMoneyRequest=200087]="Lobby2FinanceGameResultChangeMoneyRequest",e[e.Finance2LobbyGameResultChangeMoneyResponse=200088]="Finance2LobbyGameResultChangeMoneyResponse",e[e.Lobby2FinanceLeaveGamePaneltyRequest=200089]="Lobby2FinanceLeaveGamePaneltyRequest",e[e.Finance2LobbyLeaveGamePaneltyResponse=200090]="Finance2LobbyLeaveGamePaneltyResponse",e[e.Lobby2FinanceMultiPlayerGameMoneyAlteredRequest=200091]="Lobby2FinanceMultiPlayerGameMoneyAlteredRequest",e[e.Finance2LobbyMultiPlayerGameMoneyAlteredResponse=200092]="Finance2LobbyMultiPlayerGameMoneyAlteredResponse",e[e.Lobby2FinanceQueryMoneyRequest=200093]="Lobby2FinanceQueryMoneyRequest",e[e.Finance2LobbyQueryMoneyResponse=200094]="Finance2LobbyQueryMoneyResponse",e[e.Lobby2FinanceCreateTradeRequest=200095]="Lobby2FinanceCreateTradeRequest",e[e.Finance2LobbyCreateTradeResponse=200096]="Finance2LobbyCreateTradeResponse",e[e.Lobby2FinanceReplyTradeTransactionRequest=200097]="Lobby2FinanceReplyTradeTransactionRequest",e[e.Finance2LobbyReplyTradeTransactionResponse=200098]="Finance2LobbyReplyTradeTransactionResponse",e[e.Lobby2FinanceRetrieveTransactionRequest=200099]="Lobby2FinanceRetrieveTransactionRequest",e[e.Finance2LobbyRetrieveTransactionResponse=200100]="Finance2LobbyRetrieveTransactionResponse",e[e.Lobby2FinanceRetrievePlayerInfoRequest=200101]="Lobby2FinanceRetrievePlayerInfoRequest",e[e.Finance2LobbyRetrievePlayerInfoResponse=200102]="Finance2LobbyRetrievePlayerInfoResponse",e[e.Lobby2AccountRetrievePlayerInfoRequest=200103]="Lobby2AccountRetrievePlayerInfoRequest",e[e.Account2LobbyRetrievePlayerInfoResponse=200104]="Account2LobbyRetrievePlayerInfoResponse",e[e.Lobby2FinanceExpiredTraderRequest=200105]="Lobby2FinanceExpiredTraderRequest",e[e.Finance2LobbyExpiredTraderResponse=200106]="Finance2LobbyExpiredTraderResponse",e[e.Finance2LobbyNotifyJackpotPrize=200107]="Finance2LobbyNotifyJackpotPrize",e[e.Load2LobbyGmAddNoticeBoard=200108]="Load2LobbyGmAddNoticeBoard",e[e.Load2LobbyGmAddMarquee=200109]="Load2LobbyGmAddMarquee",e[e.Lobby2LoadNewMarqueeRequest=200110]="Lobby2LoadNewMarqueeRequest",e[e.Load2LobbyNewMarqueeResponse=200111]="Load2LobbyNewMarqueeResponse",e[e.Lobby2FinanceScratchCardResultRequest=200112]="Lobby2FinanceScratchCardResultRequest",e[e.LotteryAutoNewRequest=200113]="LotteryAutoNewRequest",e[e.Lobby2LotteryFreeTicketsRequest=200114]="Lobby2LotteryFreeTicketsRequest",e[e.Lottery2LobbyFreeTicketsResponse=200115]="Lottery2LobbyFreeTicketsResponse",e[e.Finance2LotteryRewardTicketsRequest=200116]="Finance2LotteryRewardTicketsRequest",e[e.Lottery2FinanceRewardTicketsResponse=200117]="Lottery2FinanceRewardTicketsResponse",e[e.Finance2LotteryMultiPlayerRewardTicketsRequest=200118]="Finance2LotteryMultiPlayerRewardTicketsRequest",e[e.Lottery2FinanceMultiPlayerRewardTicketsResponse=200119]="Lottery2FinanceMultiPlayerRewardTicketsResponse",e[e.Lobby2LotteryGetLotteryInfoRequest=200120]="Lobby2LotteryGetLotteryInfoRequest",e[e.Lottery2LobbyGetLotteryInfoResponse=200121]="Lottery2LobbyGetLotteryInfoResponse",e[e.Lobby2LotteryExchangeRewardRequest=200122]="Lobby2LotteryExchangeRewardRequest",e[e.Lottery2LobbyExchangeRewardResponse=200123]="Lottery2LobbyExchangeRewardResponse",e[e.Lobby2LotteryHistoryLotteryInfoRequest=200124]="Lobby2LotteryHistoryLotteryInfoRequest",e[e.Lottery2LobbyHistoryLotteryInfoResponse=200125]="Lottery2LobbyHistoryLotteryInfoResponse",e[e.Lobby2FinanceLotteryExchangeRequest=200126]="Lobby2FinanceLotteryExchangeRequest",e[e.Lobby2LotteryQueryTicketAmountRequest=200127]="Lobby2LotteryQueryTicketAmountRequest",e[e.Lottery2LobbyQueryTicketAmountResponse=200128]="Lottery2LobbyQueryTicketAmountResponse",e[e.Lobby2FinancePurchaseRequest=200129]="Lobby2FinancePurchaseRequest",e[e.Finance2LobbyPurchaseResponse=200130]="Finance2LobbyPurchaseResponse",e[e.Lobby2LotteryQueryLotteryMoneyRequest=200131]="Lobby2LotteryQueryLotteryMoneyRequest",e[e.Lottery2LobbyQueryLotteryMoneyResponse=200132]="Lottery2LobbyQueryLotteryMoneyResponse",e[e.Lobby2LotteryAddLotteryMoneyRequest=200133]="Lobby2LotteryAddLotteryMoneyRequest",e[e.Lottery2LobbyVipRequest=200134]="Lottery2LobbyVipRequest",e[e.Lobby2LotterVipResponse=200135]="Lobby2LotterVipResponse",e[e.SB2GameBankerListInfomation=200136]="SB2GameBankerListInfomation",e[e.Game2SBGameResultVerifyRequest=200137]="Game2SBGameResultVerifyRequest",e[e.SB2GameGameResultVerifyResponse=200138]="SB2GameGameResultVerifyResponse",e[e.SB2FinanceJackpotRequest=200139]="SB2FinanceJackpotRequest",e[e.Finance2SBJackpotResponse=200140]="Finance2SBJackpotResponse",e[e.Game2SBLeaveGamePenaltyNotice=200141]="Game2SBLeaveGamePenaltyNotice",e[e.Lobby2LoadPlayerLeave=200142]="Lobby2LoadPlayerLeave",e[e.Lobby2AccountBindingAccountRequest=200143]="Lobby2AccountBindingAccountRequest",e[e.Account2LobbyAccountBindingResponse=200144]="Account2LobbyAccountBindingResponse",e[e.Load2FinanceGmReloadJackpot=200145]="Load2FinanceGmReloadJackpot",e[e.GmSendDistribution=200146]="GmSendDistribution",e[e.Lobby2Distribution_CheckNewDistributionMessageRequest=200147]="Lobby2Distribution_CheckNewDistributionMessageRequest",e[e.Distribution2Lobby_CheckNewDistributionMessageResponse=200148]="Distribution2Lobby_CheckNewDistributionMessageResponse",e[e.Distribution2Lobby_CheckNewDistributionGetItemResponse=200149]="Distribution2Lobby_CheckNewDistributionGetItemResponse",e[e.Distribution2Lobby_SendDistributionItemRequest=200150]="Distribution2Lobby_SendDistributionItemRequest",e[e.Lobby2Distribution_SendDistributionItemResponse=200151]="Lobby2Distribution_SendDistributionItemResponse",e[e.Lobby2Finance_DistributionMoneyRequest=200152]="Lobby2Finance_DistributionMoneyRequest",e[e.Load2LobbyGmRefreshScratchCard=200153]="Load2LobbyGmRefreshScratchCard",e[e.Load2ProductSystemGmReloadProduct=200154]="Load2ProductSystemGmReloadProduct",e[e.Load2LobbyGmReloadVersionControl=200155]="Load2LobbyGmReloadVersionControl",e[e.Load2LobbyGmFreezePlayer=200156]="Load2LobbyGmFreezePlayer",e[e.Load2LobbyGmBanPlayerChat=200157]="Load2LobbyGmBanPlayerChat",e[e.Load2BankGmReloadBankDeposit=200158]="Load2BankGmReloadBankDeposit",e[e.Load2BankGmReloadGameLogic=200159]="Load2BankGmReloadGameLogic",e[e.Load2GameGameLogicHotFixNotice=200160]="Load2GameGameLogicHotFixNotice",e[e.Load2FinanceGmReloadJack=200161]="Load2FinanceGmReloadJack",e[e.Load2ThirdPartyGmReloadChannel=200162]="Load2ThirdPartyGmReloadChannel",e[e.Load2LobbyGmReloadChannel=200163]="Load2LobbyGmReloadChannel",e[e.ThirdParty2FinancePurchaseRequest=200164]="ThirdParty2FinancePurchaseRequest",e[e.Finance2ThirdPartyPurchaseResponse=200165]="Finance2ThirdPartyPurchaseResponse",e[e.ThirdPartyFinance2LobbyPurchaseUpdateRequest=200166]="ThirdPartyFinance2LobbyPurchaseUpdateRequest",e[e.ThirdParty2LoadBalanceOnlineRequest=200167]="ThirdParty2LoadBalanceOnlineRequest",e[e.LoadBalance2ThirdPartyOnlineResponse=200168]="LoadBalance2ThirdPartyOnlineResponse",e[e.ThirdParty2FinancePurchaseCashRequest=200169]="ThirdParty2FinancePurchaseCashRequest",e[e.Finance2ThirdPartyPurchaseCashResponse=200170]="Finance2ThirdPartyPurchaseCashResponse",e[e.ThirdParty2LoadBalanceFreezePlayerRequest=200171]="ThirdParty2LoadBalanceFreezePlayerRequest",e[e.LoadBalance2ThirdPartyFreezePlayerResponse=200172]="LoadBalance2ThirdPartyFreezePlayerResponse",e[e.ThirdParty2LoadBalanceLoginStatusRequest=200173]="ThirdParty2LoadBalanceLoginStatusRequest",e[e.LoadBalance2ThirdPartyLoginStatusResponse=200174]="LoadBalance2ThirdPartyLoginStatusResponse",e[e.Account2ThirdPartyLoginRequest=200175]="Account2ThirdPartyLoginRequest",e[e.ThirdParty2AccountLoginResponse=200176]="ThirdParty2AccountLoginResponse",e[e.Lobby2FinanceSingleGameRefundRequest=200177]="Lobby2FinanceSingleGameRefundRequest",e[e.Finance2SBSingleGameRefundRequest=200178]="Finance2SBSingleGameRefundRequest"
}(PhotonProtocol||(PhotonProtocol={}));var PhotonErrorCode;!function(e){e[e.Success=0]="Success",e[e.AccountFreezed=1]="AccountFreezed",e[e.AccountUnableRetrieveData=2]="AccountUnableRetrieveData",e[e.PlayerUnableRetrieveData=3]="PlayerUnableRetrieveData",e[e.ItemUnableRetrieveData=4]="ItemUnableRetrieveData",e[e.KickByDuplicatedLogin=5]="KickByDuplicatedLogin",e[e.PlayerChangeNameFailed=6]="PlayerChangeNameFailed",e[e.ExceedMaximumConnections=7]="ExceedMaximumConnections",e[e.ProductUnableRetrieveData=8]="ProductUnableRetrieveData",e[e.ChannelUnableRetrieveData=9]="ChannelUnableRetrieveData",e[e.DepositSystemError=10]="DepositSystemError",e[e.GameRoundError=11]="GameRoundError",e[e.GameRoundMapError=12]="GameRoundMapError",e[e.AccountWalletError=13]="AccountWalletError",e[e.AccountSyncTransferDataError=14]="AccountSyncTransferDataError",e[e.RedundantTransactionId=1e3]="RedundantTransactionId",e[e.NonExistProductId=1001]="NonExistProductId",e[e.InvalidFinancialProtocol=1002]="InvalidFinancialProtocol",e[e.FunFun17LackParams=1003]="FunFun17LackParams",e[e.FunFun17VerifyError=1004]="FunFun17VerifyError",e[e.InConsistentPurchase=1005]="InConsistentPurchase",e[e.NotSupportPayPal=1006]="NotSupportPayPal",e[e.RoomFull=2e3]="RoomFull",e[e.RoomJoinFailed=2001]="RoomJoinFailed",e[e.RoomLeaveFailed=2002]="RoomLeaveFailed",e[e.RoomInvalidGameType=2003]="RoomInvalidGameType",e[e.RoomInvalidRoomId1=2004]="RoomInvalidRoomId1",e[e.RoomInvalidRoomId2=2005]="RoomInvalidRoomId2",e[e.RoomInvalidRoomId3=2006]="RoomInvalidRoomId3",e[e.RoomInvalidRoomId4=2007]="RoomInvalidRoomId4",e[e.RoomAlreadyInGame=2008]="RoomAlreadyInGame",e[e.RoomProceedingTransaction=2009]="RoomProceedingTransaction",e[e.RoomPlayerNotIn=2010]="RoomPlayerNotIn",e[e.ChannelFull=3e3]="ChannelFull",e[e.ChannelInvalidChannelId=3001]="ChannelInvalidChannelId",e[e.ChannelAlreadyInChannel=3002]="ChannelAlreadyInChannel",e[e.ChannelPlayerNotFound=3003]="ChannelPlayerNotFound",e[e.ChannelPlayerIncorrect=3004]="ChannelPlayerIncorrect",e[e.ChannelAddTalkError=3005]="ChannelAddTalkError",e[e.PrivateChannelUnalbleAchieve=3006]="PrivateChannelUnalbleAchieve",e[e.TradeInvalidInput=4e3]="TradeInvalidInput",e[e.TradePlayerNotFound=4001]="TradePlayerNotFound",e[e.TradeFailed=4002]="TradeFailed",e[e.TradePassSetError=4003]="TradePassSetError",e[e.TradePassAlreadySet=4004]="TradePassAlreadySet",e[e.TradePassInvalidForm=4005]="TradePassInvalidForm",e[e.TradePassAbsent=4006]="TradePassAbsent",e[e.TradePassIncorrect=4007]="TradePassIncorrect",e[e.TradeLessThanRequired=4008]="TradeLessThanRequired",e[e.TradeExceedGiftLimit=4009]="TradeExceedGiftLimit",e[e.TradeSelf=4010]="TradeSelf",e[e.TradeLocked=4011]="TradeLocked",e[e.TradeReceiverVipLevelTooLow=4012]="TradeReceiverVipLevelTooLow",e[e.TradeExpiredFailed=4013]="TradeExpiredFailed",e[e.GameProceedTooFast=5e3]="GameProceedTooFast",e[e.GameInvalidOperation=5001]="GameInvalidOperation",e[e.GameServerUnsufficentMoney=5002]="GameServerUnsufficentMoney",e[e.GamePlayerNotJoin=5003]="GamePlayerNotJoin",e[e.GameResultNonExist=5004]="GameResultNonExist",e[e.GameBetingNotAllowed=5005]="GameBetingNotAllowed",e[e.GameBetingNotInRange=5006]="GameBetingNotInRange",e[e.GameBetingVipIncosist=5007]="GameBetingVipIncosist",e[e.GameBetingJackpotNotAllowed=5008]="GameBetingJackpotNotAllowed",e[e.GamePlayerTransactionStillProceed=5009]="GamePlayerTransactionStillProceed",e[e.GameBetingFloat=5010]="GameBetingFloat",e[e.GameBetingNull=5011]="GameBetingNull",e[e.GamePlayerStillSyncBalance=5012]="GamePlayerStillSyncBalance",e[e.GamePlayerInSpin=5013]="GamePlayerInSpin",e[e.GamePlayerInTransaction=5014]="GamePlayerInTransaction",e[e.GameUnsufficentMoney=5015]="GameUnsufficentMoney",e[e.ItemMissing=6e3]="ItemMissing",e[e.ItemInvalidOperation=6001]="ItemInvalidOperation",e[e.ItemLacking=6002]="ItemLacking",e[e.ScratchCardNone=6003]="ScratchCardNone",e[e.ScratchCardInfoMiss=6004]="ScratchCardInfoMiss",e[e.UseScratchInvalidId=6005]="UseScratchInvalidId",e[e.UseScratchMoneyNotEnough=6006]="UseScratchMoneyNotEnough",e[e.UseScratchOutofDate=6007]="UseScratchOutofDate",e[e.UseScratchOutofFreeTime=6008]="UseScratchOutofFreeTime",e[e.UseScratchFreeTimeNoCount=6009]="UseScratchFreeTimeNoCount",e[e.LotteryInfoMiss=6010]="LotteryInfoMiss",e[e.LotteryHistoryMiss=6011]="LotteryHistoryMiss",e[e.LotteryExchangeMiss=6012]="LotteryExchangeMiss",e[e.SendPlayerReportTimeLock=6013]="SendPlayerReportTimeLock",e[e.RepeatThirdPartyAccount=6014]="RepeatThirdPartyAccount",e[e.ErrorAccountOrErrorPassword=6015]="ErrorAccountOrErrorPassword",e[e.AlreadyExists=6016]="AlreadyExists",e[e.AlreadyBinding=6017]="AlreadyBinding",e[e.CouponInvalid=6018]="CouponInvalid",e[e.UpdateTransactionStatusError=8e3]="UpdateTransactionStatusError",e[e.WalletTransactionFailed=8001]="WalletTransactionFailed",e[e.WalletTransactionPending=8002]="WalletTransactionPending",e[e.WalletBetBeRefund=8003]="WalletBetBeRefund",e[e.UnableRetrievePurchaseInfo=8004]="UnableRetrievePurchaseInfo",e[e.UnableReCheckPurchaseInfo=8005]="UnableReCheckPurchaseInfo",e[e.TransactionRefundError=8006]="TransactionRefundError",e[e.SecretLoginError=8007]="SecretLoginError",e[e.DbWriteError=8008]="DbWriteError"}(PhotonErrorCode||(PhotonErrorCode={}));var LanguageManager=function(){function e(){}return e.SetupLanguage=function(e){if(IsNullOrUndefined(e))Debug.LogError("ConfigText = null");else for(var t=e.split(this.LineSeparator),n=0,o=t.length;o>n;n++)for(var i=t[n].split(this.ColumnSeparator),a=i[0],r=1,s=i.length;s>r;r++){var l=r-1,u=i[r];if(this.LanguageDic.ContainsKey(l)||this.LanguageDic.Add(l,new Dictionary([])),!StringIsNullOrEmpty(a)&&!StringIsNullOrEmpty(u)){var c=this.LanguageDic[l];c.Update(a,u)&&Debug.LogWarning(LanguageType[l]+" Dic裡面有重複的key值 : "+a)}}this.IsSetupComplete=!0},e.ChangeLanguage=function(e){this.CurrentLanguage=e,SendTool.SendData("OnChangeLanguage",this.CurrentLanguage)},e.GetKey=function(e){if(StringIsNullOrEmpty(e))return"";var t=this.CurrentLanguage;if(this.LanguageDic.ContainsKey(t)){for(var n=this.LanguageDic[t],o=e;o.indexOf(this.LineSeparator)>=0;)o=o.replace(this.LineSeparator,this.NewLineChar);if(n.ContainsValue(o))return n.GetKeyByValue(o)}return Debug.LogError("LanguageManager.GetText失敗，找不到對應文字Key： LanguageType = "+LanguageType[t]+" | text = "+e),""},e.GetText=function(e,t,n,o){return void 0===t&&(t=""),void 0===n&&(n=""),void 0===o&&(o=!0),this.GetLanguageText(this.CurrentLanguage,e,t,n,o)},e.GetLanguageText=function(t,n,o,i,a){if(void 0===o&&(o=""),void 0===i&&(i=""),void 0===a&&(a=!0),StringIsNullOrEmpty(n))return"";if(e.LanguageDic.ContainsKey(t)){var r=e.LanguageDic[t];if(r.ContainsKey(n)){var s=r[n];for(StringIsNullOrEmpty(o)||(s=s.replace("@",o)),StringIsNullOrEmpty(i)||(s=s.replace("#",i));s.indexOf(e.NewLineChar)>=0;)s=s.replace(e.NewLineChar,e.LineSeparator);return s}}return a&&Debug.LogError("LanguageManager.GetText失敗，找不到對應文字： LanguageType = "+LanguageType[t]+" | key = "+n),""},e.IsSetupComplete=!1,e.NewLineChar="↓",e.LineSeparator="\n",e.ColumnSeparator="	",e.LanguageDic=new Dictionary([]),e.CurrentLanguage=LanguageType.CN,e}();__reflect(LanguageManager.prototype,"LanguageManager");var LerpValues=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.ToValue=-1,this.Callback=null,this.DoneCallback=null,this.ToValue=e,this.Callback=t,this.DoneCallback=n}return e.prototype.Clear=function(){this.Callback=null,this.DoneCallback=null},e}();__reflect(LerpValues.prototype,"LerpValues");var LerpMethod=function(){function e(){}return e.LerpValue=function(e,t,n,o,i,a,r,s){var l=this;void 0===o&&(o=CurveMethod.EaseInOut),void 0===i&&(i=null),void 0===a&&(a=null),void 0===r&&(r=""),void 0===s&&(s=!0),""!==r&&this.Stop(r);var u="";if(null!=i){var c=CurveValue.GetValue(o),h=t,p=0,d=0,g=0,y=0,f=function(o){p=c.length*o/e,d=Math.floor(p),d=d>c.length-1?c.length-1:d,g=d+1>=c.length-1?c.length-1:d+1,y=c[d]+(c[g]-c[d])*(p-d),h=l.FixNumber(t+(n-t)*y),i(h)};u=s?Time.CountTimeFixUpdate(e,f,function(){l.Stop(u,!0,!0)}):Time.CountTime(e,f,function(){l.Stop(u,!0,!0)}),this.LerpingDic.ContainsKey(u)?Debug.LogError("LerpingDic contains same Key : "+u):this.LerpingDic.Add(u,new LerpValues(n,i,a))}return u},e.Stop=function(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=!1),Time.Stop(e),this.LerpingDic.ContainsKey(e)){var o=this.LerpingDic[e];null!=o&&(t&&null!=o.Callback&&o.Callback(o.ToValue),n&&null!=o.DoneCallback&&o.DoneCallback(),o.Clear()),o=null,this.LerpingDic.Remove(e)}},e.StopAllLerpValues=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1);for(var n=this.LerpingDic.Keys,o=0,i=n.length;i>o;o++)this.Stop(n[o],e,t)},e.FixNumber=function(e){var t,n=0;try{n=e.toString().split(".")[1].length}catch(o){}return t=Number(e.toString().replace(".","")),t*Math.pow(10,-n)},e.LerpingDic=new Dictionary([]),e}();__reflect(LerpMethod.prototype,"LerpMethod");var CompareType;!function(e){e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater"}(CompareType||(CompareType={}));var Method=function(){function e(){}return e.GetLastStringAsIndex=function(e,t){if(void 0===t&&(t="_"),StringIsNullOrEmpty(e))return 0/0;var n=e.split(t);return this.ParseValueToInt(n[n.length-1],0/0)},e.LoopRange=function(e,t,n){if(isNaN(e))return 0/0;var o=e,i=n-t+1;if(o>n)o=(o-t)%i+t;else if(t>o){var a=(t-o)%i;o=0==a?t:i-a+t}return o},e.GetLastCharString=function(e,t){if(void 0===t&&(t=""),StringIsNullOrEmpty(t))return e.length>=1?e.charAt(e.length-1):e;var n=e.split(t);return 0!=n.length?n[n.length-1]:""},e.RemoveLastCharString=function(e,t){return e.substring(0,e.lastIndexOf(t))},e.GetPassProbability=function(e){return this.RandomRange(0,100.01)<=e?!0:!1},e.GetProbabilityIndex=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!IsNullOrUndefined(e)){for(var n=0,o=e.length,i=0;o>i;i++)n+=e[i];var a=this.RandomRange(0,n);n=0;for(var r=0;o>r;r++)if(n+=e[r],n>=a)return r;return Debug.LogErrorWithFlag("result",a,"sum",n),o-1}return-1},e.GetBetweenNumberIndex=function(e,t){if(!IsNullOrUndefined(t))for(var n=0,o=t.length;o>n;n++)if(t[n]>e)return n-1;return-1},e.RandomIntRange=function(e,t,n){return void 0===n&&(n=!0),e==t?e:e>t?Math.floor(Math.random()*(e-t+(n?1:0)))+t:Math.floor(Math.random()*(t-e+(n?1:0)))+e},e.RandomLimitIntRange=function(e,t,n,o){if(void 0===n&&(n=[]),void 0===o&&(o=!0),IsNullOrUndefined(n)||n===[])return this.RandomIntRange(e,t,o);var i=0,a=1e5,r=n.length,s=!1;do{s=!0,a--,i=this.RandomIntRange(e,t,o);for(var l=0;r>l;l++)if(i==n[l]){s=!1;break}if(0>=a){Debug.LogError("RandomLimitIntRange Error : 迴圈亂數超過10萬次");break}}while(!s);return i},e.RandomRange=function(e,t){return e==t?e:e>t?Math.random()*(e-t)+t:Math.random()*(t-e)+e},e.GetLogValueFormat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="",o=e.length;o%2!=0&&o--;for(var i=0;o>i;i++)n+=i%2==0?"["+(null==e[i]?"NULL_KEY":e[i])+" = ":(null==e[i]?"NULL_VALUE":e[i])+"]";return n},e.GetLogNewLineValueFormat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="",o=e.length;o%2!=0&&o--;for(var i=0;o>i;i++)n+=i%2==0?"\n["+(null==e[i]?"NULL_KEY":e[i])+" = ":(null==e[i]?"NULL_VALUE":e[i])+"]";return n},e.ParseValueToBoolean=function(t,n){void 0===n&&(n=null);try{var o=e.ParseValueToString(t,n).toLowerCase(),i=!1;switch(o){case"0":case"false":i=!1;break;case"1":case"true":i=!0;break;default:if(IsNullOrUndefined(n))return void Debug.LogError("轉換value「"+t+"」To Boolean參數失敗，可以設定預設參數，否則回傳undefined");switch(o=e.ParseValueToString(n).toLowerCase()){case"0":case"false":i=!1;break;case"1":case"true":i=!0;break;default:return void Debug.LogError("轉換defaultValue「"+o+"」To Boolean參數失敗，回傳undefined")}}return i}catch(a){return void Debug.LogError("轉換value「"+t+"」To Boolean參數失敗，回傳undefined")}},e.ParseValueToFloat=function(e,t){return void 0===t&&(t=null),this.ParseValueToNumber(e,t)},e.ParseValueToNumber=function(e,t){void 0===t&&(t=null);try{var n=this.ParseValueToString(e,t),o=Number(StringIsNullOrEmpty(n)?t:e);return o}catch(i){if(IsNullOrUndefined(t))return void Debug.LogError("轉換value「"+e+"」To Number參數失敗，可以設定預設參數，否則回傳undefined");if(isNaN(t))return 0/0;try{var o=Number(t);return o}catch(i){return void Debug.LogError("轉換defaultValue「"+t+"」To Number參數失敗，回傳undefined")}}},e.ParseValueToInt=function(e,t){void 0===t&&(t=null);var n=this.ParseValueToNumber(e,t);if(!IsNullOrUndefined(n))try{var o=parseInt(n.toString());return o}catch(i){if(IsNullOrUndefined(t))return void Debug.LogError("轉換number「"+n+"」To Integer參數失敗")}},e.ParseValueToString=function(e,t){void 0===t&&(t=null);try{var n=e.toString();return n}catch(o){if(IsNullOrUndefined(t))return Debug.LogError("轉換value「"+e+"」To String參數失敗，可以設定預設參數，否則回傳空字串"),"";try{var n=t.toString();return n}catch(o){return Debug.LogError("轉換defaultValue「"+t+"」To Boolean參數失敗，回傳空字串"),""}}},e.ParseDicValueToArray=function(e){var t=[];if(null!=e)for(var n=Object.keys(e),o=0,i=n.length;i>o;o++)t.push(e[n[o]]);return t},e.ParseDicValueToNumberArray=function(e){var t=[];if(null!=e)for(var n=Object.keys(e),o=0,i=n.length;i>o;o++)t.push(this.ParseValueToNumber(e[n[o]],0/0));return t},e.ParseValueToArray=function(t,n){void 0===n&&(n=null);try{if(Array.isArray(t))return t;if("string"==typeof t){var o=JSON.parse(t);return o}var o=JSON.parse(JSON.stringify(t));return o}catch(i){var a=e.ParseValueToString(t,n);if(!StringIsNullOrEmpty(a)){a=this.FixStringStartCharAndEndChar(a,"[","]");try{var o=JSON.parse(a);return o}catch(i){}}if(IsNullOrUndefined(n))return Debug.LogError("轉換value「"+t+"」To Array參數失敗，可以設定預設參數，否則回傳空Array"),[];try{if(Array.isArray(n))return n;var o=JSON.parse(n);return o}catch(i){var r=e.ParseValueToString(n);if(!StringIsNullOrEmpty(r)){r=this.FixStringStartCharAndEndChar(r,"[","]");try{var o=JSON.parse(r);return o}catch(i){}}return Debug.LogError("轉換defaultValue「"+n+"」To Array參數失敗，回傳空Array"),[]}}},e.ParseValueToAny=function(e,t){void 0===t&&(t=null);try{var n=JSON.parse(e);if(IsNullOrUndefined(n)){if(IsNullOrUndefined(t))return null;n=JSON.parse(t)}return n}catch(o){return null}},e.ParseValueToEnumString=function(e,t){if(null!==e[t]&&void 0!==e[t]){var n=parseInt(t);return isNaN(n)?t.toString():e[n]}},e.ParseValueToEnum=function(e,t){if(null!==e[t]&&void 0!==e[t]){var n=parseInt(t);return isNaN(n)?e[t]:n}},e.FixStringStartCharAndEndChar=function(e,t,n){var o="";if(!StringIsNullOrEmpty(e)){var i=e.indexOf(t),a=e.indexOf(n);0===i?a!==e.length-1&&(o=e+n):a===e.length-1?0!==i&&(o=t+e):o=t+e+n}return o},e.EnumToString=function(e,t){return isNaN(t)?t.toString():e[t]},e.GetEnumIndex=function(e,t){if(!isNaN(t))return t;var n=-1,o=0,i=this.EnumToString(e,t);for(var a in e)if(isNaN(Number(a))){if(a===i){n=o;break}o++}return n},e.GetEnumMaxIndex=function(e){var t=-1,n=0;for(var o in e)n=parseInt(o),isNaN(n)||n>t&&(t=n);return t},e.GetEnumCount=function(e){var t=0;for(var n in e)isNaN(parseInt(n))||t++;return t},e.StringToEnum=function(e,t){if("object"==typeof e)for(var n in e)if(isNaN(parseInt(n))&&e.hasOwnProperty(n)&&(e[n].toString()===t||n.toString()===t))return e[n]},e.GetFixIntNumberWithZeroString=function(e,t){if(e>t)return e.toString();for(var n="",o=0,i=t.toString().length-e.toString().length;i>o;o++)n+="0";return n+e.toString()},e.EachArrayItemSetValue=function(e,t){if(null!=e)try{for(var n=0,o=e.length;o>n;n++)e[n]=t}catch(i){Debug.LogError("eachArrayItemSetValue 失敗 : "+i)}return e},e.EachArrayItemAddValue=function(e,t){if(null!=e)for(var n=0,o=e.length;o>n;n++)e[n]=MathAdd(e[n],t);return e},e.BigNumEachArrayItemAddValue=function(e,t){if(null!=e)for(var n=0,o=e.length;o>n;n++)e[n]=BigNumAdd(e[n],t);return e},e.EachArrayItemMultiplyValue=function(e,t){if(null!=e)for(var n=0,o=e.length;o>n;n++)e[n]=MathMul(e[n],t);return e},e.BigNumEachArrayItemMultiplyValue=function(e,t){if(null!=e)for(var n=0,o=e.length;o>n;n++)e[n]=BigNumMul(e[n],t);return e},e.ArrayRemoveFirstItem=function(e){return null==e?e:(e.length>0&&e.splice(0,1),e)},e.ArrayRemoveLastItem=function(e){return null==e?e:(e.length>0&&e.splice(e.length-1,1),e)},e.ArrayAddItemAt=function(e,t,n){return 0>t||null==e?e:(e.length>t?e.splice(t,0,n):e.length==t?e.push(n):Debug.LogWarning("index("+t+")> array.length("+e.length+")"),e)},e.ArrayReplaceItemAt=function(e,t,n){return 0>t||null==e?e:(e.length>t?e.splice(t,1,n):Debug.LogWarning("index("+t+")> array.length("+e.length+")"),e)},e.ArrayRemoveItemAt=function(e,t){return 0>t||null==e?e:(e.length>t?e.splice(t,1):Debug.LogWarning("index("+t+")> array.length("+e.length+")"),e)},e.ArrayRemoveItem=function(e,t){return null==t||null==e?e:this.ArrayRemoveItemAt(e,e.indexOf(t))},e.GetMoneyFormat=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1);var o="\\d(?=(\\d{3})+"+(t>0?"\\.":"$")+")",i=this.ToFixedString(e,Math.max(0,~~t),n);return i.replace(new RegExp(o,"g"),"$&,")},e.ToFixedString=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1);var o=BigNumToFixed(e,t);if(!n){var i=o.split("."),a="";if(i.length>1){for(a=i[1];a.endsWith("0");){if(a.length-2<0){a="";break}a=a.substring(0,a.length-2)}o=StringIsNullOrEmpty(a)?i[0]:i[0]+"."+a}}return o},e.MultiplyValues=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=0;if(null!=t){var i=t.length;if(i>0){o=t[0];for(var a=1;i>a;a++)o=MathMul(o,t[a])}else Debug.LogWarning("<<ValuesMultiplier>> param.length = 0");o=MathToFixed(o,e)}else Debug.LogWarning("<<ValuesMultiplier>> param = null");return o},e.CombineArray=function(e,t,n){void 0===n&&(n=!1);for(var o=[],i=0,a=e.length;a>i;i++)o.push(e[i]);if(n)for(var i=0,a=t.length;a>i;i++)o.indexOf(t[i])<0&&o.push(t[i]);else for(var i=0,a=t.length;a>i;i++)o.push(t[i]);return o},e.CopyArray=function(e,t){void 0===t&&(t=!1);var n=[];if(t)for(var o=e.length-1;o>=0;o--)n.push(e[o]);else for(var o=0,i=e.length;i>o;o++)n.push(e[o]);return n},e.SortArrayAsc=function(e,t){if(void 0===t&&(t=!1),t){for(var n=this.CopyArray(e),o=n.length-1;o>0;o--)for(var i=0;o>i;i++)if(n[i]>n[i+1]){var a=n[i];n[i]=n[i+1],n[i+1]=a}return n}for(var o=e.length-1;o>0;o--)for(var i=0;o>i;i++)if(e[i]>e[i+1]){var a=e[i];e[i]=e[i+1],e[i+1]=a}return e},e.SortArrayDesc=function(e,t){if(void 0===t&&(t=!1),t){for(var n=this.CopyArray(e),o=n.length-1;o>0;o--)for(var i=0;o>i;i++)if(n[i]<n[i+1]){var a=n[i];n[i]=n[i+1],n[i+1]=a}return n}for(var o=e.length-1;o>0;o--)for(var i=0;o>i;i++)if(e[i]<e[i+1]){var a=e[i];e[i]=e[i+1],e[i+1]=a}return e},e.GetNearArrayIndex=function(e,t){var n=this.GetNearArrayValue(e,t);return e.indexOf(n)},e.GetNearArrayValue=function(e,t){var n=this.CopyArray(e);return n.sort(function(e,n){return Math.abs(e-t)-Math.abs(n-t)})[0]},e.GetNewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)})},e.LoadImage=function(e,t,n){if(void 0===n&&(n=null),e){var o=new egret.ImageLoader;o.crossOrigin="anonymous",o.once(egret.Event.COMPLETE,function(e){if(e.currentTarget.data){var n=new egret.Texture;n.bitmapData=e.currentTarget.data,t(n)}},this),o.once(egret.IOErrorEvent.IO_ERROR,function(t){Debug.LogError("下載圖片失敗 : "+e),null!=n&&n()},this),o.load(e)}else Debug.LogError("下載圖片失敗 : url = null")},e.GetMousePosition=function(e){document.addEventListener("mousemove",e)},e.CalcTwoPosAngle=function(e,t,n,o,i){void 0===i&&(i=2);var a=Math.atan(-(o-t)/(n-e))/Math.PI*180;return 0>n-e&&(a+=180),this.FixAngle(a,i)},e.CalcTwoPointDistance=function(e,t,n,o){return void 0===n&&(n=0),void 0===o&&(o=0),Math.sqrt(Math.pow(e-n,2)+Math.pow(t-o,2))},e.FixAngle=function(e,t){for(void 0===t&&(t=2);0>e;)e+=360;return e%=360,Number(e.toFixed(t))},e.Clamp=function(e,t,n){return t>e&&(e=t),e>n&&(e=n),e},e.FixNewLineString=function(e){return e.replace("\r","").replace("\n","")},e.NewType=function(e){return new e},e.NewTypeByString=function(e){return new window[e]},e}();__reflect(Method.prototype,"Method");var Pool=function(){function e(e,t,n){void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null),this.GenerateMethod=null,this.GetMethod=null,this.RecycleMethod=null,this.ActiveObjs=new Dictionary([]),this.RecycledObjs=new Dictionary([]),this.GenerateMethod=e,this.GetMethod=t,this.RecycleMethod=n}return e.prototype.GetKey=function(e){return this.AbleToHandle(e)?e.hashCode:0/0},e.prototype.GetActiveObjs=function(e){return void 0===e&&(e=""),this.ActiveObjs.ContainsKey(e)?this.ActiveObjs[e]:null},e.prototype.GetActiveObjsToArray=function(e,t){if(void 0===e&&(e=""),StringIsNullOrEmpty(e))this.GetAllActiveObjsToArray(t);else if(this.ActiveObjs.ContainsKey(e)){var n=this.ActiveObjs[e];n.GetValuesToArray(t)}},e.prototype.GetAllActiveObjsToArray=function(e){if(IsNullOrUndefined(e))Debug.LogError("<<PoolObj>> getAllActiveObjsToArray array isNullOrUndefined");else for(var t=this.ActiveObjs.Keys,n=0,o=t.length;o>n;n++){var i=this.ActiveObjs.GetValueByKey(t[n]);null!=i?i.GetValuesToArray(e):Debug.LogError("<<PoolObj>> parse Dictionary error")}},e.prototype.AbleToHandle=function(e){if(null!=e){var t=e.hashCode;return IsNullOrUndefined(t)?(Debug.LogError("<<PoolObj>> AbleToHandle 該物件沒有實做「.hashCode」欄位，沒辦法當Key值"),!1):!isNaN(t)}return Debug.LogError("<<PoolObj>> AbleToHandle obj = null"),!1},e.prototype.GetObj=function(e){void 0===e&&(e="");for(var t=null,n=this.RecycledObjs.Values,o=0,i=n.length;i>o;o++)if(null!=n[o]){t=n[o],this.RecycledObjs.Remove(this.GetKey(t));break}if(null==t&&null!=this.GenerateMethod&&(t=this.GenerateMethod()),null!=this.GetMethod)try{this.GetMethod(t)}catch(a){try{this.GetMethod()}catch(a){Debug.LogError("<<PoolObj>> GetMethod執行錯誤")}}return this.AddActiveObj(t,e),t},e.prototype.AddActiveObj=function(e,t){if(void 0===t&&(t=""),null!=e){var n=this.GetKey(e);isNaN(n)||(this.ActiveObjs.ContainsKey(t)||this.ActiveObjs.Add(t,new Dictionary([])),this.ActiveObjs[t].ContainsKey(n)?Debug.LogError(t+" Active池裡已有該物件 : "+n):this.ActiveObjs[t].Add(n,e))}},e.prototype.RecycleObj=function(e,t){if(void 0===t&&(t=""),null!=e){var n=this.GetKey(e);if(!isNaN(n)){if(StringIsNullOrEmpty(t))for(var o=this.ActiveObjs.Keys,i=0,a=o.length;a>i;i++){var r=this.ActiveObjs.GetValueByKey(o[i]);if(r.ContainsKey(n)&&r.GetValueByKey(n)===e){r.Remove(n);break}}else if(this.ActiveObjs.ContainsKey(t)){var r=this.ActiveObjs.GetValueByKey(t);r.ContainsKey(n)&&r.GetValueByKey(n)===e&&r.Remove(n)}if(this.RecycledObjs.ContainsKey(n)?Debug.LogError("<<PoolObj>> 物件("+n+")已存在在回收池中"):this.RecycledObjs.Add(n,e),null!=this.RecycleMethod)try{this.RecycleMethod(e)}catch(s){try{this.RecycleMethod()}catch(s){Debug.LogError("<<PoolObj>> RecycleMethod執行錯誤")}}}}else Debug.LogError("<<PoolObj>> Recycle targetObj = null")},e.prototype.RecycleAllObjs=function(e){if(void 0===e&&(e=""),StringIsNullOrEmpty(e))for(var t=this.ActiveObjs.Keys,n=0,o=t.length;o>n;n++)for(var i=this.ActiveObjs.GetValueByKey(t[n]),a=i.Values,r=0,s=a.length;s>r;r++)this.RecycleObj(a[0],t[n]);else if(this.ActiveObjs.ContainsKey(e))for(var i=this.ActiveObjs.GetValueByKey(e),a=i.Values,r=0,s=a.length;s>r;r++)this.RecycleObj(a[0],e)},e.prototype.Clear=function(){this.RecycleAllObjs(),this.ActiveObjs.Clear(),this.RecycledObjs.Clear()},e}();__reflect(Pool.prototype,"Pool");var PoolManager=function(){function e(){}return e.SetupPool=function(e,t,n,o){return void 0===t&&(t=null),void 0===n&&(n=null),void 0===o&&(o=null),this.PoolDic.ContainsKey(e)||this.PoolDic.Add(e,new Pool(t,n,o)),this.PoolDic[e]},e.GetPool=function(e){return this.PoolDic.ContainsKey(e)?this.PoolDic[e]:null},e.GetObj=function(e,t){void 0===t&&(t="");var n=this.GetPool(e);return null!=n?n.GetObj(t):null},e.RecycleObj=function(e,t,n){void 0===n&&(n="");var o=this.GetPool(e);null!=o&&o.RecycleObj(t,n)},e.ClearTargetPool=function(e){var t=this.GetPool(e);null!=t&&t.Clear()},e.Clear=function(){for(var e=this.PoolDic.Keys,t=0,n=e.length;n>t;t++)this.ClearTargetPool(e[t])},e.PoolDic=new Dictionary([]),e}();__reflect(PoolManager.prototype,"PoolManager");var SendTool=function(){function e(){this.NotifyListTargetsDic=new Dictionary([]),this.NotifySingleTargetDic=new Dictionary([])}return Object.defineProperty(e,"ins",{get:function(){return null==this.Instance&&(this.Instance=new e),this.Instance},enumerable:!0,configurable:!0}),e.Register=function(e,t,n,o){return void 0===o&&(o=!1),this.ins.Register(e,t,n,o)},e.Unregister=function(e,t){this.ins.Unregister(e,t)},e.UnregisterByKey=function(e,t){this.ins.UnregisterByKey(e,t)},e.UnregisterActionAllMethod=function(e){this.ins.UnregisterActionAllMethod(e)},e.SendData=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];(o=this.ins).SendData.apply(o,[e].concat(t));var o},e.SendDataToTarget=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];(i=this.ins).SendDataToTarget.apply(i,[e,t].concat(n));var i},e.prototype.Register=function(e,t,n,o){void 0===o&&(o=!1);var i=null;return o?(this.NotifySingleTargetDic.ContainsKey(e)||this.NotifySingleTargetDic.Add(e,new NotifiyStruct(e,o)),i=this.NotifySingleTargetDic[e]):(this.NotifyListTargetsDic.ContainsKey(e)||this.NotifyListTargetsDic.Add(e,new NotifiyStruct(e,o)),i=this.NotifyListTargetsDic[e]),i.Add(t,n)},e.prototype.Unregister=function(e,t){if(this.NotifyListTargetsDic.ContainsKey(e)){var n=this.NotifyListTargetsDic[e];return void n.Remove(t)}if(this.NotifySingleTargetDic.ContainsKey(e)){var n=this.NotifySingleTargetDic[e];n.Remove(t)}},e.prototype.UnregisterByKey=function(e,t){if(!IsNullOrUndefined(e)&&!IsNullOrUndefined(t)){if(this.NotifyListTargetsDic.ContainsKey(e)){var n=this.NotifyListTargetsDic[e];return void n.RemoveByKey(t)}if(this.NotifySingleTargetDic.ContainsKey(e)){var n=this.NotifySingleTargetDic[e];n.RemoveByKey(t)}}},e.prototype.UnregisterActionAllMethod=function(e){if(!IsNullOrUndefined(e)){if(this.NotifyListTargetsDic.ContainsKey(e)){var t=this.NotifyListTargetsDic[e];return void(t&&t.RemoveAll())}if(this.NotifySingleTargetDic.ContainsKey(e)){var t=this.NotifySingleTargetDic[e];t&&t.RemoveAll()}}},e.prototype.SendData=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.NotifyListTargetsDic.ContainsKey(e)){var o=this.NotifyListTargetsDic[e];o.SendData.apply(o,[e].concat(t))}if(this.NotifySingleTargetDic.ContainsKey(e)){var o=this.NotifySingleTargetDic[e];o.SendData.apply(o,[e].concat(t))}},e.prototype.SendDataToTarget=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];if(this.NotifyListTargetsDic.ContainsKey(e)){var i=this.NotifyListTargetsDic[e];i.SendDataToTarget.apply(i,[e,t].concat(n))}if(this.NotifySingleTargetDic.ContainsKey(e)){var i=this.NotifySingleTargetDic[e];i.SendDataToTarget.apply(i,[e,t].concat(n))}},e}();__reflect(SendTool.prototype,"SendTool");var NotifiyStruct=function(){function e(e,t){this.Action="",this.SingleTarget=!1,this.KeyCounter=0,this.KeyList=[],this.Callers=[],this.Methods=[],this.Action=e,this.SingleTarget=t}return e.prototype.Add=function(e,t){var n="";if(IsNullOrUndefined(t))return n;var o=!0;if(this.SingleTarget){var i=this.Methods.indexOf(t);0>i?(this.Callers.push(e),this.Methods.push(t)):(o=!1,n=this.KeyList[i])}else{if(this.Callers.indexOf(e)>=0&&this.Methods.indexOf(t)>=0)return Debug.LogWarning("重複註冊"),"";this.Callers.push(e),this.Methods.push(t)}return o&&(this.KeyCounter++,n=this.KeyCounter.toString()+(this.SingleTarget?"_Single":"_List"),this.KeyList.push(n)),n},e.prototype.Remove=function(e){if(!IsNullOrUndefined(e)){var t=this.Methods.indexOf(e);t>=0&&(this.Callers.splice(t,1),this.Methods.splice(t,1),this.KeyList.splice(t,1))}},e.prototype.RemoveByKey=function(e){this.RemoveByIndex(this.KeyList.indexOf(e))},e.prototype.RemoveByIndex=function(e){e>=0&&(this.Callers.splice(e,1),this.Methods.splice(e,1),this.KeyList.splice(e,1))},e.prototype.RemoveAll=function(){for(var e=0,t=this.Callers.length;t>e;e++)this.Callers[0]&&(this.Callers[0]=null),this.Callers.splice(0,1);for(var e=0,t=this.Methods.length;t>e;e++)this.Methods[0]&&(this.Methods[0]=null),this.Methods.splice(0,1);for(var e=0,t=this.KeyList.length;t>e;e++)this.KeyList[0]&&(this.KeyList[0]=null),this.KeyList.splice(0,1);this.Callers=[],this.Methods=[],this.KeyList=[]},e.prototype.SendData=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var o=0,i=0,a=this.Methods.length;a>i;i++)if(IsNullOrUndefined(this.Methods[i-o]))this.RemoveByIndex(i-o),o++;else{var r=!1;IsNullOrUndefined(t)?r=!0:this.Methods[i-o].length!==t.length,r?this.Methods[i-o].apply(this.Callers[i-o]):this.Methods[i-o].apply(this.Callers[i-o],t)}},e.prototype.SendDataToTarget=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];for(var i=0,a=0,r=this.Methods.length;r>a;a++)if(IsNullOrUndefined(this.Methods[a-i]))this.RemoveByIndex(a-i),i++;else{var s=!1;if(IsNullOrUndefined(n)?s=!0:this.Methods[a-i].length!==n.length,0==this.Methods[a-i].length&&(s=!0),t===this.Callers[a-i])try{s?this.Methods[a-i].apply(this.Callers[a-i]):this.Methods[a-i].apply(this.Callers[a-i],n)}catch(l){IsNullOrUndefined(n)?Debug.LogError("<<SendTool>> ["+e+"] 執行方法 = "+this.Methods[a-i]+" / 參數 = NullOrUndefined / 錯誤 : "+l):Debug.LogError("<<SendTool>> ["+e+"] 執行方法 = "+this.Methods[a-i]+" / 參數 = "+n+" / 錯誤 : "+l)}}},e}();__reflect(NotifiyStruct.prototype,"NotifiyStruct");var ServerDebug=function(){function e(){}return e.init=function(e){this.ShowDebug=e},e.Log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ShowDebug&&console.log(this.FrontString+this.GetLogString.apply(this,e))},e.LogWarning=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ShowDebug&&console.warn(this.FrontString+this.GetLogString.apply(this,e))},e.LogError=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ShowDebug&&console.error(this.FrontString+this.GetLogString.apply(this,e))},e.LogAlert=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ShowDebug&&alert(this.FrontString+this.GetLogString.apply(this,e))},e.LogWithFlag=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ShowDebug&&console.log(this.FrontString+"--------------- "+this.GetLogString.apply(this,e)+" ---------------")},e.LogWarningWithFlag=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ShowDebug&&console.warn(this.FrontString+"--------------- "+this.GetLogString.apply(this,e)+" ---------------")},e.LogErrorWithFlag=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.ShowDebug&&console.error(this.FrontString+"--------------- "+this.GetLogString.apply(this,e)+" ---------------")},e.GetLogString=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return null!=e&&e.length>0?1==e.length?e[0]:this.GetLogValueFormat.apply(this,e):""},e.GetLogValueFormat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="",o=e.length;o%2!=0&&o--;for(var i=0;o>i;i++)n+=i%2==0?"["+(null==e[i]?"NULL_KEY":e[i])+" = ":(null==e[i]?"NULL_VALUE":e[i])+"]";return n},e.FrontString="【サーバ】 ",e.ShowDebug=!0,e}();__reflect(ServerDebug.prototype,"ServerDebug");var Time=function(){function e(){this.LastTime=0,this.IsInited=!1}return Object.defineProperty(e,"ins",{get:function(){return null==this.Instance&&(this.Instance=new e),this.Instance},enumerable:!0,configurable:!0}),Object.defineProperty(e,"Time",{get:function(){return MathMul(this.MsTime,.001)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"DeltaTime",{get:function(){return MathMul(this.MsDeltaTime,.001)},enumerable:!0,configurable:!0}),e.GetDateDifferenceNowFormat=function(e){var t=new Date;return t.setDate(t.getDate()+e),this.GetDateFormat(t.getFullYear(),t.getMonth()+1,t.getDate())},e.GetDateNowFormat=function(){var e=new Date;return this.GetDateFormat(e.getFullYear(),e.getMonth()+1,e.getDate())},e.GetDateFormat=function(e,t,n){return Method.GetFixIntNumberWithZeroString(t,99)+"/"+Method.GetFixIntNumberWithZeroString(n,99)+"/"+e},Object.defineProperty(e,"Now",{get:function(){return MathMul(this.NowMs,.001)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"NowMs",{get:function(){return(new Date).getTime()},enumerable:!0,configurable:!0}),e.SkipAwaitSeconds=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:this.SkipAwait=!0,t.label=1;
case 1:return this.AwaitList.length>0?[4,e.WaitForDeltaTime()]:[3,3];case 2:return t.sent(),[3,1];case 3:return[4,e.WaitForDeltaTime()];case 4:return t.sent(),this.SkipAwait=!1,[2]}})})},e.WaitForSkippableSeconds=function(t){return void 0===t&&(t=this.DeltaTime),__awaiter(this,void 0,void 0,function(){var n,o;return __generator(this,function(i){switch(i.label){case 0:if(!(t>0))return[3,4];if(this.SkipAwait)return[3,4];n=!1,o=e.CountMsTime(1e3*t,null,function(){n=!0}),this.AwaitList.push(o),i.label=1;case 1:return n||this.SkipAwait?[3,3]:[4,e.WaitForDeltaTime()];case 2:return i.sent(),[3,1];case 3:return e.Stop(o),this.AwaitList.splice(this.AwaitList.indexOf(o),1),[3,4];case 4:return[2]}})})},e.Init=function(){this.ins.Init()},e.Register=function(e){return this.ins.Register(e)},e.RegisterAndStopKey=function(e,t){return this.UnregisterByKey(t),this.ins.Register(e)},e.RegisterFixUpdate=function(e){return this.ins.RegisterFixUpdate(e)},e.RegisterFixUpdateAndStopKey=function(e,t){return this.UnregisterByKey(t),this.ins.RegisterFixUpdate(e)},e.Unregister=function(e){this.ins.Unregister(e)},e.UnregisterByKey=function(e){this.ins.UnregisterByKey(e)},e.Stop=function(e){this.ins.UnregisterByKey(e)},e.CountTime=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=null),this.ins.CountTime(e,t,n)},e.CountTimeFixUpdate=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=null),this.ins.CountTimeFixUpdate(e,t,n)},e.CountReverseTime=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=null),this.ins.CountReverseTime(e,t,n)},e.CountReverseTimeFixUpdate=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=null),this.ins.CountReverseTimeFixUpdate(e,t,n)},e.CountMsTime=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=null),this.ins.CountMsTime(e,t,n)},e.CountReverseMsTime=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=null),this.ins.CountReverseMsTime(e,t,n)},e.DelayAction=function(e,t){return this.ins.CountTime(e,null,t)},e.StopAndDelayAction=function(e,t,n){return this.ins.UnregisterByKey(n),this.ins.CountTime(e,null,t)},e.DelayMsAction=function(e,t){return this.ins.CountMsTime(e,null,t)},e.DelayOneFrameAction=function(t){return this.ins.CountTime(e.DeltaTime,null,t)},e.WaitForDeltaTime=function(){var e=this;return new Promise(function(t){return setTimeout(t,e.MsDeltaTime)})},e.WaitForSecond=function(e){var t=this;return void 0===e&&(e=0),0>=e?new Promise(function(e){return setTimeout(e,t.MsDeltaTime)}):this.WaitForSeconds(e)},e.WaitForSeconds=function(e){return new Promise(function(t){return setTimeout(t,1e3*e)})},Object.defineProperty(e.prototype,"CodeName",{get:function(){return"<<Time>>"},enumerable:!0,configurable:!0}),e.prototype.Init=function(){this.IsInited||(this.IsInited=!0,this.LastTime=egret.getTimer(),egret.startTick(this.OnUpdate,this))},e.prototype.OnUpdate=function(t){return e.MsTime=t,e.MsDeltaTime=t-this.LastTime,this.CallListener(e.MsDeltaTime),this.LastTime=t,!1},e.prototype.Register=function(e){return SendTool.Register(this.CodeName,this,e)},e.prototype.Unregister=function(e){SendTool.Unregister(this.CodeName,e)},e.prototype.UnregisterByKey=function(e){SendTool.UnregisterByKey(this.CodeName,e)},e.prototype.CallListener=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];SendTool.SendData.apply(SendTool,[this.CodeName].concat(e))},e.prototype.RegisterFixUpdate=function(t){var n=0,o=this.Register(function(o){for(n+=o;n>=e.FIXED_UPDATE_DELTA_TIME;)t(e.FIXED_UPDATE_DELTA_TIME),n-=e.FIXED_UPDATE_DELTA_TIME});return o},e.prototype.CountTimeFixUpdate=function(e,t,n){var o=this;if(void 0===t&&(t=null),void 0===n&&(n=null),e>0){var i=0,a=this.RegisterFixUpdate(function(r){i+=r,i>=1e3*e?(null!=t&&t(e),null!=n&&n(),o.UnregisterByKey(a)):null!=t&&t(i/1e3)});return a}return null!=t&&t(e),null!=n&&n(),""},e.prototype.CountTime=function(e,t,n){var o=this;if(void 0===t&&(t=null),void 0===n&&(n=null),e>0){var i=0,a=this.Register(function(r){i+=r,i>=1e3*e?(null!=t&&t(e),null!=n&&n(),o.UnregisterByKey(a)):null!=t&&t(i/1e3)});return a}return null!=t&&t(e),null!=n&&n(),""},e.prototype.CountReverseTime=function(e,t,n){var o=this;if(void 0===t&&(t=null),void 0===n&&(n=null),e>0){var i=1e3*e,a=this.Register(function(e){i-=e,0>=i?(null!=t&&t(0),null!=n&&n(),o.UnregisterByKey(a)):null!=t&&t(i/1e3)});return a}return null!=t&&t(0),null!=n&&n(),""},e.prototype.CountReverseTimeFixUpdate=function(e,t,n){var o=this;if(void 0===t&&(t=null),void 0===n&&(n=null),e>0){var i=1e3*e,a=this.RegisterFixUpdate(function(e){i-=e,0>=i?(null!=t&&t(0),null!=n&&n(),o.UnregisterByKey(a)):null!=t&&t(i/1e3)});return a}return null!=t&&t(0),null!=n&&n(),""},e.prototype.CountMsTime=function(e,t,n){var o=this;void 0===t&&(t=null),void 0===n&&(n=null);var i=0;if(e>0){var a=this.Register(function(r){i+=r,i>=e?(null!=t&&t(e),null!=n&&n(),o.UnregisterByKey(a)):null!=t&&t(i)});return a}return null!=t&&t(e),null!=n&&n(),""},e.prototype.CountReverseMsTime=function(e,t,n){var o=this;if(void 0===t&&(t=null),void 0===n&&(n=null),e>0){var i=e,a=this.Register(function(e){i-=e,0>=i?(null!=t&&t(0),null!=n&&n(),o.UnregisterByKey(a)):null!=t&&t(i)});return a}return null!=t&&t(0),null!=n&&n(),""},e.FIXED_UPDATE_DELTA_TIME=16,e.MsTime=0,e.MsDeltaTime=0,e.SkipAwait=!1,e.AwaitList=[],e}();__reflect(Time.prototype,"Time");var AudioClip=function(){function e(t,n,o){void 0===o&&(o=null);var i=this;this.IsLoadComplete=!1,this.FadeKey="",e.IDSerialNumber++,this.ID=e.IDSerialNumber,this.Key=t,this.Url=n,this.Audio=new Howl({src:[n],autoplay:!1,loop:!1,volume:0,onload:function(){i.IsLoadComplete=!0,null!=o&&o()},onend:function(){i.OnPlayEnd(i)}})}return Object.defineProperty(e.prototype,"IsPlaying",{get:function(){return null!=this.Audio?this.Audio.playing():!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Volume",{get:function(){return null!=this.Audio?this.Audio.volume():0},set:function(e){LerpMethod.Stop(this.FadeKey),this.SetVolume(e)},enumerable:!0,configurable:!0}),e.prototype.SetVolume=function(e){e>1?e=1:0>e&&(e=0);try{null!=this.Audio&&this.Audio.volume(e)}catch(t){}},Object.defineProperty(e.prototype,"Loop",{set:function(e){null!=this.Audio&&this.Audio.loop(e)},enumerable:!0,configurable:!0}),e.prototype.FadeTo=function(e,t,n){var o=this;void 0===t&&(t=1),void 0===n&&(n=null),LerpMethod.Stop(this.FadeKey),t>0?this.FadeKey=LerpMethod.LerpValue(t,this.Volume,e,CurveMethod.EaseInOut,function(e){o.SetVolume(e)},n):(this.SetVolume(e),null!=n&&n())},e.prototype.Play=function(e){void 0===e&&(e=-1),null!=this.Audio&&(e>=0&&this.Audio.seek(e),this.Audio.play())},e.prototype.Pause=function(){null!=this.Audio&&this.Audio.pause()},e.prototype.Stop=function(){null!=this.Audio&&this.Audio.stop()},e.prototype.OnPlayEnd=function(e){},e.prototype.Clear=function(){this.Stop(),delete this.Audio,this.Key=null,this.Audio=null},e.prototype.WaitForSeconds=function(e){return new Promise(function(t){return setTimeout(t,1e3*e)})},e.IDSerialNumber=0,e}();__reflect(AudioClip.prototype,"AudioClip");var PhotonManager=function(){function e(){this.GetFakeDataHandler=null,this.Connectors=new Dictionary([]),this.Handlers=new Dictionary}return Object.defineProperty(e,"ins",{get:function(){return null==this.Instance&&(this.Instance=new e),this.Instance},enumerable:!0,configurable:!0}),e.prototype.RegisterGetFakeDataHandler=function(e){this.GetFakeDataHandler=e},e.prototype.GetGameConnector=function(e){void 0===e&&(e=null);var t=e;return null==t&&(this.GameServerConnector||(this.GameServerConnector=this.GetConnector(PhotonConnetorType.Game)),t=this.GameServerConnector),t},e.prototype.GetConnector=function(e,t,n){void 0===t&&(t=""),void 0===n&&(n=null);var o=this.Connectors.GetValueByKey(e);return null==o&&(o=null==n?new PhotonConnector(t,GlobalValue.ShowServerLog):n),this.Connectors.Update(e,o),o},e.prototype.GetHandler=function(e,t){var n=this.Handlers.GetValueByKey(e);return null==n&&(n=new t),this.Handlers.Update(e,n),n},e.prototype.GetGameHandler=function(e){void 0===e&&(e=null);var t="GameHandler",n=this.Handlers.GetValueByKey(t);return null==n&&(n=null==e?new PhotonHandler_Game:new e),this.Handlers.Update(t,n),n},e.prototype.Login=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null);var o="Login",i=n;null==i&&(i=this.GetConnector(PhotonConnetorType.Login,GlobalValue.LoginIP));var a=null==t?this.GetHandler(o,PhotonHandler_Login):this.GetHandler(o,t);if(i.RegisterHandler(a,e),null==this.GetFakeDataHandler)i.Connect();else{var r=PhotonProtocol.LoginAccountResponse,s=this.CheckMsg(r);a.OnMsg(r,s)}return i},e.prototype.LoginLobby=function(e,t,n,o,i){void 0===o&&(o=null),void 0===i&&(i=null);var a=i;if(null==a&&(a=this.GetConnector(PhotonConnetorType.Game,e)),a.RegisterHandler(o,n),o.SetParams(t),null==this.GetFakeDataHandler)a.Connect();else{var r=PhotonProtocol.LoginLobbyResponse,s=this.CheckMsg(r);o.OnMsg(r,s)}return a},e.prototype.EnterRoom=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=null),this.SendGameRequest("JoinRoom",PhotonProtocol.JoinGameRoomRequest,e,t,n)},e.prototype.GetJackpot=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null);var o="GetJackpot",i=(this.GetGameConnector(n),null==t?this.GetHandler(o,PhotonHandler_GetJackpot):this.GetHandler(o,t));return this.SendGameRequest(o,PhotonProtocol.GetJackpotRequest,e,i,n)},e.prototype.GetBalance=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null);var o="GetBalance",i=(this.GetGameConnector(n),null==t?this.GetHandler(o,PhotonHandler_GetBalance):this.GetHandler(o,t));return this.SendGameRequest(o,PhotonProtocol.GetBalanceRequest,e,i,n)},e.prototype.GetSlotGameResult=function(e,t,n,o){void 0===t&&(t=-1),void 0===n&&(n=null),void 0===o&&(o=null);var i=this.GetGameConnector(o),a=this.GetGameHandler(n);return this.SendGameRequest("GetSlotGameResult",PhotonProtocol.GetSlotGameResultRequest,e,a,i,t)},e.prototype.GetBorderGameResult=function(e,t,n,o,i){void 0===n&&(n=-1),void 0===o&&(o=null),void 0===i&&(i=null);var a=this.GetGameConnector(i),r=this.GetGameHandler(o);return this.SendGameRequest("GetBorderGameResult",PhotonProtocol.GetBorderGameRequest,t,r,a,n,e)},e.prototype.SendGameRequest=function(e,t,n,o,i,a,r){void 0===o&&(o=null),void 0===i&&(i=null),void 0===a&&(a=-1),void 0===r&&(r=null);var s=i;if(null==s&&(s=this.GetGameConnector()),null==s)return Debug.LogError("沒有登入Lobby"),null;if(s.RegisterHandler(o,n),null==this.GetFakeDataHandler)s.ExeHandlerAction(e,r);else{var l=t+1,u=this.CheckMsg(l,a,r);o.OnMsg(l,u)}return s},e.prototype.CheckMsg=function(e,t,n){void 0===t&&(t=-1);var o=this.GetFakeDataHandler.GetFakeResponse(e,t,n);return null!=this.GetFakeDataHandler&&null==o?(Debug.LogError("可能沒有把假資料掛到default.res的Json裡"),null):o},e.RespEventAction="OnPhotonResponse",e}();__reflect(PhotonManager.prototype,"PhotonManager");var DBoneListenerFormat=function(){function e(e,t){this.Listener=e,this.ThisObj=t}return e}();__reflect(DBoneListenerFormat.prototype,"DBoneListenerFormat");var DBoneElement=function(){function e(e,t,n){void 0===n&&(n=!1);var o=this;this.GObj=null,this.RegisterAniEvent=!1,this.EventHandler=[],this.IsRegisteredClickEvent=!1,this.OnClickEvent=function(){o.ClickEvent&&o.ClickEvent()},this.GObj=e,this.ResourceName=t,this.RegisterAniEvent=n,this.RegisterAniEvent&&(this.GObj.addEventListener(dragonBones.EventObject.FRAME_EVENT,this.HandleEvent,this),this.GObj.addEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.HandleEvent,this))}return e.prototype.Clear=function(){this.RegisterAniEvent&&(this.GObj.removeEventListener(dragonBones.EventObject.FRAME_EVENT,this.HandleEvent,this),this.GObj.removeEventListener(dragonBones.EventObject.LOOP_COMPLETE,this.HandleEvent,this))},e.prototype.HandleEvent=function(e){var t=e.eventObject,n=null;switch(t.type){case dragonBones.EventObject.FRAME_EVENT:n=this.GetFunction(t.animationState.name,t.name),null!=n&&n(e.eventObject);break;case dragonBones.EventObject.LOOP_COMPLETE:n=this.GetFunction(t.animationState.name,dragonBones.EventObject.LOOP_COMPLETE),null!=n&&n(e.eventObject)}},e.prototype.LocalToGlobal=function(e,t){return this.GObj.localToGlobal(e,t)},e.prototype.GlobalToLocal=function(e,t){return this.GObj.globalToLocal(e,t)},e.prototype.SetActive=function(e,t){void 0===t&&(t=!1),null!=this.GObj&&(this.GObj.visible=e,t&&(this.GObj.alpha=e?1:0))},Object.defineProperty(e.prototype,"hashCode",{get:function(){return this.GObj.hashCode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FlipX",{get:function(){return this.GObj.armature.flipX},set:function(e){this.GObj.armature.flipX=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FlipY",{get:function(){return this.GObj.armature.flipY},set:function(e){this.GObj.armature.flipY=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.GObj.x},set:function(e){this.GObj.x=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.GObj.y},set:function(e){this.GObj.y=e},enumerable:!0,configurable:!0}),e.prototype.SetPosition=function(e,t){this.GObj.x=e,this.GObj.y=t},Object.defineProperty(e.prototype,"Rotation",{get:function(){return this.GObj.rotation},set:function(e){this.GObj.rotation=e},enumerable:!0,configurable:!0}),e.prototype.SetScale=function(e,t){this.GObj.scaleX=e,this.GObj.scaleY=t},Object.defineProperty(e.prototype,"Scale",{get:function(){return new Vector2(this.GObj.scaleX,this.GObj.scaleY)},set:function(e){this.SetScale(e.x,e.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Alpha",{get:function(){return this.GObj.alpha},set:function(e){this.GObj.alpha=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DrawDebugRange",{set:function(e){this.GObj.debugDraw=e},enumerable:!0,configurable:!0}),e.prototype.RegisterAniEventHandler=function(e,t,n){this.SetFunction(e,t,n)},e.prototype.UnregisterAniEventHandler=function(e,t){this.SetFunction(e,t,null)},e.prototype.GetFunction=function(e,t){return null==this.EventHandler[e]&&(this.EventHandler[e]=[]),this.EventHandler[e][t]},e.prototype.SetFunction=function(e,t,n){null==this.EventHandler[e]&&(this.EventHandler[e]=[]),this.EventHandler[e][t]=n},e.prototype.ContainsPoint=function(e,t){if(null==this.GObj.armature)return!1;var n=this.GObj.armature.containsPoint(e,t);return null!=n},e.prototype.IntersectsSegment=function(e,t,n,o,i,a){if(null==this.GObj.armature)return!1;var r=this.GObj.armature.intersectsSegment(e,t,n,o,i,a);return null!=r},e.prototype.HasAni=function(e){for(var t=0,n=this.GObj.animation.animationNames.length;n>t;t++)if(this.GObj.animation.animationNames[t]==e)return!0;return!1},e.prototype.PlayAni=function(e,t,n,o){void 0===t&&(t=null),void 0===n&&(n=-1),void 0===o&&(o=1),this.CurrentAniName=e,this.GObj?this.GObj.animation?(this.GObj.animation.timeScale=o,this.GObj.animation.play(e,n)):Debug.LogError("沒有animation : aniName = "+e+" / ResourceName = "+this.ResourceName):Debug.LogError("沒有GObj : ResourceName = "+this.ResourceName),this.SetFunction(e,dragonBones.EventObject.LOOP_COMPLETE,t)},e.prototype.StopAni=function(e){this.GObj?this.GObj.animation&&this.GObj.animation.stop(e):Debug.LogError("沒有GObj : ResourceName = "+this.ResourceName)},e.prototype.FadeInAni=function(e,t,n,o,i){void 0===t&&(t=-1),void 0===n&&(n=null),void 0===o&&(o=-1),void 0===i&&(i=1),this.CurrentAniName=e,this.GObj.animation.timeScale=i,this.GObj.animation.fadeIn(e,t,o),this.SetFunction(e,dragonBones.EventObject.LOOP_COMPLETE,n)},e.prototype.RegisterClickEvent=function(e){this.ClickEvent=e,this.IsRegisteredClickEvent||(this.IsRegisteredClickEvent=!0,DBoneManager.AddEventListener(this,egret.TouchEvent.TOUCH_TAP,this.OnClickEvent,this))},e.prototype.UnregisterClickEvent=function(){this.IsRegisteredClickEvent&&(this.IsRegisteredClickEvent=!1,DBoneManager.RemoveEventListener(this,egret.TouchEvent.TOUCH_TAP,this.OnClickEvent,this))},e}();__reflect(DBoneElement.prototype,"DBoneElement");var DBoneManager=function(){function e(){}return e.Generate=function(e,t){void 0===t&&(t=0);var n=dragonBones.EgretFactory.factory;if(this.ParsedResNames.indexOf(e)<0){this.ParsedResNames.push(e);try{n.parseDragonBonesData(ResManager.GetResource(e+"_ske_json")),n.parseTextureAtlasData(ResManager.GetResource(e+"_tex_json"),ResManager.GetResource(e+"_tex_png"))}catch(o){}}var i=n.buildArmatureDisplay(e,e),a=null;return null!=i&&(a=new DBoneElement(i,e),t>0&&a.SetScale(t,t)),a},e.AddEventListener=function(e,t,n,o,i){if(void 0===o&&(o=null),void 0===i&&(i=!1),null==n)Debug.LogError("Add「"+t+"」EventListener失敗 "+e.ResourceName+" : listener Function = null");else if(null!=e){i&&this.RemoveAllEventListener(e,t),this.Listeners.ContainsKey(t)||this.Listeners.Add(t,[]);var a=this.Listeners[t];a.push(new DBoneListenerFormat(n,o)),e.GObj.touchEnabled=!0,e.GObj.addEventListener(t,n,o)}else Debug.LogError("Add「"+t+"」EventListener失敗 : dbObj = null")},e.RemoveEventListener=function(e,t,n,o){void 0===o&&(o=null),null==n?Debug.LogError("Remove「"+t+"」EventListener失敗 "+e.ResourceName+" : listener Function = null"):null!=e?e.GObj.removeEventListener(t,n,o):Debug.LogError("Remove「"+t+"」EventListener失敗 : dbObj = null")},e.RemoveAllEventListener=function(e,t){if(this.Listeners.ContainsKey(t))for(var n=this.Listeners[t],o=n.length;o>0;o--)null!=n[o]&&e.GObj.removeEventListener(t,n[o].Listener,n[o].ThisObj),n[o]=null,n.splice(o,1)},e.ParsedResNames=[],e.Listeners=new Dictionary([]),e}();__reflect(DBoneManager.prototype,"DBoneManager");var FairyPool=function(){function e(e,t,n,o,i){void 0===n&&(n=null),void 0===o&&(o=null),void 0===i&&(i=null),this.ActiveObjs=new Dictionary([]),this.RecycledObjs=new Dictionary([]),this.OnGenerateMethod=null,this.OnGetMethod=null,this.OnRecycleMethod=null,this.PackageName=e,this.ResourceName=t,null!=n&&(this.OnGenerateMethod=n),null!=o&&(this.OnGetMethod=o),null!=i&&(this.OnRecycleMethod=i)}return e.prototype.GetKey=function(e){return e?e.hashCode:0/0},e.prototype.GetActiveObjs=function(e){var t=[];if(this.ActiveObjs.ContainsKey(e)){var n=this.ActiveObjs[e];n.GetValuesToArray(t)}return t},e.prototype.GetActiveObjsToArray=function(e,t){if(void 0===e&&(e=""),StringIsNullOrEmpty(e))this.GetAllActiveObjsToArray(t);else if(this.ActiveObjs.ContainsKey(e)){var n=this.ActiveObjs[e];n.GetValuesToArray(t)}},e.prototype.GetAllActiveObjsToArray=function(e){if(IsNullOrUndefined(e))Debug.LogError("<<PoolObj>> get All ActiveObjs To Array array isNullOrUndefined");else for(var t=this.ActiveObjs.Keys,n=0,o=t.length;o>n;n++){var i=this.ActiveObjs.GetValueByKey(t[n]);null!=i?i.GetValuesToArray(e):Debug.LogError("<<PoolObj>> parse Dictionary error")}},e.prototype.GetObj=function(e){void 0===e&&(e="");for(var t=null,n=this.RecycledObjs.Values,o=0,i=n.length;i>o;o++)if(null!=n[o]){t=n[o],this.RecycledObjs.Remove(this.GetKey(t));break}return null==t&&(t=FUIManager.CreateEObjFromResourceByPackageName(this.PackageName,this.ResourceName),null!=this.OnGenerateMethod&&this.OnGenerateMethod(t)),null!=t&&(t.Touchable=!1,t.SetActive(!0),null!=this.OnGetMethod&&this.OnGetMethod(t)),this.AddActiveObj(t,e),t},e.prototype.AddActiveObj=function(e,t){if(void 0===t&&(t=""),null!=e){var n=this.GetKey(e);isNaN(n)||(this.ActiveObjs.ContainsKey(t)||this.ActiveObjs.Add(t,new Dictionary([])),this.ActiveObjs[t].ContainsKey(n)?Debug.LogError(t+" Active池裡已有該物件 : "+n):this.ActiveObjs[t].Add(n,e))}else Debug.LogError("Add Active Obj失敗 : targetObj = null")},e.prototype.RecycleObj=function(e,t){if(void 0===t&&(t=""),null!=e){var n=this.GetKey(e);if(!isNaN(n)){if(StringIsNullOrEmpty(t))for(var o=this.ActiveObjs.Keys,i=0,a=o.length;a>i;i++){var r=this.ActiveObjs.GetValueByKey(o[i]);if(r.ContainsKey(n)&&r.GetValueByKey(n)===e){r.Remove(n);break}}else if(this.ActiveObjs.ContainsKey(t)){var r=this.ActiveObjs.GetValueByKey(t);r.ContainsKey(n)&&r.GetValueByKey(n)===e&&r.Remove(n)}this.RecycledObjs.ContainsKey(n)?Debug.LogError("<<PoolObj>> 物件("+n+")已存在在回收池中"):this.RecycledObjs.Add(n,e),null!=e&&e.SetActive(!1),null!=this.OnRecycleMethod&&this.OnRecycleMethod(e)}}else Debug.LogError("<<PoolObj>> Recycle targetObj = null")},e.prototype.RecycleAllObjs=function(e){if(void 0===e&&(e=""),StringIsNullOrEmpty(e))for(var t=this.ActiveObjs.Keys,n=0,o=t.length;o>n;n++)for(var i=this.ActiveObjs.GetValueByKey(t[n]),a=i.Values,r=0,s=a.length;s>r;r++)this.RecycleObj(a[0],t[n]);else if(this.ActiveObjs.ContainsKey(e))for(var i=this.ActiveObjs.GetValueByKey(e),a=i.Values,r=0,s=a.length;s>r;r++)this.RecycleObj(a[0],e)},e.prototype.Clear=function(){this.ActiveObjs.Clear(),this.RecycledObjs.Clear()},e}();__reflect(FairyPool.prototype,"FairyPool");var FairyPoolManager=function(){function e(){}return e.SetupPool=function(e,t,n,o,i,a){return void 0===o&&(o=null),void 0===i&&(i=null),void 0===a&&(a=null),this.PoolDic.ContainsKey(e)||this.PoolDic.Add(e,new FairyPool(t,n,o,i,a)),this.PoolDic[e]},e.GetPool=function(e){return this.PoolDic.ContainsKey(e)?this.PoolDic[e]:null},e.GetObj=function(e,t){void 0===t&&(t="");var n=this.GetPool(e);return null!=n?n.GetObj(t):null},e.RecycleObj=function(e,t,n){void 0===n&&(n="");var o=this.GetPool(e);null!=o&&o.RecycleObj(t,n)},e.ClearTargetPool=function(e){var t=this.GetPool(e);null!=t&&t.Clear()},e.Clear=function(){for(var e=this.PoolDic.Keys,t=0,n=e.length;n>t;t++)this.ClearTargetPool(e[t])},e.PoolDic=new Dictionary([]),e}();__reflect(FairyPoolManager.prototype,"FairyPoolManager");var FairyUIData=function(){function e(){this.LanguageKey="",this.AutoLanguageKeyByName="",this.OnClickPlaySoundName="",this.OnClickSendEventName="",this.OnPressSendEventName="",this.OnMouseHoverSendEventName="",this.Group="",this.EnablePixelHitTest=""}return e}();__reflect(FairyUIData.prototype,"FairyUIData");var FairyBtnAffectBehaviourData=function(){function e(){this.Target=""}return e}();__reflect(FairyBtnAffectBehaviourData.prototype,"FairyBtnAffectBehaviourData");var FairySetControllerData=function(){function e(){this.CtrllerName="",this.ToSelectedIndex=""}return e}();__reflect(FairySetControllerData.prototype,"FairySetControllerData");var FairyTextSettingsData=function(){function e(){this.AutoColor=""}return e}();__reflect(FairyTextSettingsData.prototype,"FairyTextSettingsData");var FairyTextLanguageTransformData=function(){function e(){this.x="",this.y="",this.Width="",this.Height="",this.FontSize=""}return e}();__reflect(FairyTextLanguageTransformData.prototype,"FairyTextLanguageTransformData");var FairyListenerFormat=function(){function e(e,t){this.Listener=e,this.ThisObj=t}return e}();__reflect(FairyListenerFormat.prototype,"FairyListenerFormat");var FairyUIElement=function(){function e(e,t,n,o){var i=this;if(this.GObj=null,this.PackageName="",this.FullPath="",this.ResourceName="",this.PoolName="",this.PoolIndex=-1,this.AniList=[],this.OnValueChangeEvent=function(e){var t=e.target;t&&i.ValueChangeEvent&&i.ValueChangeEvent(t.value)},this.IsRegisteredValueChangeEvent=!1,this.OnInputChangeEvent=function(e){var t=e.target;t&&i.InputChangeEvent&&i.InputChangeEvent(t.text)},this.IsRegisteredInputChangeEvent=!1,this.OnFocusInEvent=function(){i.FocusEvent&&i.FocusEvent(!0)},this.OnFocusOutEvent=function(){i.FocusEvent&&i.FocusEvent(!1)},this.IsRegisteredFocusEvent=!1,this.OnListScrollEvent=function(){var e=i.ScrollPane;e&&i.ListScrollEvent&&i.ListScrollEvent(e.percX,e.percY)},this.IsRegisteredListScrollEvent=!1,this.OnClickEvent=function(){i.ClickEvent&&i.ClickEvent()},this.IsRegisteredClickEvent=!1,this.LerpKey="",this.GObj=e,this.PackageName=t,this.ResourceName=n,this.FullPath=o,null!=this.GObj){var a=this.GObj.asCom;if(null!=a&&null!=a._transitions)for(var r=0,s=a._transitions.length;s>r;r++)this.AniList.push(a._transitions[r]);this.SetupData(this.GObj.data)}}return Object.defineProperty(e.prototype,"PackageResource",{get:function(){return this.PackageName+FUIManager.SlashSymbol+this.ResourceName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Hierarchy",{get:function(){return this.FullPath.replace(this.PackageName+FUIManager.SlashSymbol,"").replace(this.ResourceName+FUIManager.SlashSymbol,"")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ParentPath",{get:function(){var e=this.Hierarchy,t=FUIManager.SlashSymbol+Method.GetLastCharString(e,FUIManager.SlashSymbol);return this.Hierarchy.replace(t,"")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ParentEObj",{get:function(){return null==this.GObj.group?(Debug.LogWarning("該物件「"+this.Name+"」沒有Parent物件"),null):FUIManager.GetEObjByPackageResource(this.PackageResource,this.GObj.group.name,!0,!0)},set:function(e){FUIManager.SetEObjParentToEObj(this,e)},enumerable:!0,configurable:!0}),e.prototype.LocalToGlobal=function(e,t){return this.GObj.localToGlobal(e,t)},e.prototype.GlobalToLocal=function(e,t){return this.GObj.globalToLocal(e,t)},e.prototype.SetActive=function(e,t){void 0===t&&(t=!1),null!=this.GObj&&(this.GObj.visible=e,t&&(this.GObj.alpha=e?1:0))},Object.defineProperty(e.prototype,"ActiveSelf",{get:function(){return this.GObj.visible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Enabled",{get:function(){return this.GObj.enabled},set:function(e){this.GObj.enabled=e},enumerable:!0,configurable:!0}),e.prototype.SetPosition=function(e,t){this.GObj.setXY(e,t)},e.prototype.SetScale=function(e,t){this.GObj.setScale(e,t)},Object.defineProperty(e.prototype,"Alpha",{get:function(){return this.GObj.alpha},set:function(e){this.GObj.alpha=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"x",{get:function(){return this.GObj.x},set:function(e){this.GObj.x=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.GObj.y},set:function(e){this.GObj.y=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Position",{get:function(){return new Vector2(this.GObj.x,this.GObj.y)},set:function(e){this.SetPosition(e.x,e.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rotation",{get:function(){return this.GObj.rotation},set:function(e){this.GObj.rotation=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Scale",{get:function(){return new Vector2(this.GObj.scaleX,this.GObj.scaleY)},set:function(e){this.SetScale(e.x,e.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GlobalPosition",{get:function(){return this.GObj.localToRoot(0,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Angle",{get:function(){return 90-this.GObj.rotation},set:function(e){this.GObj.rotation=90-e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SpriteName",{get:function(){return this.GLoader.url},set:function(e){FUIManager.SetGObjLoaderUrl(this.GObj,this.PackageName,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Width",{get:function(){return this.GObj.width},set:function(e){this.GObj.width=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Height",{get:function(){return this.GObj.height},set:function(e){this.GObj.height=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Depth",{get:function(){return this.GObj.sortingOrder},set:function(e){this.GObj.sortingOrder=e},enumerable:!0,configurable:!0}),e.prototype.SetSpriteName=function(e,t){FUIManager.SetEObjLoaderUrl(this,e,t)},Object.defineProperty(e.prototype,"Name",{get:function(){return StringIsNullOrEmpty(this.GObj.name)&&this.PoolIndex>=0?StringIsNullOrEmpty(this.PoolName)?this.ResourceName+"_"+this.PoolIndex:this.PoolName+"_"+this.PoolIndex:this.GObj.name},set:function(e){this.GObj&&(this.GObj.name=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GImage",{get:function(){return this.GObj.asImage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FillAmount",{get:function(){return null!=this.GImage?this.GImage.fillAmount:-1},set:function(e){null!=this.GImage&&(this.GImage.fillAmount=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GSlider",{get:function(){return this.GObj.asSlider},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"SliderValue",{get:function(){return this.Slider||(this.Slider=this.GSlider),this.Slider?this.Slider.value:0},set:function(e){this.Slider||(this.Slider=this.GSlider),this.Slider&&(this.Slider.value=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GLoader",{get:function(){return this.GObj.asLoader},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GLoader3D",{get:function(){return this.GObj},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DBoneDisplay",{get:function(){return this.GLoader3D.content},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DBoneTimeScale",{get:function(){return null!=this.DBoneDisplay?this.DBoneDisplay.animation.timeScale:-1},set:function(e){null!=this.DBoneDisplay&&(this.DBoneDisplay.animation.timeScale=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Texture",{get:function(){return this.GLoader.texture},set:function(e){null!=e?this.GLoader.texture=e:Debug.LogWarning("Set Texture = null")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Icon",{get:function(){return this.GLoader.icon},set:function(e){this.GLoader.icon=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GButton",{get:function(){return this.GObj.asButton},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Selected",{get:function(){return null!=this.GButton?this.GButton.selected:!1},set:function(e){null!=this.GButton&&(this.GButton.selected=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Touchable",{get:function(){return this.GObj.touchable},set:function(e){this.GObj.touchable=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hashCode",{get:function(){return this.GObj.hashCode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GMovieClip",{get:function(){return this.GObj.asMovieClip},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TimeScale",{get:function(){return null!=this.GMovieClip?this.GMovieClip.timeScale:-1},set:function(e){null!=this.GMovieClip&&(this.GMovieClip.timeScale=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ScrollPane",{get:function(){return this.GObj.asCom.scrollPane},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GComboBox",{get:function(){return this.GObj.asComboBox},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GComponent",{get:function(){return this.GObj.asCom},enumerable:!0,configurable:!0}),e.prototype.GetController=function(e){return this.GComponent.getController(e)},e.prototype.GetSelectedIndex=function(e){if(StringIsNullOrEmpty(e))return-1;var t=this.GetController(e);return null!=t?t.selectedIndex:-1},e.prototype.SetSelectedIndex=function(e,t){if(!(StringIsNullOrEmpty(e)||0>t)){var n=this.GetController(e);if(null!=n)try{n.selectedIndex=t}catch(o){Debug.LogError(this.Name+" Set SelectedIndex錯誤 : "+o)}else Debug.LogError(this.Name+" Set SelectedIndex錯誤，沒有該ctrllerName : "+e)}},e.prototype.FireClick=function(e){void 0===e&&(e=!1);var t=this.GButton;return null!=t&&t.fireClick(e),t},Object.defineProperty(e.prototype,"GTextInput",{get:function(){return this.GObj.asTextInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"InputText",{get:function(){return this.GTextInput?this.GTextInput.text:""},set:function(e){this.GTextInput&&(this.GTextInput._textField.text=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"InputLimit",{set:function(e){this.GTextInput&&(this.GTextInput.restrict=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GText",{get:function(){return this.GObj.asTextField},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GList",{get:function(){return this.GObj.asList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"WordWrap",{get:function(){return null!=this.GText?this.GText.wordWrap:!1
},set:function(e){null!=this.GText&&(this.GText.wordWrap=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"R",{get:function(){return Math.floor(this.GText.color/256/256)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"G",{get:function(){return Math.floor(this.GText.color/256)%256},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"B",{get:function(){return this.GText.color%256},enumerable:!0,configurable:!0}),e.prototype.SetRGB=function(e,t,n){this.GObj.setRGB(e,t,n)},Object.defineProperty(e.prototype,"Color",{get:function(){return this.GText.color},set:function(e){if(null!=this.GText)this.GText.color=e;else{var t=this.GImage;null!=t&&(t.color=e)}},enumerable:!0,configurable:!0}),e.prototype.PlayGLoaderAni=function(){null!=this.GLoader&&(this.GLoader.frame=0),null!=this.GMovieClip&&(this.GMovieClip.playing=!1,this.GMovieClip.playing=!0)},e.prototype.StopGLoaderAni=function(){null!=this.GMovieClip&&(this.GMovieClip.playing=!1)},Object.defineProperty(e.prototype,"FontSize",{get:function(){return this.GText.fontSize},set:function(e){this.GText.fontSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Text",{get:function(){var e=this.GText;return IsNullOrUndefined(e)?"":e.text},set:function(e){var t=this.GText;IsNullOrUndefined(t)||(3==t.autoSize&&(null==this.Data&&(this.Data=new FairyUIData),null==this.Data.TextSettings&&(this.Data.TextSettings=new FairyTextSettingsData),this.Data.TextSettings.FontSize||(this.Data.TextSettings.FontSize=this.FontSize,this.Data.TextSettings.MaxWidth=this.Width,this.Data.TextSettings.MaxHeight=this.Height),t.singleLine?t.autoSize=fairygui.AutoSizeType.Both:t.autoSize=fairygui.AutoSizeType.Height),t.text=e,t.wordWrap=!0,null!=this.Data&&(IsNullOrUndefined(this.Data.TextSettings)||(Method.ParseValueToBoolean(this.Data.TextSettings.AutoColor,!1)&&this.GObj.setColor(t.color),this.Data.TextSettings.FontSize>0&&(t.fontSize=this.Data.TextSettings.FontSize,this.Data.TextSettings.MaxWidth>0&&(t.textWidth>this.Data.TextSettings.MaxWidth?FUIManager.SetTextFieldAutoSize(t,this.Data.TextSettings.MaxWidth,this.Data.TextSettings.FontSize,!0):null!=this.Data.TextSettings.MaxHeight&&this.Data.TextSettings.MaxHeight>0&&t.height>this.Data.TextSettings.MaxHeight&&FUIManager.SetTextFieldAutoSizeByHeight(t,this.Data.TextSettings.MaxHeight,this.Data.TextSettings.FontSize,!0))))))},enumerable:!0,configurable:!0}),e.prototype.RegisterSlideValueChangeEvent=function(e){return this.ValueChangeEvent=e,this.IsRegisteredValueChangeEvent?this:(this.IsRegisteredValueChangeEvent=!0,FUIManager.AddEventListener(this.GObj,fairygui.StateChangeEvent.CHANGED,this.OnValueChangeEvent,this),this)},e.prototype.UnregisterSlideValueChangeEvent=function(){return this.IsRegisteredValueChangeEvent?(this.IsRegisteredValueChangeEvent=!1,FUIManager.RemoveEventListener(this.GObj,fairygui.StateChangeEvent.CHANGED,this.OnValueChangeEvent,this),this):this},e.prototype.RegisterInputChangeEvent=function(e){return this.InputChangeEvent=e,this.IsRegisteredInputChangeEvent?this:(this.IsRegisteredInputChangeEvent=!0,FUIManager.AddEventListener(this.GObj,egret.Event.CHANGE,this.OnInputChangeEvent,this),this)},e.prototype.UnregisterInputChangeEvent=function(){return this.IsRegisteredInputChangeEvent?(this.IsRegisteredInputChangeEvent=!1,FUIManager.RemoveEventListener(this.GObj,egret.Event.CHANGE,this.OnInputChangeEvent,this),this):this},e.prototype.RegisterFocusEvent=function(e){return this.FocusEvent=e,this.IsRegisteredFocusEvent?this:(this.IsRegisteredFocusEvent=!0,FUIManager.AddEventListener(this.GObj,egret.FocusEvent.FOCUS_IN,this.OnFocusInEvent,this),FUIManager.AddEventListener(this.GObj,egret.FocusEvent.FOCUS_OUT,this.OnFocusOutEvent,this),this)},e.prototype.UnregisterFocusEvent=function(){return this.IsRegisteredFocusEvent?(this.IsRegisteredFocusEvent=!1,FUIManager.RemoveEventListener(this.GObj,egret.FocusEvent.FOCUS_IN,this.OnFocusInEvent,this),FUIManager.RemoveEventListener(this.GObj,egret.FocusEvent.FOCUS_OUT,this.OnFocusOutEvent,this),this):this},e.prototype.RegisterListScrollEvent=function(e){return this.ListScrollEvent=e,this.IsRegisteredListScrollEvent?this:(this.IsRegisteredListScrollEvent=!0,FUIManager.AddEventListener(this.ScrollPane,fairygui.ScrollPane.SCROLL,this.OnListScrollEvent,this),this)},e.prototype.UnregisterSlideListScrollEvent=function(){return this.IsRegisteredListScrollEvent?(this.IsRegisteredListScrollEvent=!1,FUIManager.RemoveEventListener(this.ScrollPane,fairygui.ScrollPane.SCROLL,this.OnListScrollEvent,this),this):this},e.prototype.RegisterClickEvent=function(e){return this.ClickEvent=e,this.IsRegisteredClickEvent?this:(this.IsRegisteredClickEvent=!0,FUIManager.AddEventListener(this.GObj,egret.TouchEvent.TOUCH_TAP,this.OnClickEvent,this),this)},e.prototype.UnregisterClickEvent=function(){return this.IsRegisteredClickEvent?(this.IsRegisteredClickEvent=!1,FUIManager.RemoveEventListener(this.GObj,egret.TouchEvent.TOUCH_TAP,this.OnClickEvent,this),this):this},e.prototype.SetParentToEObjByParentHierarchy=function(e){if(!StringIsNullOrEmpty(e)){var t=FUIManager.GetEObjByPackageResource(this.PackageResource,e);FUIManager.SetEObjParentToEObj(this,t)}},e.prototype.SetParentToEObj=function(e){FUIManager.SetEObjParentToEObj(this,e)},e.prototype.SetParentToGObj=function(e){FUIManager.SetGObjParentToGObj(this.GObj,e)},e.prototype.SetupPoolElementData=function(e,t){void 0===t&&(t=""),this.PoolIndex=e,this.PoolName=t;var n=this.GetChild("Data");return null!=n&&this.SetupData(n.GObj.data),this},e.prototype.SetupData=function(e){var t=this;if(!StringIsNullOrEmpty(e)){try{this.Data=JSON.parse(e)}catch(n){Debug.LogError(this.Name+" Parse JSON ERROR : "+n+" / FullPath = "+this.FullPath)}if(null!=this.Data){if(Method.ParseValueToBoolean(this.Data.AutoLanguageKeyByName,!1)?this.Data.LanguageKey=this.GObj.name:this.Data.LanguageKey=this.FilterString(this.Data,"LanguageKey"),this.Data.Group=this.FilterString(this.Data,"Group"),StringIsNullOrEmpty(this.Data.Group)||FUIManager.AddEObjToGroup(this.Data.Group,this),this.Data.OnClickPlaySoundName=this.FilterString(this.Data,"OnClickPlaySoundName"),this.Data.OnClickSendEventName=this.FilterString(this.Data,"OnClickSendEventName"),!StringIsNullOrEmpty(this.Data.OnClickPlaySoundName)||!StringIsNullOrEmpty(this.Data.OnClickSendEventName)){var o=this.GObj.asCom._children;if(o)for(var i=0,a=o.length;a>i;i++)o[i]&&(o[i].touchable=!1);this.RegisterClickEvent(function(){SendTool.SendData(FUIManager.HandleClickEventAction,t)})}if(this.Data.OnPressSendEventName=this.FilterString(this.Data,"OnPressSendEventName"),StringIsNullOrEmpty(this.Data.OnPressSendEventName)||(this.GObj.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){SendTool.SendData(FUIManager.HandlePressEventAction,t,!0)},this),this.GObj.addEventListener(egret.TouchEvent.TOUCH_END,function(){SendTool.SendData(FUIManager.HandlePressEventAction,t,!1)},this)),GlobalValue.IsMobile||(this.Data.OnMouseHoverSendEventName=this.FilterString(this.Data,"OnMouseHoverSendEventName"),StringIsNullOrEmpty(this.Data.OnMouseHoverSendEventName)||(this.GObj.addEventListener("mouseOver",function(){SendTool.SendData(FUIManager.HandleMouseHoverEventAction,t,!0)},this),this.GObj.addEventListener("mouseOut",function(){SendTool.SendData(FUIManager.HandleMouseHoverEventAction,t,!1)},this))),Method.ParseValueToBoolean(this.Data.EnablePixelHitTest,!1)){var r=this.GLoader;null!=r?r.pixelHitTest=!0:Debug.LogWarning("只有GLoader元件才能使用像素測試功能")}SendTool.SendData(FUIManager.HandleDataEventAction,this)}}},e.prototype.FilterString=function(e,t){return IsNullOrUndefined(e[t])?"":e[t]},e.prototype.GetChild=function(e){var t=null,n=this.GetDepthChild(e);return null!=n?t=FUIManager.ConvertGObjectToFairyUIElement(n,this.PackageName,this.ResourceName,this.FullPath+FUIManager.SlashSymbol+e):Debug.LogError(this.GObj.name+"物件getChild失敗: "+e),t},e.prototype.GetDepthChild=function(e){var t=this.GObj;if(null==t)return Debug.LogError(this.Name+" : GObj = null"),null;for(var n="",o=e.split(FUIManager.SlashSymbol),i=0,a=o.length;a>i;i++){if(t=t.asCom.getChild(o[i]),null==t)return Debug.LogError(this.GObj.name+"物件getDepthChild失敗: "+n),null;n+=o[i]+FUIManager.SlashSymbol}return t},e.prototype.SetAniFlag=function(e,t,n){void 0===n&&(n=null);var o=this.GetAniObj(e);o.setHook(t,function(){n&&n()})},Object.defineProperty(e.prototype,"PlayingAniName",{get:function(){if(null!=this.AniList)for(var e=0,t=this.AniList.length;t>e;e++)if(this.AniList[e].playing)return this.AniList[e].name;return""},enumerable:!0,configurable:!0}),e.prototype.PlayAni=function(e,t,n,o){void 0===t&&(t=null),void 0===n&&(n=1),void 0===o&&(o=!0);var i=null;if(null!=this.AniList){for(var a=0,r=this.AniList.length;r>a;a++)this.AniList[a].name==e?i=this.AniList[a]:o&&this.AniList[a].playing&&this.AniList[a].stop();null!=i?(i.timeScale=n,i.play(function(){null!=t&&t()})):null!=t&&t()}return i},e.prototype.StopPlayingAni=function(e,t){if(void 0===e&&(e=!0),void 0===t&&(t=!0),null!=this.AniList)for(var n=0,o=this.AniList.length;o>n;n++)this.AniList[n].playing&&this.AniList[n].stop(e,t)},e.prototype.GetAniObj=function(e){if(null!=this.AniList)for(var t=0,n=this.AniList.length;n>t;t++)if(this.AniList[t].name==e)return this.AniList[t];return null},e.prototype.ScrollPaneToXPos=function(e,t,n,o){if(void 0===t&&(t=0),void 0===n&&(n=CurveMethod.EaseInOut),void 0===o&&(o=null),null!=this.GObj){var i=this.ScrollPane;if(null!=i)return 0>=t?i.posX=e:(LerpMethod.Stop(this.LerpKey),this.LerpKey=LerpMethod.LerpValue(t,i.posX,e,n,function(e){i.posX=e},function(){null!=o&&o()})),i}return null},e.prototype.ScrollPaneToYPos=function(e,t,n,o){if(void 0===t&&(t=0),void 0===n&&(n=CurveMethod.EaseInOut),void 0===o&&(o=null),null!=this.GObj){var i=this.ScrollPane;if(null!=i)return 0>=t?i.posY=e:(LerpMethod.Stop(this.LerpKey),this.LerpKey=LerpMethod.LerpValue(t,i.posY,e,n,function(e){i.posY=e},function(){null!=o&&o()})),i}return null},e.prototype.ScrollPaneToPos=function(e,t){if(null!=this.GObj){var n=this.ScrollPane;if(null!=n)return n.posX=e,n.posY=t,n}return null},e.prototype.ScrollPaneToPercentXPos=function(e,t,n,o){if(void 0===t&&(t=0),void 0===n&&(n=CurveMethod.EaseInOut),void 0===o&&(o=null),null!=this.GObj){var i=this.ScrollPane;if(null!=i)return 0>=t?i.percX=e:(LerpMethod.Stop(this.LerpKey),this.LerpKey=LerpMethod.LerpValue(t,i.percX,e,n,function(e){i.percX=e},function(){null!=o&&o()})),i}return null},e.prototype.ScrollPaneToPercentYPos=function(e,t,n,o){if(void 0===t&&(t=0),void 0===n&&(n=CurveMethod.EaseInOut),void 0===o&&(o=null),null!=this.GObj){var i=this.ScrollPane;if(null!=i)return 0>=t?i.percY=e:(LerpMethod.Stop(this.LerpKey),this.LerpKey=LerpMethod.LerpValue(t,i.percY,e,n,function(e){i.percY=e},function(){null!=o&&o()})),i}return null},e.prototype.ScrollPaneToPercentPos=function(e,t){if(null!=this.GObj){var n=this.ScrollPane;if(null!=n)return n.percX=e,n.percY=t,n}return null},e}();__reflect(FairyUIElement.prototype,"FairyUIElement");var FUIManager=function(){function e(){}return Object.defineProperty(e,"UIWidth",{get:function(){return fairygui.GRoot.inst.width},enumerable:!0,configurable:!0}),Object.defineProperty(e,"UIHeight",{get:function(){return fairygui.GRoot.inst.height},enumerable:!0,configurable:!0}),e.AddEObjToGroup=function(e,t){var n=this.GroupDic.AddWhenNoKey(e,[]);n.indexOf(t)<0&&n.push(t)},e.GetGroupEObjs=function(e){var t=this.GroupDic.GetValueByKey(e);return t},e.ParsePackageResource=function(t,n,o){this.RootPackageResourceDic.Add(n+e.SlashSymbol+o,t),this.GetElementDictionary(t,n,o,this.ElementsDic)},e.GetElementDictionary=function(t,n,o,i){void 0===n&&(n=""),void 0===o&&(o=""),void 0===i&&(i=null);var a=StringIsNullOrEmpty(o)?"":n+e.SlashSymbol+o;if(null==t)return Debug.Log("<<FairyUIManager>> "+a+" uiRootObj = Null"),null;if(null!=i){if(i.ContainsKey(a))return Debug.Log("<<FairyUIManager>> 有重複或已Parse過的PackageResource: "+a),null}else i=new Dictionary([]);return this.AddToElementDic(i,t,a,n),null!=t.packageItem?this.ParseGObjChildrenToDic(i,t,t.asCom._children,a,n):Debug.LogWarning("<<FairyUIManager>> "+a+" 該PackageResource物件沒有packageItem: "+t),i},e.AddToElementDic=function(t,n,o,i){if(void 0===i&&(i=""),t.ContainsKey(o));else{StringIsNullOrEmpty(i)&&(i=o.split(e.SlashSymbol)[0]);var a=o.replace(i+e.SlashSymbol,"").split(e.SlashSymbol)[0];t.Add(o,this.ConvertGObjectToFairyUIElement(n,i,a,o))}},e.ParseGObjChildrenToDic=function(t,n,o,i,a){if(null!=o)for(var r,s=void 0,l=void 0,u=void 0,c=0,h=o.length;h>c;c++)if(u=o[c],null!=u&&(r=u.name,null!=n.asCom&&(l=n.asCom.getChild(r),s=StringIsNullOrEmpty(i)?r:i+e.SlashSymbol+r,null!=l)))if(null==u.packageItem)this.AddToElementDic(t,l,s);else switch(u.packageItem.type){case fairygui.PackageItemType.Component:var p=!0;p&&this.AddToElementDic(t,l,s,a),this.ParseGObjChildrenToDic(t,l,u.asCom._children,s,a);break;case fairygui.PackageItemType.Swf:case fairygui.PackageItemType.Sound:case fairygui.PackageItemType.Misc:case fairygui.PackageItemType.Font:case fairygui.PackageItemType.Atlas:Debug.Log("<<FairyUIManager>> 尚未加入處理的物件("+fairygui.PackageItemType[u.packageItem.type]+") : "+s);break;case fairygui.PackageItemType.Image:case fairygui.PackageItemType.MovieClip:this.AddToElementDic(t,l,s,a);break;default:Debug.LogError("<<FairyUIManager>> 尚未加入處理的物件("+fairygui.PackageItemType[u.packageItem.type]+") : "+s)}},e.ManualAddToElementDic=function(e,t){StringIsNullOrEmpty(e)||null==t||this.AddToElementDic(this.ElementsDic,t,e)},e.ConvertGObjectToFairyUIElement=function(e,t,n,o){return IsNullOrUndefined(e)?null:new FairyUIElement(e,t,n,o)},e.IsParsed=function(e){return this.RootPackageResourceDic.ContainsValue(e)},e.GetPackageName=function(t){if(this.RootPackageResourceDic.ContainsValue(t)){var n=this.RootPackageResourceDic.GetKeyByValue(t);return n.split(e.SlashSymbol)[0]}return Debug.LogError("<<FairyUIManager>> 找不到PackageName，可能還沒做註冊動作 (FairyUIManager.parsePackageResource) : "+t),""},e.GetGObj=function(e,t,n,o){void 0===t&&(t=""),void 0===n&&(n=!0),void 0===o&&(o=!1);var i=this.GetEObj(e,t,n,o);return null!=i?i.GObj:null},e.GetEObj=function(e,t,n,o){if(void 0===t&&(t=""),void 0===n&&(n=!0),void 0===o&&(o=!1),IsNullOrUndefined(e))return Debug.LogError("<<FairyUIManager>> uiRootObj = Null or Undefined"),null;if(this.RootPackageResourceDic.ContainsValue(e)){var i=this.RootPackageResourceDic.GetKeyByValue(e);return this.GetEObjByPackageResource(i,t,n,o)}return Debug.Log("<<FairyUIManager>> 找不到PackageResource，可能還沒做註冊動作 (FairyUIManager.parsePackageResource) : "+e.name+" | "+t),null},e.GetEObjByPackageResource=function(t,n,o,i){void 0===n&&(n=""),void 0===o&&(o=!0),void 0===i&&(i=!1);var a=StringIsNullOrEmpty(n)?t:t+e.SlashSymbol+n;if(this.ElementsDic.ContainsKey(a))return this.ElementsDic.GetValueByKey(a);for(var r="",s=this.ElementsDic.Keys,l=0,u=s.length;u>l;l++){r=s[l];var c=r.split(e.SlashSymbol)[0],h=r.split(e.SlashSymbol)[1];if(r=r.replace(c+e.SlashSymbol+h+e.SlashSymbol,""),r==n)return this.ElementsDic.GetValueByIndex(l);if(i&&r.indexOf(n)>=0)return Debug.Log("[key = "+r+"] [hierarchyFullNameOrObjName = "+n+"]"),Debug.LogWarning("<<FairyUIManager>> 找不到元件(啟動模糊搜尋): "+a+" ? search fullPath = "+s[l]),this.ElementsDic.GetValueByIndex(l)}return o&&Debug.Log("<<FairyUIManager>> 找不到元件: "+a),null},e.GetEObjBlind=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t=!0),void 0===n&&(n=!1);for(var o=null,i=this.RootPackageResourceDic.Values,a=0,r=i.length;r>a;a++)if(o=this.GetEObj(i[a],e,t,n),null!=o)return o;return Debug.Log("<<FairyUIManager>> 找不到元件: "+e),o},e.SetSpriteName=function(e,t,n,o,i){void 0===o&&(o=!0),void 0===i&&(i=!1);var a=this.GetEObj(t,n,o,i);return null!=a&&(a.SpriteName=e),a},e.SetDifferentSpriteName=function(e,t,n,o,i,a){void 0===i&&(i=!0),void 0===a&&(a=!1);var r=this.GetEObj(n,o,i,a);return null!=r&&this.SetEObjLoaderUrl(r,e,t),r},e.SetEObjLoaderUrl=function(e,t,n){null!=e&&this.SetGObjLoaderUrl(e.GObj,t,n)},e.SetGObjLoaderUrl=function(e,t,n){if(null!=e){this.AddPackage(t);var o="ui://"+t+"/"+n;null!=e.asLoader?e.asLoader.url=o:Debug.LogErrorWithFlag("Set GObjLoaderUrl失敗 : "+e.name+" 無法asLoader")}},e.SetText=function(e,t,n,o,i){void 0===o&&(o=!0),void 0===i&&(i=!1);var a=this.GetEObj(t,n,o,i);return null!=a?(a.Text=e,a):null},e.SetTextAndFitSizeWithFontSize=function(e,t,n,o,i){return this.SetTextObjTextAndFitSizeWithFontSize(this.GetEObj(t,n),e,o,i)},e.SetTextObjTextAndFitSizeWithFontSize=function(e,t,n,o){return null!=e&&(e.Text=t,this.SetTextFieldAutoSize(e.GText,n,o)),e},e.GetButtonObj=function(e,t,n,o,i,a){void 0===n&&(n=null),void 0===o&&(o=!1),void 0===i&&(i=!0),void 0===a&&(a=!1);var r=this.GetEObj(e,t,i,a);return null!=r?(null!=n&&r.RegisterClickEvent(n),o?r.FireClick():r.GButton):null},e.AddEventListener=function(e,t,n,o,i){if(void 0===o&&(o=null),void 0===i&&(i=!1),null==n)Debug.LogError("Add「"+t+"」EventListener失敗  : listener Function = null");else if(null!=e){i&&this.RemoveAllEventListener(e,t),this.Listeners.ContainsKey(t)||this.Listeners.Add(t,[]);var a=this.Listeners[t];a.push(new FairyListenerFormat(n,o)),e.addEventListener(t,n,o)}else Debug.LogError("Add「"+t+"」EventListener失敗 : GObj = null")},e.RemoveEventListener=function(e,t,n,o){void 0===o&&(o=null),null==n?Debug.LogError("Remove「"+t+"」EventListener失敗  : listener Function = null"):null!=e?e.removeEventListener(t,n,o):Debug.LogError("Remove「"+t+"」EventListener失敗 : GObj = null")},e.RemoveAllEventListener=function(e,t){if(this.Listeners.ContainsKey(t))for(var n=this.Listeners[t],o=n.length;o>0;o--)null!=n[o]&&e.removeEventListener(t,n[o].Listener,n[o].ThisObj),n[o]=null,n.splice(o,1)},e.SetupEObjPaneOnScrollNotTriggerClickEventFlag=function(e){var t=this,n=e.hashCode;if(!this.ScrollPaneFlagDic.ContainsKey(n)&&null!=e){var o=e.ScrollPane;null!=o&&(this.ScrollPaneFlagDic.Add(n,!0),o.addEventListener(fairygui.ScrollPane.SCROLL,function(){t.ScrollPaneFlagDic[n]=!1},this),o.addEventListener(fairygui.ScrollPane.SCROLL_END,function(){t.ScrollPaneFlagDic[n]=!0},this),Time.DelayOneFrameAction(function(){t.ScrollPaneFlagDic[n]=!0}))}},e.IsEObjAbleToTriggerClickEvent=function(e){var t=e.hashCode;return this.ScrollPaneFlagDic[t]},e.StopAllPlayingAniObjs=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0);for(var n=0,o=this.PlayedAniObjs.length;o>n;n++)null!=this.PlayedAniObjs[n]&&this.PlayedAniObjs[n].StopPlayingAni(e,t);return this.PlayedAniObjs},e.AddToPlayedAniObjs=function(e){return null!=e&&this.PlayedAniObjs.indexOf(e)<0&&this.PlayedAniObjs.push(e),e},e.GetAniObj=function(e,t,n,o,i){void 0===o&&(o=!0),void 0===i&&(i=!1);var a=this.GetEObj(e,t,o,i);return null!=this.AddToPlayedAniObjs(a)?a.GetAniObj(n):null},e.PlayAniObj=function(e,t,n,o,i,a,r,s,l,u){return void 0===o&&(o=1),void 0===i&&(i=!0),void 0===a&&(a=!0),void 0===r&&(r=null),void 0===s&&(s=!0),void 0===l&&(l=!0),void 0===u&&(u=!1),this.PlayEObjAni(this.GetEObj(e,t,l,u),n,o,i,a,r,s)},e.PlayEObjAni=function(e,t,n,o,i,a,r){if(void 0===n&&(n=1),void 0===o&&(o=!0),void 0===i&&(i=!0),void 0===a&&(a=null),void 0===r&&(r=!0),null!=this.AddToPlayedAniObjs(e)){var s=e.PlayAni(t,function(){i&&e.SetActive(!1),null!=a&&a()},n,r);return null!=s&&o&&e.SetActive(!0),e}return null},e.StopAniObj=function(e,t,n,o,i,a,r){return void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===i&&(i=!0),void 0===a&&(a=!0),void 0===r&&(r=!1),this.StopEObjAni(this.GetEObj(e,t,a,r),n,o,i)},e.StopEObjAni=function(e,t,n,o){return void 0===t&&(t=!0),void 0===n&&(n=!0),void 0===o&&(o=!0),null!=this.AddToPlayedAniObjs(e)?(e.StopPlayingAni(t,n),o&&e.SetActive(!1),e):null},e.GetDynamicPool=function(e,t){return FairyPoolManager.GetPool(this.GetPoolKey(e,t))},e.GetDynamicPoolByPackageName=function(e,t){return FairyPoolManager.GetPool(this.GetPoolKeyByPackageName(e,t))},e.RecycleDynamicObjToPool=function(e,t,n,o){if(void 0===o&&(o=""),StringIsNullOrEmpty(t)||IsNullOrUndefined(n))Debug.LogWarning("Recycle DynamicObj To Pool Error : resourceName = NullOrEmpty or recycleTarget = NullOrUndefined");else{var i=this.GetDynamicPool(e,t);null!=i&&i.RecycleObj(n,o)}},e.RecycleDynamicObjToPoolByPackageName=function(e,t,n,o){if(void 0===o&&(o=""),StringIsNullOrEmpty(t)||IsNullOrUndefined(n))Debug.LogWarning("Recycle DynamicObj To Pool Error : resourceName = NullOrEmpty or recycleTarget = NullOrUndefined");else{var i=this.GetDynamicPoolByPackageName(e,t);null!=i&&i.RecycleObj(n,o)}},e.RecyclePool=function(e,t,n){if(void 0===n&&(n=""),StringIsNullOrEmpty(t))Debug.LogWarning("Recycle Pool Error : resourceName = NullOrEmpty");else{var o=this.GetDynamicPool(e,t);null!=o&&o.RecycleAllObjs(n)}},e.RecyclePoolByPackageName=function(e,t,n){if(void 0===n&&(n=""),StringIsNullOrEmpty(t))Debug.LogWarning("Recycle Pool Error : resourceName = NullOrEmpty");else{var o=this.GetDynamicPoolByPackageName(e,t);null!=o&&o.RecycleAllObjs(n)}},e.GetDynamicGObj=function(e,t,n){void 0===n&&(n="");var o=this.GetDynamicEObj(e,t,n);return null!=o?o.GObj:null},e.GetDynamicEObj=function(e,t,n){void 0===n&&(n="");var o=this.GetPackageName(e);return this.GetDynamicEObjByPackageName(o,t,n)},e.GetEObjCorScript=function(e,t,n,o){void 0===n&&(n=e.hashCode),void 0===o&&(o=null);var i=null;return this.CorScriptDic.ContainsKey(n)?i=this.CorScriptDic[n]:(null!=o&&o(),this.CorScriptDic.Add(n,new t),i=this.CorScriptDic[n]),i},e.ClearEObjCorScript=function(e,t){if(void 0===t&&(t=e.hashCode),this.CorScriptDic.ContainsKey(t)){var n=this.CorScriptDic.GetValueByKey(t);try{null!=n&&n.Clear()}catch(o){}n=null,this.CorScriptDic.Remove(t)}},e.GetDynamicGObjByPackageName=function(e,t,n){void 0===n&&(n="");var o=this.GetDynamicEObjByPackageName(e,t,n);return null!=o?o.GObj:null},e.GetDynamicEObjByPackageName=function(e,t,n){void 0===n&&(n="");var o=this.GetPoolKeyByPackageName(e,t);return FairyPoolManager.SetupPool(o,e,t),FairyPoolManager.GetObj(o,n)},e.GetPoolKey=function(e,t){return this.GetPoolKeyByPackageName(this.GetPackageName(e),t)},e.GetPoolKeyByPackageName=function(t,n){return this.AddPackage(t),t+e.SlashSymbol+n},e.SetDisplayObjToParent=function(e,t,n){this.SetDisplayObjToGObjParent(e,this.GetGObj(t,n))},e.SetDisplayObjToEObjParent=function(e,t){this.SetDisplayObjToGObjParent(e,t.GObj)},e.SetDisplayObjToGObjParent=function(e,t){if(null!=t){var n=t.displayObject;null!=n&&n.addChild(e)}else Debug.LogWarning("Add ChildToGObjParent Parent = null")},e.SetEObjParentToEObj=function(e,t){null!=e&&null!=t&&this.SetGObjParentToGObj(e.GObj,t.GObj)},e.SetGObjParentToGObj=function(e,t){null!=e&&null!=t&&(null!=t.asCom?t.asCom.addChild(e):Debug.LogError("Set GObjParentToGObj失敗 : "+t.name+" 物件沒辦法asCom執行addChild功能"))},e.CreateGObjToSceneByPackageName=function(e,t,n){void 0===n&&(n=!0);var o=null,i=e+":"+t;return n&&(o=this.SceneObjDic.GetValueByKey(i),null!=o)?o:(o=this.CreateGObjByPackageName(e,t),null!=o&&(fairygui.GRoot.inst.addChild(o),this.ParsePackageResource(o,e,t)),n&&this.SceneObjDic.Update(i,o),o)},e.CreateEObjToSceneByPackageName=function(t,n,o){void 0===o&&(o=!0);var i=this.CreateGObjToSceneByPackageName(t,n,o);return this.ConvertGObjectToFairyUIElement(i,t,n,t+e.SlashSymbol)},e.CreateEObjFromResource=function(e,t){return this.CreateEObjFromResourceByPackageName(this.GetPackageName(e),t)},e.CreateEObjFromResourceByPackageName=function(t,n){var o=this.CreateGObjByPackageName(t,n);return null!=o?this.ConvertGObjectToFairyUIElement(o,t,n,t+e.SlashSymbol):null},e.AddPackage=function(e){this.PackageNameFlag.indexOf(e)<0&&(this.PackageNameFlag.push(e),fairygui.UIPackage.addPackage(e))},e.CreateGObjByPackageName=function(e,t){if(!StringIsNullOrEmpty(e)&&!StringIsNullOrEmpty(t)){this.AddPackage(e);var n=null;try{n=fairygui.UIPackage.createObject(e,t)}catch(o){}if(null!=n)return n;Debug.LogError("<<FairyUIManager>> 創建物件失敗，在「"+e+"」中，找不到名為「"+t+"」的資源，請確認名稱，或fairygui編輯器中，是否有設置該物件為導出項目")}return null},e.MoveEObjToXPos=function(e,t,n,o,i,a,r){void 0===o&&(o=CurveMethod.EaseInOut),void 0===i&&(i=null),void 0===a&&(a=0),void 0===r&&(r=!0),null!=e&&this.MoveGObj(e.GObj,t,e.GObj.x,e.GObj.y,n,e.GObj.y,o,i,a,r)},e.MoveEObjToYPos=function(e,t,n,o,i,a,r){void 0===o&&(o=CurveMethod.EaseInOut),void 0===i&&(i=null),void 0===a&&(a=0),void 0===r&&(r=!0),null!=e&&this.MoveGObj(e.GObj,t,e.GObj.x,e.GObj.y,e.GObj.x,n,o,i,a,r)},e.MoveEObjToPos=function(e,t,n,o,i,a,r,s){void 0===i&&(i=CurveMethod.EaseInOut),void 0===a&&(a=null),void 0===r&&(r=0),void 0===s&&(s=!0),null!=e&&this.MoveGObj(e.GObj,t,e.GObj.x,e.GObj.y,n,o,i,a,r,s)},e.MoveGObjToXPos=function(e,t,n,o,i,a,r){void 0===o&&(o=CurveMethod.EaseInOut),void 0===i&&(i=null),void 0===a&&(a=0),void 0===r&&(r=!0),null!=e&&this.MoveGObj(e,t,e.x,e.y,n,e.y,o,i,a,r)},e.MoveGObjToYPos=function(e,t,n,o,i,a,r){void 0===o&&(o=CurveMethod.EaseInOut),void 0===i&&(i=null),void 0===a&&(a=0),void 0===r&&(r=!0),null!=e&&this.MoveGObj(e,t,e.x,e.y,e.x,n,o,i,a,r)},e.MoveGObjToPos=function(e,t,n,o,i,a,r,s){void 0===i&&(i=CurveMethod.EaseInOut),void 0===a&&(a=null),void 0===r&&(r=0),void 0===s&&(s=!0),null!=e&&this.MoveGObj(e,t,e.x,e.y,n,o,i,a,r,s)},e.MoveEObjX=function(e,t,n,o,i,a,r,s){void 0===i&&(i=CurveMethod.EaseInOut),void 0===a&&(a=null),void 0===r&&(r=0),void 0===s&&(s=!0),null!=e&&this.MoveGObj(e.GObj,t,n,e.y,o,e.y,i,a,r,s)},e.MoveEObjY=function(e,t,n,o,i,a,r,s){void 0===i&&(i=CurveMethod.EaseInOut),void 0===a&&(a=null),void 0===r&&(r=0),void 0===s&&(s=!0),null!=e&&this.MoveGObj(e.GObj,t,e.x,n,e.x,o,i,a,r,s)},e.MoveEObj=function(e,t,n,o,i,a,r,s,l,u){void 0===r&&(r=CurveMethod.EaseInOut),void 0===s&&(s=null),void 0===l&&(l=0),void 0===u&&(u=!0),null!=e&&this.MoveGObj(e.GObj,t,n,o,i,a,r,s,l,u)},e.MoveGObjX=function(e,t,n,o,i,a,r,s){void 0===i&&(i=CurveMethod.EaseInOut),void 0===a&&(a=null),void 0===r&&(r=0),void 0===s&&(s=!0),null!=e&&this.MoveGObj(e,t,n,e.y,o,e.y,i,a,r,s)},e.MoveGObjY=function(e,t,n,o,i,a,r,s){void 0===i&&(i=CurveMethod.EaseInOut),void 0===a&&(a=null),void 0===r&&(r=0),void 0===s&&(s=!0),null!=e&&this.MoveGObj(e,t,e.x,n,e.x,o,i,a,r,s)},e.MoveGObj=function(e,t,n,o,i,a,r,s,l,u){var c=this;if(void 0===r&&(r=CurveMethod.EaseInOut),void 0===s&&(s=null),void 0===l&&(l=0),void 0===u&&(u=!0),0>=l)this.ExeMoveGObj(e,t,n,o,i,a,r,s,u);else{if(null==e)return;this.StopMoveGObj(e);var h=Time.DelayAction(l,function(){c.ExeMoveGObj(e,t,n,o,i,a,r,s,u)});this.MoveList.Add(e,[h])}},e.ExeMoveGObj=function(e,t,n,o,i,a,r,s,l){var u=this;if(void 0===r&&(r=CurveMethod.EaseInOut),void 0===s&&(s=null),void 0===l&&(l=!0),null!=e)if(this.StopMoveGObj(e),0>=t||n===i&&o===a)e.x=i,e.y=a,null!=s&&s();else{var c=!1,h=!1,p="";p=LerpMethod.LerpValue(t,n,i,r,function(t){e.x=t},function(){c=!0,c&&h&&(u.StopMoveGObj(e),null!=s&&s())},p,l);var d="";d=LerpMethod.LerpValue(t,o,a,r,function(t){e.y=t},function(){h=!0,c&&h&&(u.StopMoveGObj(e),null!=s&&s())},d,l),this.MoveList.Add(e,[p,d])}},e.RotateEObjToAngle=function(e,t,n,o,i,a,r){void 0===o&&(o=CurveMethod.EaseInOut),void 0===i&&(i=!0),void 0===a&&(a=null),void 0===r&&(r=0),null!=e&&this.RotateGObj(e.GObj,t,e.GObj.rotation,n,o,i,a,r)},e.RevertRotateEObjToAngle=function(e,t,n,o,i,a,r){void 0===o&&(o=CurveMethod.EaseInOut),void 0===i&&(i=!0),void 0===a&&(a=null),void 0===r&&(r=0),null!=e&&this.RevertRotateGObj(e.GObj,t,e.GObj.rotation,n,o,i,a,r)},e.RotateGObjToAngle=function(e,t,n,o,i,a,r){void 0===o&&(o=CurveMethod.EaseInOut),void 0===i&&(i=!0),void 0===a&&(a=null),void 0===r&&(r=0),null!=e&&this.RotateGObj(e,t,e.rotation,n,o,i,a,r)},e.RevertRotateGObjToAngle=function(e,t,n,o,i,a,r){void 0===o&&(o=CurveMethod.EaseInOut),void 0===i&&(i=!0),void 0===a&&(a=null),void 0===r&&(r=0),null!=e&&this.RevertRotateGObj(e,t,e.rotation,n,o,i,a,r)},e.RotateEObj=function(e,t,n,o,i,a,r,s){void 0===i&&(i=CurveMethod.EaseInOut),void 0===a&&(a=!0),void 0===r&&(r=null),void 0===s&&(s=0),null!=e&&this.RotateGObj(e.GObj,t,n,o,i,a,r,s)},e.RevertRotateEObj=function(e,t,n,o,i,a,r,s){void 0===i&&(i=CurveMethod.EaseInOut),void 0===a&&(a=!0),void 0===r&&(r=null),void 0===s&&(s=0),null!=e&&this.RevertRotateGObj(e.GObj,t,n,o,i,a,r,s)},e.RotateGObj=function(e,t,n,o,i,a,r,s){var l=this;if(void 0===i&&(i=CurveMethod.EaseInOut),void 0===a&&(a=!0),void 0===r&&(r=null),void 0===s&&(s=0),0>=s)this.ExeRotateGObj(e,t,n,o,i,a,r);else{if(null==e)return;this.StopRotateGObj(e);var u=Time.DelayAction(s,function(){l.ExeRotateGObj(e,t,n,o,i,a,r)});this.RotateList.Add(e,[u])}},e.RevertRotateGObj=function(e,t,n,o,i,a,r,s){var l=this;if(void 0===i&&(i=CurveMethod.EaseInOut),void 0===a&&(a=!0),void 0===r&&(r=null),void 0===s&&(s=0),0>=s)this.ExeRotateGObj(e,t,n,o,i,a,r,!0);else{if(null==e)return;this.StopRotateGObj(e);var u=Time.DelayAction(s,function(){l.ExeRotateGObj(e,t,n,o,i,a,r,!0)});this.RotateList.Add(e,[u])}},e.ExeRotateGObj=function(e,t,n,o,i,a,r,s){var l=this;if(void 0===i&&(i=CurveMethod.EaseInOut),void 0===a&&(a=!0),void 0===r&&(r=null),void 0===s&&(s=!1),null!=e){if(this.StopRotateGObj(e),s){var u=Math.floor(o/360),c=o%360;o=(c-360)%360+-360*(u-1)}if(0>=t||n===o)a?(e.rotation=o%360,e.rotation<0&&(e.rotation+=360)):e.rotation=o,null!=r&&r();else{var h=LerpMethod.LerpValue(t,n,o,i,function(t){a?(e.rotation=t%360,e.rotation<0&&(e.rotation+=360)):e.rotation=t},function(){l.StopRotateGObj(e),null!=r&&r()});this.RotateList.Add(e,[h])}}},e.FadeOutEObj=function(e,t,n,o,i){void 0===n&&(n=CurveMethod.EaseInOut),void 0===o&&(o=null),void 0===i&&(i=0),null!=e&&this.FadeGObj(e.GObj,t,e.GObj.alpha,0,n,o,i)},e.FadeInEObj=function(e,t,n,o,i){void 0===n&&(n=CurveMethod.EaseInOut),void 0===o&&(o=null),void 0===i&&(i=0),null!=e&&this.FadeGObj(e.GObj,t,e.GObj.alpha,1,n,o,i)},e.FadeEObjToAlpha=function(e,t,n,o,i,a){void 0===o&&(o=CurveMethod.EaseInOut),void 0===i&&(i=null),void 0===a&&(a=0),null!=e&&this.FadeGObj(e.GObj,t,e.GObj.alpha,n,o,i,a)},e.FadeGObjToAlpha=function(e,t,n,o,i,a){void 0===o&&(o=CurveMethod.EaseInOut),void 0===i&&(i=null),void 0===a&&(a=0),null!=e&&this.FadeGObj(e,t,e.alpha,n,o,i,a)},e.FadeEObj=function(e,t,n,o,i,a,r){void 0===i&&(i=CurveMethod.EaseInOut),void 0===a&&(a=null),void 0===r&&(r=0),null!=e&&this.FadeGObj(e.GObj,t,n,o,i,a,r)},e.FadeGObj=function(e,t,n,o,i,a,r){var s=this;if(void 0===i&&(i=CurveMethod.EaseInOut),void 0===a&&(a=null),void 0===r&&(r=0),0>=r)this.ExeFadeGObj(e,t,n,o,i,a);else{if(null==e)return;this.StopFadeGObj(e);var l=Time.DelayAction(r,function(){s.ExeFadeGObj(e,t,n,o,i,a)});this.FadeList.Add(e,[l])}},e.ExeFadeGObj=function(e,t,n,o,i,a){var r=this;if(void 0===i&&(i=CurveMethod.EaseInOut),void 0===a&&(a=null),null!=e)if(this.StopFadeGObj(e),0>=t||n===o)e.alpha=o,null!=a&&a();else{var s=LerpMethod.LerpValue(t,n,o,i,function(t){e.alpha=t},function(){r.StopFadeGObj(e),null!=a&&a()});this.FadeList.Add(e,[s])}},e.StopMoveGObj=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1),this.StopTweenGObj(e,this.MoveList,t,n)},e.StopMoveEObj=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1),this.StopTweenGObj(e.GObj,this.MoveList,t,n)},e.StopRotateGObj=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1),this.StopTweenGObj(e,this.RotateList,t,n)},e.StopRotateEObj=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1),this.StopTweenGObj(e.GObj,this.RotateList,t,n)},e.StopFadeGObj=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1),this.StopTweenGObj(e,this.FadeList,t,n)},e.StopFadeEObj=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1),this.StopTweenGObj(e.GObj,this.FadeList,t,n)},e.StopAllTweenGObjs=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this.StopAllMoveGObjs(e,t),this.StopAllRotateGObjs(e,t),this.StopAllFadeGObjs(e,t)},e.StopAllMoveGObjs=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this.StopAllTweenList(this.MoveList,e,t)},e.StopAllRotateGObjs=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this.StopAllTweenList(this.RotateList,e,t)},e.StopAllFadeGObjs=function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this.StopAllTweenList(this.FadeList,e,t)},e.StopAllTweenList=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);for(var o=e.Keys,i=0,a=o.length;a>i;i++)this.StopTweenGObj(o[0],e,t,n)},e.StopTweenGObj=function(e,t,n,o){if(void 0===n&&(n=!1),void 0===o&&(o=!1),null!=e&&t.ContainsKey(e)){var i=t.GetValueByKey(e);if(null!=i)for(var a=0,r=i.length;r>a;a++)StringIsNullOrEmpty(i[0])||LerpMethod.Stop(i[0],n,o),i[0]=null,Method.ArrayRemoveItemAt(i,0);
i=null,t.Remove(e)}},e.SetObjActive=function(e,t,n){void 0===n&&(n="");var o=this.GetEObj(t,n);null!=o&&o.SetActive(e)},e.SetEObjActive=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(null!=t)for(var o=0,i=t.length;i>o;o++)null!=t[o]&&t[o].SetActive(e)},e.SetEObjsActive=function(e,t){if(null!=t)for(var n=0,o=t.length;o>n;n++)null!=t[n]&&t[n].SetActive(e)},e.SetGObjActive=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(null!=t)for(var o=0,i=t.length;i>o;o++)null!=t[o]&&(t[o].visible=e)},e.SetGObjsActive=function(e,t){if(null!=t)for(var n=0,o=t.length;o>n;n++)null!=t[n]&&(t[n].visible=e)},e.SetActiveETargetAndCloseOthers=function(e,t){if(null!=t)for(var n=0,o=t.length;o>n;n++)null!=t[n]&&t[n]!=e&&t[n].SetActive(!1);null!=e&&e.SetActive(!0)},e.SetActiveTargetAndCloseOthers=function(e,t){if(null!=t)for(var n=0,o=t.length;o>n;n++)null!=t[n]&&t[n]!=e&&(t[n].visible=!1);null!=e&&(e.visible=!0)},e.SetTextFieldAutoSize=function(e,t,n,o){if(void 0===o&&(o=!0),isNaN(t)||isNaN(n))return void Debug.LogError("<<FairyUIManager>> Set TextFieldAutoSize失敗，maxWidth或originFontSize不是數字"+t+" / "+n);if(0>=n)return void Debug.LogError("<<FairyUIManager>> Set TextFieldAutoSize失敗 : originSize不得小於等於0 -> "+n);if(0>=t)return void Debug.LogError("<<FairyUIManager>> Set TextFieldAutoSize失敗 : maxWidth不得小於等於0 -> "+t);for(o&&(e.autoSize=fairygui.AutoSizeType.Both),e.fontSize=n;e.textWidth>t;)if(e.fontSize--,e.fontSize<=1){Debug.LogWarning("<<FairyUIManager>> Set TextFieldAutoSize : 文字大小已減至最低值 : "+e.name);break}},e.SetTextFieldAutoSizeByHeight=function(e,t,n,o){if(void 0===o&&(o=!0),isNaN(t)||isNaN(n))return void Debug.LogError("<<FairyUIManager>> Set TextFieldAutoSize失敗，maxHeight或originFontSize不是數字"+t+" / "+n);if(0>=n)return void Debug.LogError("<<FairyUIManager>> Set TextFieldAutoSize失敗 : originSize不得小於等於0 -> "+n);if(0>=t)return void Debug.LogError("<<FairyUIManager>> Set TextFieldAutoSize失敗 : maxHeight不得小於等於0 -> "+t);for(o&&(e.autoSize=fairygui.AutoSizeType.Both),e.fontSize=n;e.height>t;)if(e.fontSize--,e.fontSize<=1){Debug.LogWarning("<<FairyUIManager>> Set TextFieldAutoSize : 文字大小已減至最低值 : "+e.name);break}},e.HandleDataEventAction="HandleFairyUIElementData",e.HandleClickEventAction="HandleClickFairyUIElement",e.HandlePressEventAction="HandlePressFairyUIElement",e.HandleMouseHoverEventAction="HandleMouseHoverFairyUIElement",e.SlashSymbol="/",e.RootPackageResourceDic=new Dictionary([]),e.ElementsDic=new Dictionary([]),e.PackageNameFlag=[],e.GroupDic=new Dictionary([]),e.Listeners=new Dictionary([]),e.ScrollPaneFlagDic=new Dictionary([]),e.PlayedAniObjs=[],e.CorScriptDic=new Dictionary([]),e.SceneObjDic=new Dictionary([]),e.MoveList=new Dictionary([]),e.RotateList=new Dictionary([]),e.FadeList=new Dictionary([]),e}();__reflect(FUIManager.prototype,"FUIManager");var StateBase=function(){function e(){}return e.prototype.StateReadyToBegin=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.StateBegin=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.StateEnd=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.StateClose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.Init=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.Clear=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.UpdateUI=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(StateBase.prototype,"StateBase",["IState","IAppUIFunctionBase","IAppFunctionBase"]);var StateListData=function(){function e(){this.Index=0,this.StateList=[],this.FunctionList=[]}return e.prototype.AddIndex=function(){this.Index++},e.prototype.ResetIndex=function(){this.Index=0},e.prototype.SetState=function(e,t){this.StateList.push(e),this.FunctionList.push(t)},Object.defineProperty(e.prototype,"IsEmpty",{get:function(){return 0==this.StateList.length&&0==this.FunctionList.length},enumerable:!0,configurable:!0}),e.prototype.GetNextFunction=function(){return this.GetFunction(this.Index+1)},e.prototype.GetFunction=function(e){return void 0===e&&(e=this.Index),this.FunctionList.length>e?this.FunctionList[e]:null},e.prototype.GetNextState=function(){return this.GetState(this.Index+1)},e.prototype.GetState=function(e){return void 0===e&&(e=this.Index),this.StateList.length>e?this.StateList[e]:null},e}();__reflect(StateListData.prototype,"StateListData");var PhotonMsgBuilder=function(){function e(){this.Msgs=[]}return e.prototype.Add=function(t,n,o){var i=null;switch(o){case FieldType.Byte:i="#b"+n.toString();break;case FieldType.Short:i="#s"+n.toString();break;case FieldType.Int:i="#i"+n.toString();break;case FieldType.Float:i="#f"+n.toString();break;case FieldType.Long:i="#l"+n.toString();break;case FieldType.Array:var a=new e;return a.Add(19999,!0,FieldType.Boolean),a.Add(29999,n,FieldType.Object),void this.Msgs.push(t,a.Msgs)}null!=i?this.Msgs.push(t,i):this.Msgs.push(t,n)},e}();__reflect(PhotonMsgBuilder.prototype,"PhotonMsgBuilder");var WebView=function(e){function t(n,o,i,a,r,s,l,u){void 0===s&&(s=null),void 0===l&&(l=""),void 0===u&&(u=!1);var c=e.call(this)||this;return c.iFrame=null,c.ClickPanel=null,c.ResizeKey="",c.TempLock=!1,c.IsActive=!1,c._z=0,c._url="",c._x=0,c._y=0,c._w=0,c._h=0,AppUIBase.RegisterUI(c),u&&t.ClearAll(),c.Init(n,o,i,a,r,s,l),c}return __extends(t,e),Object.defineProperty(t.prototype,"UsePercent",{get:function(){return GlobalValue.IsMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsActive",{get:function(){for(var e=0,n=t.List.length;n>e;e++)if(!IsNullOrUndefined(t.List[e])&&t.List[e].IsActive)return!0;return!1},enumerable:!0,configurable:!0}),t.ClearAll=function(){for(var e=0,n=t.List.length;n>e;e++)IsNullOrUndefined(t.List[e])||(t.List[e].Clear(),t.List[e]=null);t.List.splice(0)},t.prototype.Init=function(e,n,o,i,a,r,s){var l=this;return void 0===r&&(r=null),void 0===s&&(s=""),this._url=e,this.OnFocusCallback=r,SendTool.Register(AppEvent[AppEvent.OnAppPause],this,function(){l.OnWebView(!1)}),this.iFrame=document.createElement("iframe"),this.iFrame.src=e,this.iFrame.style.position="fixed",this.iFrame.style.left="0px",this.iFrame.style.top="0px",this.iFrame.style.opacity="0",this.iFrame.frameBorder="0",this.iFrame.border="0",this.iFrame.style.transformOrigin="0% 0% 0px",this.iFrame.onload=function(){l.iFrame.style.opacity="1",l.IsActive=!0},this.CanvasElement=document.getElementById("EgretCanvas"),this.ParentElement=document.getElementById("Egret"),this.ParentElement.appendChild(this.iFrame),null!=this.OnFocusCallback&&(this.ClickPanel=document.createElement("div"),this.ClickPanel.style.position="fixed",this.ClickPanel.style.opacity="0",this.ClickPanel.style.display="block",this.ClickPanel.style.pointerEvents="auto",this.ClickPanel.onclick=function(){l.OnWebView(!0)},this.ClickPanel.ontouchstart=function(){l.OnWebView(!0)},this.ClickPanel.onmouseover=function(){l.OnWebView(!0)},document.onclick=function(){l.OnWebView(!1)},document.ontouchstart=function(){l.OnWebView(!1)},document.onmouseover=function(){l.OnWebView(!1)},this.ParentElement.appendChild(this.ClickPanel)),GlobalValue.OSType==OSType.iOS&&(this.FullScreen=document.querySelector(".mask")),t.List.push(this),this.iFrame.id=StringIsNullOrEmpty(s)?"WebView_"+t.List.indexOf(this):s,this.ZIndex=t.ParentElementZIndex,this.SetSize(n,o,i,a),this.ResizeKey=SendTool.Register(AppEvent[AppEvent.OnResize],this,this.OnResize),this.iFrame.id},t.prototype.OnWebView=function(e){var t=this;if(e)this.TempLock=!0,Time.DelayOneFrameAction(function(){t.TempLock=!1}),this.ClickPanel&&(this.ClickPanel.style.pointerEvents="none"),null!=this.OnFocusCallback&&this.OnFocusCallback();else{if(this.TempLock)return;this.ClickPanel&&(this.ClickPanel.style.pointerEvents="auto")}},t.prototype.SetActive=function(e,t){void 0===t&&(t=!0),this.IsActive=e,e?(this.iFrame.style.display="block",t&&(this.iFrame.src+=""),this.OnResize()):this.iFrame.style.display="none"},t.prototype.Clear=function(){AppUIBase.UnregisterUI(this),this.iFrame&&(this.SetActive(!1),this.ParentElement.removeChild(this.iFrame),SendTool.UnregisterByKey(AppEvent[AppEvent.OnResize],this.ResizeKey),t.List.splice(t.List.indexOf(this),1))},Object.defineProperty(t.prototype,"ZIndex",{get:function(){return this._z},set:function(e){this._z=e,this.iFrame.style.zIndex=this._z.toString(),this.ClickPanel&&(this.ClickPanel.style.zIndex=(this._z+1).toString())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Url",{get:function(){return this._url},set:function(e){this._url!=e&&(this._url=e,this.iFrame.src=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e,this.UsePercent?this.iFrame.style.left=(this._x/innerWidth*100).toFixed(2)+"%":this.iFrame.style.left=this._x+"px",this.ClickPanel&&(this.ClickPanel.style.left=this.iFrame.style.left)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e,this.iFrame.style.top=this._y+"px",this.ClickPanel&&(this.ClickPanel.style.top=this.iFrame.style.top)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Width",{get:function(){return this._w},set:function(e){this._w=e,this.UsePercent?this.iFrame.style.width=(this._w/innerWidth*100).toFixed(2)+"%":this.iFrame.style.width=this._w+"px",this.ClickPanel&&(this.ClickPanel.style.width=this.iFrame.style.width)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Height",{get:function(){return this._h},set:function(e){this._h=e,this.UsePercent?this.iFrame.style.height=(this._h/innerHeight*100).toFixed(2)+"%":this.iFrame.style.height=this._h+"px",this.ClickPanel&&(this.ClickPanel.style.height=this.iFrame.style.height)},enumerable:!0,configurable:!0}),t.prototype.SetSize=function(e,t,n,o){this.UIRectX=e,this.UIRectY=t,this.UIRectW=Math.abs(n),this.UIRectH=Math.abs(o),this.OnResize()},Object.defineProperty(t.prototype,"IsLandscapeTypePortrait",{get:function(){return innerWidth<=innerHeight&&!GlobalValue.AllowPortrait},enumerable:!0,configurable:!0}),t.prototype.OnResize=function(){if(!StringIsNullOrEmpty(this.Url)){if(this.UIRectW<=0||this.UIRectH<=0)return void Debug.LogError("WebView : uiWidth <= 0 or uiHeight <= 0");if(null!=this.iFrame)if(this.IsLandscapeTypePortrait){this.iFrame.style.transform=this.CanvasElement.style.transform;var e=this.UIRectW/GlobalValue.EgretElementWidth,t=this.UIRectH/GlobalValue.EgretElementHeight;this.Width=e*this.CanvasElement.clientWidth,this.Height=t*this.CanvasElement.clientHeight,this.x=-((this.UIRectY+this.UIScreenYOffset)/GlobalValue.EgretElementWidth)*this.CanvasElement.clientWidth+Method.ParseValueToNumber(this.CanvasElement.style.left.replace("px",""));var n=Method.ParseValueToNumber(this.CanvasElement.style.top.replace("px","")),o=innerHeight-2*n,i=this.UIRectX*o/GlobalValue.EgretElementWidth;this.y=n+i}else{this.iFrame.style.transform="";var a=AppUIBase.GetObjScreenRect(GlobalValue.EgretElementWidth,GlobalValue.EgretElementHeight,GlobalValue.FitWidthRatio,GlobalValue.FitHeightRatio,this.UIScreenYOffset);a.x*=a.w,a.y*=a.w,a.z*=a.w;var r=this.UIRectX*a.z,s=this.UIRectY*a.z;this.x=a.x+r,this.y=a.y+s,this.Width=this.UIRectW*a.z,this.Height=this.UIRectH*a.z}if(GlobalValue.OSType==OSType.iOS){null!=this.FullScreen&&(this.iFrame.style.pointerEvents="auto"===this.FullScreen.style.pointerEvents?"none":"auto");var l=document.querySelector(".egret-player");null!=l&&(l.style.transform="",l.style.position="absolute",Time.DelayOneFrameAction(function(){l.style.position="fixed"}))}}},t.ParentElementZIndex=4,t.List=[],t}(AppResizeUIBase);__reflect(WebView.prototype,"WebView");var LoadingView=function(){function e(){this.Views=[],this.IsSkipPanelActive=!1,this.IsActive=!1}return e.prototype.Init=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];SendTool.Register("OnClickSkipBtn",this,this.OnClickSkipBtn);for(var n=0,o=e.length;o>n;n++){var i=new LoadingSingleView;i.Init(e[n]),this.Views.push(i)}},e.prototype.Clear=function(){for(var e=0,t=this.Views.length;t>e;e++)this.Views[e]&&this.Views[e].Clear()},e.prototype.SetStyle=function(e){for(var t=0,n=this.Views.length;n>t;t++)this.Views[t]&&this.Views[t].SetStyle(e)},e.prototype.SetProgressTextActive=function(e){for(var t=0,n=this.Views.length;n>t;t++)this.Views[t]&&this.Views[t].SetProgressTextActive(e)},e.prototype.SetupBGImage=function(e,t){this.Views[e]&&this.Views[e].SetupBGImage(t)},e.prototype.SetText=function(e){for(var t=0,n=this.Views.length;n>t;t++)this.Views[t]&&this.Views[t].SetText(e)},e.prototype.onProgress=function(e,t){for(var n=0,o=this.Views.length;o>n;n++)this.Views[n]&&this.Views[n].onProgress(e,t)},e.prototype.SetSkipBtnActive=function(e){this.IsSkipPanelActive=e;for(var t=0,n=this.Views.length;n>t;t++)this.Views[t]&&this.Views[t].SetSkipBtnActive(e)},e.prototype.SetActive=function(e,t){void 0===t&&(t=-1),this.IsActive=e;for(var n=0,o=this.Views.length;o>n;n++)this.Views[n]&&(e?t>=0?this.Views[n].SetActive(t==n):this.Views[n].SetActive(e):this.Views[n].SetActive(!1))},e.prototype.OnClickSkipBtn=function(e){this.SetActive(!1)},e.prototype.UpdateUI=function(){for(var e=0,t=this.Views.length;t>e;e++)this.Views[e]&&this.Views[e].UpdateUI()},e}();__reflect(LoadingView.prototype,"LoadingView",["LoadingReporter","RES.PromiseTaskReporter","IAppUIFunctionBase","IAppFunctionBase"]);var LoadingSingleView=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.FrontText="",t.ProgressText="",t.EnableProgress=!1,t}return __extends(t,e),t.prototype.Init=function(t){var n=document.getElementById("PreloadIcon");null!=n&&n.parentNode.removeChild(n),e.prototype.Init.call(this,t)&&(this.Depth=990,this.BG=FUIManager.GetEObj(this.RootObj,"Image"),this.LoadingBarObj=FUIManager.GetEObj(this.RootObj,"LoadingBar"),this.SkipBtn=FUIManager.GetEObj(this.RootObj,"Button_Skip"),this.TextObjs=FUIManager.GetEObj(this.RootObj,"TextObjs"),this.TextObj=FUIManager.GetEObj(this.RootObj,"Text_Loading"),this.SetupBGImage("LoadingBG_jpg"),this.onProgress(0,100))},t.prototype.SetupBGImage=function(e){this.BG&&(this.BG.Icon=e)},t.prototype.SetStyle=function(e){this.RootEObj.PlayAni("Style_"+e)},t.prototype.SetProgressTextActive=function(e){this.EnableProgress=e},t.prototype.SetText=function(e){this.FrontText=e,this.ProgressText="",this.UpdateUI()},t.prototype.onProgress=function(e,t){var n=e/t*100;this.EnableProgress&&(this.ProgressText=" "+n.toFixed(2)+"%"),this.LoadingBarObj&&(this.LoadingBarObj.GSlider.value=n),this.UpdateUI()},t.prototype.SetSkipBtnActive=function(e){this.SkipBtn&&this.SkipBtn.SetActive(e),this.TextObjs&&this.TextObjs.SetActive(!e)},t.prototype.SetActive=function(t,n){void 0===n&&(n=!0),e.prototype.SetActive.call(this,t,n),this.SetSkipBtnActive(!1)},t.prototype.UpdateUI=function(){null!=this.TextObj&&(this.TextObj.Text=this.FrontText+this.ProgressText)},t}(AppUIBase);__reflect(LoadingSingleView.prototype,"LoadingSingleView",["LoadingReporter","RES.PromiseTaskReporter","IAppUIFunctionBase","IAppFunctionBase"]);var MsgWindowType;!function(e){e[e.MsgOnly=0]="MsgOnly",e[e.OneBtn=1]="OneBtn",e[e.TwoBtn=2]="TwoBtn"}(MsgWindowType||(MsgWindowType={}));var MsgWindowBtnType;!function(e){e[e.CenterBtn=0]="CenterBtn",e[e.RightBtn=1]="RightBtn",e[e.LeftBtn=2]="LeftBtn",e[e.BGBtn=3]="BGBtn"}(MsgWindowBtnType||(MsgWindowBtnType={}));var MsgWindow=function(e){function t(){var n=e.call(this)||this;return n.TitleText=null,n.InfoText=null,n.CenterText=null,n.LeftText=null,n.RightText=null,n.BtnCallback=null,n.BtnTypePanels=[],null==t.Instance&&(t.Instance=n),n}return __extends(t,e),Object.defineProperty(t,"ins",{get:function(){return null==this.Instance&&(this.Instance=new t),this.Instance},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsActive",{get:function(){return t.ins.IsActive},enumerable:!0,configurable:!0}),t.SetupResizeHandler=function(e){t.ins.ResizeHandler=e},t.ShowLangMsg=function(e,n,o,i,a){void 0===i&&(i=""),void 0===a&&(a=null),t.ins.ShowMsg(e,"",LanguageManager.GetText(n),LanguageManager.GetText(o),LanguageManager.GetText(i),a)},t.ShowMsg=function(e,n,o,i,a){void 0===i&&(i=""),void 0===a&&(a=null),t.ins.ShowMsg(e,"",n,o,i,a)},t.ShowLangMsg_MsgOnly=function(e,n){void 0===n&&(n=null),t.ins.ShowMsg(MsgWindowType.MsgOnly,"",LanguageManager.GetText(e),"","",n)},t.ShowMsg_MsgOnly=function(e,n){void 0===n&&(n=null),t.ins.ShowMsg(MsgWindowType.MsgOnly,"",e,"","",n)},t.HideMsg=function(){t.ins.SetActive(!1)},t.ShowLangMsg_OKOnly=function(e,n){void 0===n&&(n=null),t.ins.ShowMsg(MsgWindowType.OneBtn,"",LanguageManager.GetText(e),LanguageManager.GetText("OK"),"",n)},t.ShowMsg_OKOnly=function(e,n){void 0===n&&(n=null),t.ins.ShowMsg(MsgWindowType.OneBtn,"",e,LanguageManager.GetText("OK"),"",n)},t.ShowLangMsgWithTitle_OKOnly=function(e,n,o){void 0===o&&(o=null),t.ins.ShowMsg(MsgWindowType.OneBtn,LanguageManager.GetText(e),LanguageManager.GetText(n),LanguageManager.GetText("OK"),"",o)},t.ShowMsgWithTitle_OKOnly=function(e,n,o){void 0===o&&(o=null),t.ins.ShowMsg(MsgWindowType.OneBtn,e,n,LanguageManager.GetText("OK"),"",o)},t.ShowLangMsg_OKCancel=function(e,n){void 0===n&&(n=null),t.ins.ShowMsg(MsgWindowType.TwoBtn,"",LanguageManager.GetText(e),LanguageManager.GetText("OK"),LanguageManager.GetText("Cancel"),n)},t.ShowMsg_OKCancel=function(e,n){void 0===n&&(n=null),t.ins.ShowMsg(MsgWindowType.TwoBtn,"",e,LanguageManager.GetText("OK"),LanguageManager.GetText("Cancel"),n)},t.ShowLangMsgWithTitle_OKCancel=function(e,n,o){void 0===o&&(o=null),t.ins.ShowMsg(MsgWindowType.TwoBtn,LanguageManager.GetText(e),LanguageManager.GetText(n),LanguageManager.GetText("OK"),LanguageManager.GetText("Cancel"),o)},t.ShowMsgWithTitle_OKCancel=function(e,n,o){void 0===o&&(o=null),t.ins.ShowMsg(MsgWindowType.TwoBtn,e,n,LanguageManager.GetText("OK"),LanguageManager.GetText("Cancel"),o)},t.ShowLangMsgWithTitle=function(e,n,o,i,a,r){void 0===a&&(a=""),void 0===r&&(r=null),t.ins.ShowMsg(e,LanguageManager.GetText(n),LanguageManager.GetText(o),LanguageManager.GetText(i),LanguageManager.GetText(a),r)},t.ShowMsgWithTitle=function(e,n,o,i,a,r){void 0===a&&(a=""),void 0===r&&(r=null),t.ins.ShowMsg(e,n,o,i,a,r)},t.prototype.Init=function(){for(var t=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(e.prototype.Init.apply(this,n)){this.Depth=1e3,this.ActivePanel=FUIManager.GetEObj(this.RootObj,"ActivePanel"),this.TitleText=FUIManager.GetEObj(this.RootObj,"Text_Title"),this.InfoText=FUIManager.GetEObj(this.RootObj,"Text_Info"),this.CenterText=FUIManager.GetEObj(this.RootObj,"CenterBtn/Text"),this.LeftText=FUIManager.GetEObj(this.RootObj,"LeftBtn/Text"),this.RightText=FUIManager.GetEObj(this.RootObj,"RightBtn/Text"),this.InfoText||(this.InfoText=FUIManager.GetEObj(this.RootObj,"MsgArea/Text_Info"));for(var i=0,a=Method.GetEnumCount(MsgWindowType);a>i;i++)this.BtnTypePanels.push(FUIManager.GetEObj(this.RootObj,MsgWindowType[i]));for(var r=function(e,n){var o=MsgWindowBtnType[e],i=FUIManager.GetEObj(s.RootObj,o);i.RegisterClickEvent(function(){t.OnClickBtn(o)})},s=this,i=0,a=Method.GetEnumCount(MsgWindowBtnType);a>i;i++)r(i,a);this.IsInited=!0,this.SetActive(!1)}},t.prototype.ShowMsg=function(e,t,n,o,i,a){return void 0===i&&(i=""),void 0===a&&(a=null),this.IsInited?(FUIManager.SetActiveETargetAndCloseOthers(this.BtnTypePanels[e],this.BtnTypePanels),this.TitleText&&(this.TitleText.Text=StringIsNullOrEmpty(t)?"":t),this.InfoText.Text=StringIsNullOrEmpty(n)?"":n,this.CenterText.Text=StringIsNullOrEmpty(o)?"":o,this.LeftText.Text=StringIsNullOrEmpty(o)?"":o,this.RightText.Text=StringIsNullOrEmpty(i)?"":i,this.BtnCallback=a,void this.SetActive(!0)):(Debug.LogError("MsgWindow還沒Init"),void Debug.LogAlert("Error : "+n))},t.prototype.SetActive=function(t,n){void 0===n&&(n=!1),this.IsInited&&(e.prototype.SetActive.call(this,t,n),this.ActivePanel.SetActive(t),t||(this.BtnCallback=null))},t.prototype.OnClickBtn=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:switch(t=Method.ParseValueToEnum(MsgWindowBtnType,e)){case MsgWindowBtnType.BGBtn:return SendTool.SendData("OnClickMsgBG"),[2];case MsgWindowBtnType.CenterBtn:case MsgWindowBtnType.RightBtn:case MsgWindowBtnType.LeftBtn:null!=this.BtnCallback&&this.BtnCallback(this.InfoText.Text,t);break;default:Debug.LogError("未知錯誤 : MsgWindowBtnType轉換錯誤")}return[4,Time.WaitForDeltaTime()];case 1:return n.sent(),this.SetActive(!1),[2]}})})},t.prototype.OnResize=function(){this.ResizeHandler?this.ResizeHandler(this.RootEObj):e.prototype.OnResize.call(this)},t}(AppUIBase);__reflect(MsgWindow.prototype,"MsgWindow");var LobbyView=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.IconPos=[new Vector2(-44,71),new Vector2(-155,101),new Vector2(-22,126)],t.IconUrl=["ui://si08n7likuz4156","ui://si08n7licfhxxi","ui://si08n7licfhxxl"],t}return __extends(t,e),t.prototype.Init=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return e.prototype.Init.call(this,t)&&(this.PlayerName=FUIManager.GetEObj(this.RootObj,"RoomPanel/UI_Player/Text_Name"),this.Money=FUIManager.GetEObj(this.RootObj,"RoomPanel/UI_Player/Text_Money"),this.NetSpeedText=FUIManager.GetEObj(this.RootObj,"RoomPanel/UI_Top/Text_NetSpeed")),[2]})})},t.prototype.ResetRoomBtnAni=function(){for(var e=0,t=this.RoomBtn.length;t>e;e++)this.RoomBtn[e]&&this.RoomBtn[e].PlayAni("t0")},t.prototype.PlayEnterRoomAni=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return this.RoomBtn[e]&&this.RoomBtn[e].PlayAni("t1"),[4,Time.WaitForSecond(1.5)];case 1:return n.sent(),t&&t(),[2]}})})},t.prototype.OnGetRoomBtn=function(t,n){e.prototype.OnGetRoomBtn.call(this,t,n),this.RoomTitle[n]&&(this.RoomTitle[n].Text=LanguageManager.GetText("FishType_"+(17+n)));var o=t.GetChild("Icon");o&&(o.Icon=this.IconUrl[n],o.Position=this.IconPos[n])},t.prototype.UpdateUI=function(){e.prototype.UpdateUI.call(this)},t}(FishingLobbyViewBase);__reflect(LobbyView.prototype,"LobbyView");var ResManager=function(){function e(){}return e.SetVersion=function(e){resAssignVersion=e,Debug.LogWithFlag("Client Version : "+resAssignVersion)},e.LoadConfig=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return[4,RES.loadConfig(this.UrlAttachVersion(e),t)];case 1:return n.sent(),[2]}})})},e.LoadGroup=function(e,t,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(o){switch(o.label){case 0:return[4,RES.loadGroup(e,t,n)];case 1:return o.sent(),[2]}})})},e.UrlAttachVersion=function(e){if(e.indexOf("v=")<0){var t=Date.now().toString();(""==t||null==t)&&(t=(1e7*Math.random()).toFixed(0)),e+=e.indexOf("?")<0?"?v="+t:"&v="+t}return e},e.DeleteGroupResources=function(e){for(var t=RES.getGroupByName(e),n=0,o=t.length;o>n;n++)RES.destroyRes(t[n].name,!0)},e.GetJson=function(e){if(RES.hasRes(e)){var t=RES.getRes(e);return JSON.parse(t)}return null},e.GetResource=function(e){return RES.hasRes(e)?RES.getRes(e):(Debug.LogWarning("取得「"+e+"」資源失敗"),null)},e}();__reflect(ResManager.prototype,"ResManager");var FishingAutoBotCtrller=function(){function e(){this.AutoLv=0,this.WaitInterval=.3}return e.prototype.Init=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.AutoLv=GlobalValue.GetCustomIntValue("autoLv",0)},e.prototype.OnEnterLobby=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return SendTool.SendData("OnClickSkipBtn",null),[4,Time.WaitForSecond(1)];case 1:return n.sent(),e=this.GetRoomInfoIndex(),e>=0&&(t=GameManager.ins.LobbyView.RoomBtn[e])?(SendTool.SendData("OnClickLobbyBtn",t),[4,Time.WaitForSecond(this.WaitInterval)]):[3,5];case 2:return n.sent(),GameManager.ins.CommonCtrller.ClickCommonBtn("WalletBtn_MaxBet"),[4,Time.WaitForSecond(this.WaitInterval)];case 3:return n.sent(),GameManager.ins.CommonCtrller.ClickCommonBtn("WalletBtn_AutoBuy"),[4,Time.WaitForSecond(this.WaitInterval)];case 4:n.sent(),GameManager.ins.CommonCtrller.ClickCommonBtn("WalletBtn_Confirm"),n.label=5;case 5:return[2]}})})},e.prototype.OnEnterGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return 0!=this.AutoLv?[3,3]:(GameManager.ins.MainCtrller.ClickGameBtn("EnableAFKBtn"),[4,Time.WaitForSecond(this.WaitInterval)]);case 1:return e.sent(),GameManager.ins.MainCtrller.ClickGameBtn("AFKBtn_SelectAll"),[4,Time.WaitForSecond(this.WaitInterval)];case 2:e.sent(),GameManager.ins.MainCtrller.ClickGameBtn("AFKBtn_Confirm"),e.label=3;case 3:return[2]}})})},e.prototype.GetRoomInfoIndex=function(){if(GameManager.ins.LobbyData.RoomInfo){for(var e=0,t=GameManager.ins.LobbyData.RoomInfo.length;t>e;e++){var n=GameManager.ins.LobbyData.RoomInfo[e];if(n&&n.MaxBalance&&n.MinBalance&&n.IsActive)return e}return-1}return MsgWindow.ShowMsg_OKOnly("Room Info Data = null"),-1},e}();__reflect(FishingAutoBotCtrller.prototype,"FishingAutoBotCtrller");var BalanceDataEnum;!function(e){e[e.ErrorCode=0]="ErrorCode",e[e.Money=1]="Money",e[e.IncreaseMoney=2]="IncreaseMoney"}(BalanceDataEnum||(BalanceDataEnum={}));var BalanceData=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"GetCorParamDic",{get:function(){return new Dictionary([{key:BalanceDataEnum.Money,value:new FieldValue(FieldType.Double,0)}])},enumerable:!0,configurable:!0}),t.prototype.GetValue=function(e){return this.GetMsgValue(BalanceDataEnum,e)},t}(ServerValueParseBase);__reflect(BalanceData.prototype,"BalanceData");var LoginLobbyResponseEnum;!function(e){e[e.LobbyID=0]="LobbyID",e[e.ErrorCode=1]="ErrorCode",e[e.Nickname=2]="Nickname",e[e.ChatBanned=3]="ChatBanned",e[e.Money=4]="Money",e[e.VIP=5]="VIP",e[e.TotalDeposit=6]="TotalDeposit",e[e.DepositIn3Month=7]="DepositIn3Month",e[e.PlayPointsIn90Days=8]="PlayPointsIn90Days",e[e.TodayTradedPoints=9]="TodayTradedPoints",e[e.CreditPoint=10]="CreditPoint",e[e.Items=11]="Items",e[e.ServerTime=12]="ServerTime",e[e.HasTradePassword=13]="HasTradePassword",e[e.ReservedGameType=14]="ReservedGameType",e[e.ReservedRoomId=15]="ReservedRoomId",e[e.ReservedExpiredTime=16]="ReservedExpiredTime",e[e.LotteryTicketAmount=17]="LotteryTicketAmount",e[e.MoneyFreezedAmount=18]="MoneyFreezedAmount",e[e.Currency=19]="Currency",e[e.WalletType=20]="WalletType"}(LoginLobbyResponseEnum||(LoginLobbyResponseEnum={}));var LoginLobbyResponseData=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"GetCorParamDic",{get:function(){return new Dictionary([{key:LoginLobbyResponseEnum.LobbyID,value:new FieldValue(FieldType.Int)},{key:LoginLobbyResponseEnum.ErrorCode,value:new FieldValue(FieldType.Int,0)},{key:LoginLobbyResponseEnum.Nickname,value:new FieldValue(FieldType.String)},{key:LoginLobbyResponseEnum.Money,value:new FieldValue(FieldType.Long,0)},{key:LoginLobbyResponseEnum.WalletType,value:new FieldValue(FieldType.Int,0)}])},enumerable:!0,configurable:!0}),t.prototype.GetValue=function(e){return this.GetMsgValue(LoginLobbyResponseEnum,e)},t}(ServerValueParseBase);__reflect(LoginLobbyResponseData.prototype,"LoginLobbyResponseData");var HttpHandler_FishingLoginLobby=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LobbyBetRecordUrl="",t}return __extends(t,e),t.prototype.OnMsg_LoginLobby=function(t,n){var o=JSON.parse(t);if(o.FishGroup)for(var i=0,a=o.FishGroup.length;a>i;i++){var r=new FishSettingData(o.FishGroup[i].FSType,o.FishGroup[i].Group,o.FishGroup[i].MinOdd,o.FishGroup[i].MaxOdd);GameManager.ins.Data.FishSetting.Update(o.FishGroup[i].FSType,r)}this.LobbyBetRecordUrl=o.ReportUrl,GameManager.ins.Data.BetRecordDomain=o.ReportUrl,e.prototype.OnMsg_LoginLobby.call(this,t,n)},t.prototype.OnMsg_Fetch=function(t,n){var o=JSON.parse(t);GameManager.ins.LobbyData.Balance=o.Balance,GameManager.ins.LobbyData.NickName=o.NickName,GameManager.ins.LobbyData.RoomInfo=o.RoomInfo,this.LobbyBetRecordUrl&&(GameManager.ins.Data.BetRecordDomain=this.LobbyBetRecordUrl),e.prototype.OnMsg_Fetch.call(this,t,n)},t}(HttpHandler_LoginLobby);__reflect(HttpHandler_FishingLoginLobby.prototype,"HttpHandler_FishingLoginLobby");var UpdateFishRespData=function(){function e(){}return e}();__reflect(UpdateFishRespData.prototype,"UpdateFishRespData");var GameInitRespData=function(){function e(){}return e}();__reflect(GameInitRespData.prototype,"GameInitRespData");var FishGroupRespData=function(){function e(){}return e}();__reflect(FishGroupRespData.prototype,"FishGroupRespData");var JoinRoomRespData=function(){function e(){}return e}();__reflect(JoinRoomRespData.prototype,"JoinRoomRespData");var PlayerJoinRespData=function(){function e(){}return e}();__reflect(PlayerJoinRespData.prototype,"PlayerJoinRespData");var PlayerLeaveRespData=function(){function e(){}return e}();__reflect(PlayerLeaveRespData.prototype,"PlayerLeaveRespData");var PlayerRespData=function(){function e(){}return e}();__reflect(PlayerRespData.prototype,"PlayerRespData");var HitUpdateBalanceRespData=function(){function e(){}return e}();__reflect(HitUpdateBalanceRespData.prototype,"HitUpdateBalanceRespData");var RemoveFishRespData=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(HitUpdateBalanceRespData);__reflect(RemoveFishRespData.prototype,"RemoveFishRespData");var AddFishRespData=function(){function e(){this.lisFSStatus=[]}return e}();__reflect(AddFishRespData.prototype,"AddFishRespData");var FishStatus=function(){function e(){this.bRunFirst=!1,this.bEnable=!0}return e}();__reflect(FishStatus.prototype,"FishStatus");var ChangeBulletData=function(){function e(){}return e}();__reflect(ChangeBulletData.prototype,"ChangeBulletData");var ShowWaveData=function(){function e(){}return e}();__reflect(ShowWaveData.prototype,"ShowWaveData");var GetBalanceData=function(){function e(){}return e}();__reflect(GetBalanceData.prototype,"GetBalanceData");var GetBalanceExtData=function(){function e(){}return e}();__reflect(GetBalanceExtData.prototype,"GetBalanceExtData");var ExchangeBalanceData=function(){function e(){}return e}();__reflect(ExchangeBalanceData.prototype,"ExchangeBalanceData");var ShootBulletData=function(){function e(){}return e}();__reflect(ShootBulletData.prototype,"ShootBulletData");var ShootSpecialBulletData=function(){function e(){}return e}();__reflect(ShootSpecialBulletData.prototype,"ShootSpecialBulletData");var GetSpecialBulletData=function(){function e(){}return e}();__reflect(GetSpecialBulletData.prototype,"GetSpecialBulletData");var WebSocketHandler_GameLogin=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Send=function(t){switch(GlobalValue.GameMode){case GameMode.Local:var n=JSON.parse(t),o=n.Opcode;WebSocketManager.ins.SendFakeRespMsg(o);break;default:e.prototype.Send.call(this,t)}},t.prototype.OnMsg=function(e){if(this.HandleError(e)){var t=JSON.parse(e),n=t.OpCode;switch(n){case"Login":var o=t.Data;GameManager.ins.Data.BetRecordDomain=o.ReportUrl,GameManager.ins.Data.PlayerName=o.PlayerName,GlobalValue.LoginToken||(GlobalValue.LoginToken=o.Token);
var i='{"Opcode": "JoinRoom", "Data": {"GameType":"'+GlobalValue.GameType+'"}}';ServerDebug.Log(i),this.Send(i),this.Callback&&this.Callback(n,t);break;case"JoinRoom":var a=t.Data;if(null!=a){GameManager.ins.Data.SelfSeatIndex=Method.Clamp(a.Seat,0,GameSettings.MaxSeatCount-1);for(var r=0,s=a.PlayerInfo.length;s>r;r++){var l=a.PlayerInfo[r].PlayerSeat;GameManager.ins.Data.Seat[l].Setup(a.PlayerInfo[r].PlayerID,a.PlayerInfo[r].PlayerName,a.PlayerInfo[r].PlayerBalance)}this.Callback&&(this.Callback(n,t),this.Callback("Init",null))}}}},t.prototype.OnErrorMsg=function(e){GameManager.ins.OnErrorMsg(e)},t}(WebSocketHandler_Login);__reflect(WebSocketHandler_GameLogin.prototype,"WebSocketHandler_GameLogin");var Bounds=function(){function e(){}return e}();__reflect(Bounds.prototype,"Bounds");var Fish=function(e){function t(t,n,o,i,a,r,s){void 0===s&&(s=null);var l=e.call(this,t,n,o,i,a,r,s)||this;l.Active=!0,l.iRunCount=FishMachineUIDefine.FishPath_Advance_Fps,l.FSStartPosition=new FishPosition,l.FSNextPosition=new FishPosition,l.lisFsPath=[];for(var u=0;u<FishMachineUIDefine.FishPath_Advance_Fps;u++)l.lisFsPath.push(new FishPosition);return l.lisFSStatus=[],l.iFishPathIndex=-1,l.iSetPathIndex=-1,l.InitStatus(),l}return __extends(t,e),t.prototype.InitStatus=function(){this.iFSStatusIndex=0,this.iFsStatusFrameCount=0,this.FSPoolStatus=FishPoolStatus.NewAddToPool},t.prototype.RunPath=function(){for(var e=0;e<this.iRunCount;e++){if(this.iFsStatusFrameCount++,this.iFsStatusFrameCount>this.lisFSStatus[this.iFSStatusIndex].iRunFrame)for(var t=0;t<this.lisFSStatus.length;t++)if(this.iFSStatusIndex++,this.iFSStatusIndex>=this.lisFSStatus.length&&(this.iFSStatusIndex=0),0!=this.lisFSStatus[this.iFSStatusIndex].bEnable&&1!=this.lisFSStatus[this.iFSStatusIndex].bRunFirst){this.iFsStatusFrameCount=0,this.FirstStatusRun=!0;break}1==this.FirstStatusRun&&(this.MovementSpeed=this.lisFSStatus[this.iFSStatusIndex].dSpeed,this.FirstStatusRun=!1),this.FSStartPosition.dX=this.Transform.Position.x,this.FSStartPosition.dY=this.Transform.Position.y,this.FSStartPosition.dSpeed=this.MovementSpeed,this.FSStartPosition.dAngle=this.Angle,this.GetStatusNextPoint(this.FSStartPosition,this.lisFSStatus[this.iFSStatusIndex].dSpeedChange,this.lisFSStatus[this.iFSStatusIndex].dAngleChange,this.lisFSStatus[this.iFSStatusIndex].iRunFunType,this.lisFSStatus[this.iFSStatusIndex].dCirCleRadios,this.FSNextPosition),this.MovementSpeed=this.FSNextPosition.dSpeed,this.Angle=this.SetAngle(this.FSNextPosition.dAngle),this.Transform.Position=new Vector3(this.FSNextPosition.dX,this.FSNextPosition.dY,0)}return!0},t.prototype.SetAngle=function(e){return e>180&&(e+=-360),-180>e&&(e+=360),e},t.prototype.GetStatusNextPoint=function(e,t,n,o,i,a){var r=0,s=0;a.dSpeed=e.dSpeed+t,a.dAngle=e.dAngle+n,a.dAngle>180&&(a.dAngle+=-360),a.dAngle<-180&&(a.dAngle+=360),1==o?(a.dX=i*Math.cos(this.Deg2Rad(a.dAngle-90))+FishMachineUIDefine.Screen_Length/2,a.dY=i*Math.sin(this.Deg2Rad(a.dAngle-90))+FishMachineUIDefine.Screen_Width/2):2==o?(a.dX=e.dX+i*(Math.cos(this.Deg2Rad(a.dAngle-180))-Math.cos(this.Deg2Rad(e.dAngle-180))),a.dY=e.dY+i*(Math.sin(this.Deg2Rad(a.dAngle-180))-Math.sin(this.Deg2Rad(e.dAngle-180)))):3==o?(a.dX=e.dX+i*(Math.cos(this.Deg2Rad(a.dAngle-90))-Math.cos(this.Deg2Rad(e.dAngle-90))),a.dY=e.dY+i*(Math.sin(this.Deg2Rad(a.dAngle-90))-Math.sin(this.Deg2Rad(e.dAngle-90)))):(r=a.dSpeed*Math.cos(this.Deg2Rad(a.dAngle)),s=a.dSpeed*Math.sin(this.Deg2Rad(a.dAngle)),a.dX=e.dX+r,a.dY=e.dY+s)},t.prototype.Deg2Rad=function(e){return e/180*Math.PI},t}(FishBase);__reflect(Fish.prototype,"Fish");var JackpotDataEnum;!function(e){e[e.GameID=0]="GameID",e[e.SubIndex=1]="SubIndex",e[e.Money=2]="Money",e[e.MissionId=3]="MissionId",e[e.PatternId=4]="PatternId",e[e.SaveTotalMarks=5]="SaveTotalMarks",e[e.Enable=6]="Enable"}(JackpotDataEnum||(JackpotDataEnum={}));var JackpotData=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"GetCorParamDic",{get:function(){return new Dictionary([{key:JackpotDataEnum.GameID,value:new FieldValue(FieldType.Int,GlobalValue.GameID)},{key:JackpotDataEnum.Money,value:new FieldValue(FieldType.Float,0)}])},enumerable:!0,configurable:!0}),t.prototype.GetValue=function(e){return this.GetMsgValue(JackpotDataEnum,e)},t}(ServerValueParseBase);__reflect(JackpotData.prototype,"JackpotData");var FishConfig=function(){function e(){}return e}();__reflect(FishConfig.prototype,"FishConfig");var FishMachineUIDefine=function(){function e(){}return e.Screen_Length=1280,e.Screen_Width=720,e.FishPath_Advance_Fps=1,e}();__reflect(FishMachineUIDefine.prototype,"FishMachineUIDefine");var FishPoolStatus;!function(e){e[e.Init=0]="Init",e[e.NewAddToPool=1]="NewAddToPool",e[e.Run=2]="Run",e[e.Remove_SendToUser=3]="Remove_SendToUser",e[e.Hit_SendToUser=4]="Hit_SendToUser",e[e.BackToPool=5]="BackToPool",e[e.Idle=6]="Idle"}(FishPoolStatus||(FishPoolStatus={}));var FishPosition=function(){function e(){this.dX=0,this.dY=0,this.dSpeed=0,this.dAngle=0}return e}();__reflect(FishPosition.prototype,"FishPosition");var Transform=function(){function e(){this.Position=new Vector3(0,0,0)}return Object.defineProperty(e.prototype,"Forward",{get:function(){return Vector3.Zero},set:function(e){},enumerable:!0,configurable:!0}),e}();__reflect(Transform.prototype,"Transform");var JoinGameRoomResponseEnum;!function(e){e[e.GameID=0]="GameID",e[e.RoomID=1]="RoomID",e[e.ErrorCode=2]="ErrorCode",e[e.Money=3]="Money",e[e.GameBet=4]="GameBet",e[e.GameSymbol=5]="GameSymbol"}(JoinGameRoomResponseEnum||(JoinGameRoomResponseEnum={}));var JoinGameRoomResponseData=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=e.call(this)||this;return o.ServerMsg=t[0],o.GameBet=new GameBetResponseData(o.GetValue(JoinGameRoomResponseEnum.GameBet)),o.GameSymbol=new GameSymbolResponseData(o.GetValue(JoinGameRoomResponseEnum.GameSymbol)),o}return __extends(t,e),Object.defineProperty(t.prototype,"GetCorParamDic",{get:function(){return new Dictionary([{key:JoinGameRoomResponseEnum.ErrorCode,value:new FieldValue(FieldType.Int,0)},{key:JoinGameRoomResponseEnum.GameBet,value:new FieldValue(FieldType.Array)},{key:JoinGameRoomResponseEnum.GameSymbol,value:new FieldValue(FieldType.Array)}])},enumerable:!0,configurable:!0}),t.prototype.GetValue=function(e){return this.GetMsgValue(JoinGameRoomResponseEnum,e)},t}(ServerValueParseBase);__reflect(JoinGameRoomResponseData.prototype,"JoinGameRoomResponseData");var GameBetResponseEnum;!function(e){e[e.GameName=0]="GameName",e[e.BetSizes=1]="BetSizes",e[e.BaseBet=2]="BaseBet",e[e.PrizeStart=3]="PrizeStart",e[e.PrizeSet=4]="PrizeSet",e[e.PrizeRate=5]="PrizeRate",e[e.MarQueeOverRate=6]="MarQueeOverRate",e[e.PoPOutOverRate=7]="PoPOutOverRate",e[e.ShowTipMoney=8]="ShowTipMoney",e[e.MaximumBet=9]="MaximumBet",e[e.DefaultBet=10]="DefaultBet",e[e.AreaMaxBet=11]="AreaMaxBet",e[e.TableMaxBet=12]="TableMaxBet"}(GameBetResponseEnum||(GameBetResponseEnum={}));var GameBetResponseData=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"GetCorParamDic",{get:function(){return new Dictionary([{key:GameBetResponseEnum.BetSizes,value:new FieldValue(FieldType.NumberArray)},{key:GameBetResponseEnum.BaseBet,value:new FieldValue(FieldType.Float)},{key:GameBetResponseEnum.DefaultBet,value:new FieldValue(FieldType.Float,0)}])},enumerable:!0,configurable:!0}),t.prototype.GetValue=function(e){return this.GetMsgValue(GameBetResponseEnum,e)},t}(ServerValueParseBase);__reflect(GameBetResponseData.prototype,"GameBetResponseData");var GameSymbolResponseEnum;!function(e){e[e.UID=0]="UID",e[e.Currency=1]="Currency",e[e.GameName=2]="GameName",e[e.Symbol=3]="Symbol",e[e.Name=4]="Name",e[e.MinBetRate=5]="MinBetRate",e[e.MaxBetRate=6]="MaxBetRate",e[e.DefaultRate=7]="DefaultRate",e[e.CashScale=8]="CashScale",e[e.BetMultiples=9]="BetMultiples",e[e.JPCashType=10]="JPCashType",e[e.CashDigits=11]="CashDigits",e[e.CustomDisplayCashScale=12]="CustomDisplayCashScale"}(GameSymbolResponseEnum||(GameSymbolResponseEnum={}));var GameSymbolResponseData=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"GetCorParamDic",{get:function(){return new Dictionary([{key:GameSymbolResponseEnum.Symbol,value:new FieldValue(FieldType.String)},{key:GameSymbolResponseEnum.MinBetRate,value:new FieldValue(FieldType.Float)},{key:GameSymbolResponseEnum.MaxBetRate,value:new FieldValue(FieldType.Float)},{key:GameSymbolResponseEnum.DefaultRate,value:new FieldValue(FieldType.Float)},{key:GameSymbolResponseEnum.CashScale,value:new FieldValue(FieldType.Float)},{key:GameSymbolResponseEnum.BetMultiples,value:new FieldValue(FieldType.NumberArray)},{key:GameSymbolResponseEnum.JPCashType,value:new FieldValue(FieldType.Int)},{key:GameSymbolResponseEnum.CashDigits,value:new FieldValue(FieldType.Int)},{key:GameSymbolResponseEnum.CustomDisplayCashScale,value:new FieldValue(FieldType.Int,1)}])},enumerable:!0,configurable:!0}),t.prototype.GetValue=function(e){return this.GetMsgValue(GameSymbolResponseEnum,e)},t}(ServerValueParseBase);__reflect(GameSymbolResponseData.prototype,"GameSymbolResponseData");var LoginAccountResponseEnum;!function(e){e[e.SessionId=0]="SessionId",e[e.ErrorCode=1]="ErrorCode",e[e.LobbyServerIP=2]="LobbyServerIP",e[e.LobbyServerPort=3]="LobbyServerPort",e[e.Bind=4]="Bind",e[e.Freeze=5]="Freeze"}(LoginAccountResponseEnum||(LoginAccountResponseEnum={}));var LoginAccountResponseData=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"GetCorParamDic",{get:function(){return new Dictionary([{key:LoginAccountResponseEnum.SessionId,value:new FieldValue(FieldType.Int)},{key:LoginAccountResponseEnum.ErrorCode,value:new FieldValue(FieldType.Int,0)},{key:LoginAccountResponseEnum.LobbyServerIP,value:new FieldValue(FieldType.String)},{key:LoginAccountResponseEnum.LobbyServerPort,value:new FieldValue(FieldType.String)},{key:LoginAccountResponseEnum.Bind,value:new FieldValue(FieldType.Boolean)},{key:LoginAccountResponseEnum.Freeze,value:new FieldValue(FieldType.String,"")}])},enumerable:!0,configurable:!0}),t.prototype.GetValue=function(e){return this.GetMsgValue(LoginAccountResponseEnum,e)},Object.defineProperty(t.prototype,"IsFreezed",{get:function(){return!StringIsNullOrEmpty(this.GetValue(LoginAccountResponseEnum.Freeze))},enumerable:!0,configurable:!0}),t}(ServerValueParseBase);__reflect(LoginAccountResponseData.prototype,"LoginAccountResponseData");var LoginResponseEnum_Formal;!function(e){e[e.ErrorCode=0]="ErrorCode",e[e.NickName=1]="NickName"}(LoginResponseEnum_Formal||(LoginResponseEnum_Formal={}));var LoginResponse_Formal=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"GetCorParamDic",{get:function(){return new Dictionary([{key:LoginResponseEnum_Formal.ErrorCode,value:new FieldValue(FieldType.Int,0)},{key:LoginResponseEnum_Formal.NickName,value:new FieldValue(FieldType.String,"")}])},enumerable:!0,configurable:!0}),t.prototype.GetValue=function(e){return this.GetMsgValue(LoginResponseEnum_Formal,e)},t}(ServerValueParseBase);__reflect(LoginResponse_Formal.prototype,"LoginResponse_Formal");var PhotonFakeDataBase=function(){function e(){}return e.prototype.GetFakeResponse=function(e,t){void 0===t&&(t=-1);var n=(t>=0?PhotonProtocol[e]+"_"+t:PhotonProtocol[e])+"_txt";return ResManager.GetJson(n)},e}();__reflect(PhotonFakeDataBase.prototype,"PhotonFakeDataBase",["IPhotonFakeResponse"]);var PhotonRespEnum_JoinRoom;!function(e){e[e.GameID=0]="GameID",e[e.RoomID=1]="RoomID",e[e.ErrorCode=2]="ErrorCode",e[e.Money=3]="Money",e[e.GameBet=4]="GameBet",e[e.GameSymbol=5]="GameSymbol"}(PhotonRespEnum_JoinRoom||(PhotonRespEnum_JoinRoom={}));var PhotonRespData_JoinRoom=function(e){function t(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=e.call(this)||this;return o.ServerMsg=t[0],o.GameBet=new PhotonRespData_GameBet(o.GetValue(PhotonRespEnum_JoinRoom.GameBet)),o.GameSymbol=new PhotonRespData_GameSymbol(o.GetValue(PhotonRespEnum_JoinRoom.GameSymbol)),o}return __extends(t,e),Object.defineProperty(t.prototype,"GetCorParamDic",{get:function(){return new Dictionary([{key:PhotonRespEnum_JoinRoom.ErrorCode,value:new FieldValue(FieldType.Int,0)},{key:PhotonRespEnum_JoinRoom.GameBet,value:new FieldValue(FieldType.Array)},{key:PhotonRespEnum_JoinRoom.GameSymbol,value:new FieldValue(FieldType.Array)}])},enumerable:!0,configurable:!0}),t.prototype.GetValue=function(e){return this.GetMsgValue(PhotonRespEnum_JoinRoom,e)},t}(ServerValueParseBase);__reflect(PhotonRespData_JoinRoom.prototype,"PhotonRespData_JoinRoom");var PhotonRespEnum_GameBet;!function(e){e[e.GameName=0]="GameName",e[e.BetSizes=1]="BetSizes",e[e.BaseBet=2]="BaseBet",e[e.PrizeStart=3]="PrizeStart",e[e.PrizeSet=4]="PrizeSet",e[e.PrizeRate=5]="PrizeRate",e[e.MarQueeOverRate=6]="MarQueeOverRate",e[e.PoPOutOverRate=7]="PoPOutOverRate",e[e.ShowTipMoney=8]="ShowTipMoney",e[e.MaximumBet=9]="MaximumBet",e[e.DefaultBet=10]="DefaultBet",e[e.AreaMaxBet=11]="AreaMaxBet",e[e.TableMaxBet=12]="TableMaxBet"}(PhotonRespEnum_GameBet||(PhotonRespEnum_GameBet={}));var PhotonRespData_GameBet=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"GetCorParamDic",{get:function(){return new Dictionary([{key:PhotonRespEnum_GameBet.BetSizes,value:new FieldValue(FieldType.NumberArray)},{key:PhotonRespEnum_GameBet.BaseBet,value:new FieldValue(FieldType.Float)},{key:PhotonRespEnum_GameBet.DefaultBet,value:new FieldValue(FieldType.Float,0)}])},enumerable:!0,configurable:!0}),t.prototype.GetValue=function(e){return this.GetMsgValue(PhotonRespEnum_GameBet,e)},t}(ServerValueParseBase);__reflect(PhotonRespData_GameBet.prototype,"PhotonRespData_GameBet");var PhotonRespEnum_GameSymbol;!function(e){e[e.UID=0]="UID",e[e.Currency=1]="Currency",e[e.GameName=2]="GameName",e[e.Symbol=3]="Symbol",e[e.Name=4]="Name",e[e.MinBetRate=5]="MinBetRate",e[e.MaxBetRate=6]="MaxBetRate",e[e.DefaultRate=7]="DefaultRate",e[e.CashScale=8]="CashScale",e[e.BetMultiples=9]="BetMultiples",e[e.JPCashType=10]="JPCashType",e[e.CashDigits=11]="CashDigits",e[e.CustomDisplayCashScale=12]="CustomDisplayCashScale"}(PhotonRespEnum_GameSymbol||(PhotonRespEnum_GameSymbol={}));var PhotonRespData_GameSymbol=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"GetCorParamDic",{get:function(){return new Dictionary([{key:PhotonRespEnum_GameSymbol.Symbol,value:new FieldValue(FieldType.String)},{key:PhotonRespEnum_GameSymbol.MinBetRate,value:new FieldValue(FieldType.Float)},{key:PhotonRespEnum_GameSymbol.MaxBetRate,value:new FieldValue(FieldType.Float)},{key:PhotonRespEnum_GameSymbol.DefaultRate,value:new FieldValue(FieldType.Float)},{key:PhotonRespEnum_GameSymbol.CashScale,value:new FieldValue(FieldType.Float)},{key:PhotonRespEnum_GameSymbol.BetMultiples,value:new FieldValue(FieldType.NumberArray)},{key:PhotonRespEnum_GameSymbol.JPCashType,value:new FieldValue(FieldType.Int)},{key:PhotonRespEnum_GameSymbol.CashDigits,value:new FieldValue(FieldType.Int)},{key:PhotonRespEnum_GameSymbol.CustomDisplayCashScale,value:new FieldValue(FieldType.Int,1)}])},enumerable:!0,configurable:!0}),t.prototype.GetValue=function(e){return this.GetMsgValue(PhotonRespEnum_GameSymbol,e)},t}(ServerValueParseBase);__reflect(PhotonRespData_GameSymbol.prototype,"PhotonRespData_GameSymbol");var PhotonRespEnum_Balance;!function(e){e[e.ErrorCode=0]="ErrorCode",e[e.Money=1]="Money",e[e.IncreaseMoney=2]="IncreaseMoney"}(PhotonRespEnum_Balance||(PhotonRespEnum_Balance={}));var PhotonRespData_GetBalance=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"GetCorParamDic",{get:function(){return new Dictionary([{key:PhotonRespEnum_Balance.Money,value:new FieldValue(FieldType.Double,0)}])},enumerable:!0,configurable:!0}),t.prototype.GetValue=function(e){return this.GetMsgValue(PhotonRespEnum_Balance,e)},t}(ServerValueParseBase);__reflect(PhotonRespData_GetBalance.prototype,"PhotonRespData_GetBalance");var PhotonRespEnum_GetJackpot;!function(e){e[e.GameID=0]="GameID",e[e.SubIndex=1]="SubIndex",e[e.Money=2]="Money",e[e.MissionId=3]="MissionId",e[e.PatternId=4]="PatternId",e[e.SaveTotalMarks=5]="SaveTotalMarks",e[e.Enable=6]="Enable"}(PhotonRespEnum_GetJackpot||(PhotonRespEnum_GetJackpot={}));var PhotonRespData_GetJackpot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"GetCorParamDic",{get:function(){return new Dictionary([{key:PhotonRespEnum_GetJackpot.GameID,value:new FieldValue(FieldType.Int,GlobalValue.GameID)},{key:PhotonRespEnum_GetJackpot.Money,value:new FieldValue(FieldType.Float,0)}])},enumerable:!0,configurable:!0}),t.prototype.GetValue=function(e){return this.GetMsgValue(PhotonRespEnum_GetJackpot,e)},t}(ServerValueParseBase);__reflect(PhotonRespData_GetJackpot.prototype,"PhotonRespData_GetJackpot");var PhotonRespEnum_Lobby;!function(e){e[e.LobbyID=0]="LobbyID",e[e.ErrorCode=1]="ErrorCode",e[e.Nickname=2]="Nickname",e[e.ChatBanned=3]="ChatBanned",e[e.Money=4]="Money",e[e.VIP=5]="VIP",e[e.TotalDeposit=6]="TotalDeposit",e[e.DepositIn3Month=7]="DepositIn3Month",e[e.PlayPointsIn90Days=8]="PlayPointsIn90Days",e[e.TodayTradedPoints=9]="TodayTradedPoints",e[e.CreditPoint=10]="CreditPoint",e[e.Items=11]="Items",e[e.ServerTime=12]="ServerTime",e[e.HasTradePassword=13]="HasTradePassword",e[e.ReservedGameType=14]="ReservedGameType",e[e.ReservedRoomId=15]="ReservedRoomId",e[e.ReservedExpiredTime=16]="ReservedExpiredTime",e[e.LotteryTicketAmount=17]="LotteryTicketAmount",e[e.MoneyFreezedAmount=18]="MoneyFreezedAmount",e[e.Currency=19]="Currency",e[e.WalletType=20]="WalletType"}(PhotonRespEnum_Lobby||(PhotonRespEnum_Lobby={}));var PhotonRespData_Lobby=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"GetCorParamDic",{get:function(){return new Dictionary([{key:PhotonRespEnum_Lobby.LobbyID,value:new FieldValue(FieldType.Int)},{key:PhotonRespEnum_Lobby.ErrorCode,value:new FieldValue(FieldType.Int,0)},{key:PhotonRespEnum_Lobby.Nickname,value:new FieldValue(FieldType.String)},{key:PhotonRespEnum_Lobby.Money,value:new FieldValue(FieldType.Long,0)},{key:PhotonRespEnum_Lobby.WalletType,value:new FieldValue(FieldType.Int,0)}])},enumerable:!0,configurable:!0}),t.prototype.GetValue=function(e){return this.GetMsgValue(PhotonRespEnum_Lobby,e)},t}(ServerValueParseBase);__reflect(PhotonRespData_Lobby.prototype,"PhotonRespData_Lobby");var FishPathLogic=function(){function e(){}return e.RunFish=function(t,n){var o=new Fish(t.FishID,t.Speed,new Vector3(t.X,t.Y,0),t.Angle,0,0);o.iFSStatusIndex=t.FSStatusIndex,o.iFsStatusFrameCount=t.FSStatusNowFrameCount,o.FirstStatusRun=!0,o.Active=!0;for(var i=0,a=t.lisFSStatus.length;a>i;i++)o.lisFSStatus.push(t.lisFSStatus[i]);return o.StopKey=Time.RegisterFixUpdate(function(e){o.RunPath(),null!=n&&o.Active&&n(o.Id,o.Transform.Position,o.Angle)}),e.FishPool.ContainsKey(t.FishID)&&Debug.LogErrorWithFlag("<<Logic>> 沒有移除就有 ADD FISH ID : "+t.FishID),e.FishPool.Update(t.FishID,o),t.FishID},e.RemoveFish=function(t){var n=e.FishPool[t];IsNullOrUndefined(n)||(Time.UnregisterByKey(n.StopKey),n=null,e.FishPool.Remove(t))},e.FishPool=new Dictionary,e}();__reflect(FishPathLogic.prototype,"FishPathLogic");var LockTargetCtrller=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.LockKey="",t.SeatIndex=0,t.IsLockPointOnEdge=!1,t}return __extends(t,e),Object.defineProperty(t.prototype,"SeatData",{get:function(){return this.Data.Seat[this.SeatIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LockedFish",{get:function(){return StringIsNullOrEmpty(this.SeatData.LockedFishID)?null:this.Data.Fishes[this.SeatData.LockedFishID]},enumerable:!0,configurable:!0}),t.prototype.Init=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return e.prototype.Init.apply(this,t),this.SeatIndex=t[3],[2]})})},t.prototype.StartLockTarget=function(e,t){var n=this,o=this.SeatData.LockedFishID;this.SeatData.LockedFairyPos=new Vector2(0,0),this.SeatData.LockedFishType=this.LockedFish.FishType,this.View.SetLockFishActive(!0,o);var i=0,a=0,r=this.LockedFish.x-e,s=this.LockedFish.y-t;this.LockKey=Time.RegisterAndStopKey(function(e){if(n.SeatData.HasLockTarget){if(!n.LockedFish)return void n.OnLostFish(o);if(i=n.LockedFish.x-r,a=n.LockedFish.y-s,n.SeatData.LockedFairyPos.x=i,n.SeatData.LockedFairyPos.y=a,0>i?n.SeatData.LockedFairyPos.x=0:i>GlobalValue.EgretElementWidth&&(n.SeatData.LockedFairyPos.x=GlobalValue.EgretElementWidth),0>a?n.SeatData.LockedFairyPos.y=0:a>GlobalValue.EgretElementHeight&&(n.SeatData.LockedFairyPos.y=GlobalValue.EgretElementHeight),n.IsLockPointOnEdge=!1,!n.HasPoint(n.SeatData.LockedFairyPos.x,n.SeatData.LockedFairyPos.y)){var t=null;0>i?t=n.GetIntersectPoint(0,0,0,GlobalValue.EgretElementHeight):i>GlobalValue.EgretElementWidth&&(t=n.GetIntersectPoint(GlobalValue.EgretElementWidth,0,GlobalValue.EgretElementWidth,GlobalValue.EgretElementHeight)),0>a?t=n.GetIntersectPoint(0,0,GlobalValue.EgretElementWidth,0):a>GlobalValue.EgretElementHeight&&(t=n.GetIntersectPoint(0,GlobalValue.EgretElementHeight,GlobalValue.EgretElementWidth,GlobalValue.EgretElementHeight)),null!=t&&(n.IsLockPointOnEdge=!0,n.SeatData.LockedFairyPos.x=t.x,n.SeatData.LockedFairyPos.y=t.y)}r=n.LockedFish.x-n.SeatData.LockedFairyPos.x,s=n.LockedFish.y-n.SeatData.LockedFairyPos.y,n.HasPoint(n.SeatData.LockedFairyPos.x,n.SeatData.LockedFairyPos.y)?(n.SeatData.LockedFairyPos.x=n.SeatData.LockedFairyPos.x,n.SeatData.LockedFairyPos.y=n.SeatData.LockedFairyPos.y,n.View.UpdateLockTarget(!0,n.SeatData.LockedFairyPos.x,n.SeatData.LockedFairyPos.y)):n.SeatData.ClearLockTarget()}n.SeatData.HasLockTarget||n.OnLostFish(o)},this.LockKey)},t.prototype.OnLostFish=function(e){Time.UnregisterByKey(this.LockKey),this.View.UpdateLockTarget(!1),this.View.SetLockFishActive(!1,e),null!=this.Callback&&this.Callback(e)},t.prototype.HasPoint=function(e,t){if(null==this.LockedFish)return!1;if(null==this.LockedFish.FishDBObj)return!1;var n=this.View.RootEObj.LocalToGlobal(e,t);n=this.LockedFish.FishDBObj.GlobalToLocal(n.x,n.y);var o=this.LockedFish.FishDBObj.ContainsPoint(n.x,n.y);if(!o&&!this.IsLockPointOnEdge){var i=Method.CalcTwoPointDistance(e,t,this.LockedFish.FishObj.x,this.LockedFish.FishObj.y);if(40>i)return!0}return o},t.prototype.GetIntersectPoint=function(e,t,n,o){if(null!=this.LockedFish){var i=this.View.RootEObj.LocalToGlobal(e,t);i=this.LockedFish.FishDBObj.GlobalToLocal(i.x,i.y);var a=this.View.RootEObj.LocalToGlobal(n,o);a=this.LockedFish.FishDBObj.GlobalToLocal(a.x,a.y);var r=new egret.Point(0,0),s=new egret.Point(0,0),l=this.LockedFish.FishDBObj.IntersectsSegment(i.x,i.y,a.x,a.y,r,s);if(l){var u=this.LockedFish.FishDBObj.LocalToGlobal(.5*(r.x+s.x),.5*(r.y+s.y));return this.View.RootEObj.GlobalToLocal(u.x,u.y)}}return null},t}(GameCtrllerBase);__reflect(LockTargetCtrller.prototype,"LockTargetCtrller");var FishData=function(){function e(e,t,n){this.AbleToCol=!0,this.FishWave=!1,this.LastX=0,this.LastY=0,this.ID=e,this.FishObj=t,this.FishWave=!1,this.FishType=n,this.GetDragonBoneObj()}return Object.defineProperty(e.prototype,"x",{get:function(){return this.FishObj.x},set:function(e){this.FishObj.x=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.FishObj.y},set:function(e){this.FishObj.y=e},enumerable:!0,configurable:!0}),e.prototype.GetDragonBoneObj=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return e=this.FishObj.GetChild("Fish"),[4,Time.WaitForSecond()];case 1:return t.sent(),e.Color=16777215,this.FishDBObj=new DBoneElement(e.DBoneDisplay,FishType[this.FishType]),[2]}})})},e.prototype.Clear=function(){this.ID="",this.FishType=0,this.FishWave=!1,this.FishObj=null,null!=this.FishDBObj&&this.FishDBObj.Clear(),this.FishDBObj=null},e}();__reflect(FishData.prototype,"FishData");var FishingLobbyData=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(LobbyData);__reflect(FishingLobbyData.prototype,"FishingLobbyData");var PhotonRespEnum_Login;!function(e){e[e.SessionId=0]="SessionId",e[e.ErrorCode=1]="ErrorCode",e[e.LobbyServerIP=2]="LobbyServerIP",e[e.LobbyServerPort=3]="LobbyServerPort",e[e.Bind=4]="Bind",e[e.Freeze=5]="Freeze"}(PhotonRespEnum_Login||(PhotonRespEnum_Login={}));var PhotonRespData_Login=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"GetCorParamDic",{get:function(){return new Dictionary([{key:PhotonRespEnum_Login.SessionId,value:new FieldValue(FieldType.Int)},{key:PhotonRespEnum_Login.ErrorCode,value:new FieldValue(FieldType.Int,0)},{key:PhotonRespEnum_Login.LobbyServerIP,value:new FieldValue(FieldType.String)},{key:PhotonRespEnum_Login.LobbyServerPort,value:new FieldValue(FieldType.String)},{key:PhotonRespEnum_Login.Bind,value:new FieldValue(FieldType.Boolean)},{key:PhotonRespEnum_Login.Freeze,value:new FieldValue(FieldType.String,"")}])},enumerable:!0,configurable:!0}),t.prototype.GetValue=function(e){return this.GetMsgValue(PhotonRespEnum_Login,e)},Object.defineProperty(t.prototype,"IsFreezed",{get:function(){return!StringIsNullOrEmpty(this.GetValue(PhotonRespEnum_Login.Freeze))},enumerable:!0,configurable:!0}),t}(ServerValueParseBase);__reflect(PhotonRespData_Login.prototype,"PhotonRespData_Login");var PhotonRespEnum_LoginFormal;!function(e){e[e.ErrorCode=0]="ErrorCode",e[e.NickName=1]="NickName"}(PhotonRespEnum_LoginFormal||(PhotonRespEnum_LoginFormal={}));var PhotonRespData_LoginFormal=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"GetCorParamDic",{get:function(){return new Dictionary([{key:PhotonRespEnum_LoginFormal.ErrorCode,value:new FieldValue(FieldType.Int,0)},{key:PhotonRespEnum_LoginFormal.NickName,value:new FieldValue(FieldType.String,"")}])},enumerable:!0,configurable:!0}),t.prototype.GetValue=function(e){return this.GetMsgValue(PhotonRespEnum_LoginFormal,e)},t}(ServerValueParseBase);__reflect(PhotonRespData_LoginFormal.prototype,"PhotonRespData_LoginFormal");var LoginLobbyRequest;!function(e){e[e.SessionId=0]="SessionId",e[e.SreenSize=1]="SreenSize",e[e.NetWorkSpeed=2]="NetWorkSpeed",e[e.MachineCode=3]="MachineCode",e[e.Platform=4]="Platform",e[e.Version=5]="Version",e[e.DeviceModel=6]="DeviceModel"}(LoginLobbyRequest||(LoginLobbyRequest={}));var JoinRoomRequest;!function(e){e[e.GameID=0]="GameID",e[e.RoomID=1]="RoomID",e[e.Version=2]="Version",e[e.Auto=3]="Auto"}(JoinRoomRequest||(JoinRoomRequest={}));var PhotonHandler_Game=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.HandlerKey="Game",t.SessionID=0,t}return __extends(t,e),t.prototype.SetParams=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.SessionID=e[0]},t.prototype.OnConnect=function(){this.Send(PhotonProtocol.LoginLobbyRequest,[{Key:LoginLobbyRequest.SessionId,Value:this.SessionID,ValueType:FieldType.Int},{Key:LoginLobbyRequest.NetWorkSpeed,Value:0,ValueType:FieldType.Int},{Key:LoginLobbyRequest.SreenSize,Value:"0",ValueType:FieldType.String},{Key:LoginLobbyRequest.MachineCode,Value:"N/A",ValueType:FieldType.String},{Key:LoginLobbyRequest.Platform,Value:7,ValueType:FieldType.Int},{Key:LoginLobbyRequest.DeviceModel,Value:"PC",ValueType:FieldType.String},{Key:LoginLobbyRequest.Version,Value:GlobalValue.Version,ValueType:FieldType.String}])},t.prototype.ExeAction=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];switch(e.prototype.ExeAction.apply(this,[t].concat(n)),t){case"JoinRoom":this.Send(PhotonProtocol.JoinGameRoomRequest,[{Key:JoinRoomRequest.GameID,Value:GlobalValue.GameID,ValueType:FieldType.Int},{Key:JoinRoomRequest.RoomID,Value:0,ValueType:FieldType.Int},{Key:JoinRoomRequest.Version,Value:GlobalValue.Version,ValueType:FieldType.String},{Key:JoinRoomRequest.Auto,Value:!0,ValueType:FieldType.Boolean}]);break;case"GetSlotGameResult":var i=BigNumDiv(AppData.Account.BetTotal.toString(),AppData.Account.BaseBet.toString(),GlobalValue.NumberDigits);this.Send(PhotonProtocol.GetSlotGameResultRequest,[{Key:GetSlotGameResultRequest.Money,Value:[i],ValueType:FieldType.Array},{Key:GetSlotGameResultRequest.Jackpot,Value:!1,ValueType:FieldType.Boolean}]);break;case"GetBorderGameResult":var a=n[0];this.Send(PhotonProtocol.GetBorderGameRequest,a)}},t.prototype.OnMsg=function(e,t){switch(e!=PhotonProtocol.GetJackpotResponse&&Debug.LogWarningWithFlag("<<Lobby Handler>>「"+PhotonProtocol[e]+"」Response : "+JSON.stringify(t)),e){case PhotonProtocol.LoginLobbyResponse:var n=new PhotonRespData_Lobby(t);this.HandleError(n.GetValue(PhotonRespEnum_Lobby.ErrorCode))&&(AppData.Account.Money=n.GetValue(PhotonRespEnum_Lobby.Money),AppData.Account.WalletType=n.GetValue(PhotonRespEnum_Lobby.WalletType),AppData.Account.LobbyID=n.GetValue(PhotonRespEnum_Lobby.LobbyID),this.JoinGameRoom());break;case PhotonProtocol.JoinGameRoomResponse:var n=new PhotonRespData_JoinRoom(t);if(this.HandleError(n.GetValue(PhotonRespEnum_JoinRoom.ErrorCode))){var o=GlobalValue.GetCustomStringValue("coinSymbol");AppData.Account.Symbol=StringIsNullOrEmpty(o)?n.GameSymbol.GetValue(PhotonRespEnum_GameSymbol.Symbol):o,AppData.Account.MaxBetRate=n.GameSymbol.GetValue(PhotonRespEnum_GameSymbol.MaxBetRate),AppData.Account.MinBetRate=n.GameSymbol.GetValue(PhotonRespEnum_GameSymbol.MinBetRate),AppData.Account.BetMultiples=n.GameSymbol.GetValue(PhotonRespEnum_GameSymbol.BetMultiples),AppData.Account.CashScale=n.GameSymbol.GetValue(PhotonRespEnum_GameSymbol.CashScale),AppData.Account.CashDigits=n.GameSymbol.GetValue(PhotonRespEnum_GameSymbol.CashDigits),AppData.Account.JPCashType=n.GameSymbol.GetValue(PhotonRespEnum_GameSymbol.JPCashType);var i=n.GameSymbol.GetValue(PhotonRespEnum_GameSymbol.DefaultRate);AppData.Account.CoinIndex=i-1;var a=n.GameSymbol.GetValue(PhotonRespEnum_GameSymbol.CustomDisplayCashScale);a>0?AppData.Account.CustomDisplayCashScale=1/a:0>a&&(AppData.Account.CustomDisplayCashScale=Math.abs(a)),AppData.Account.BetSizes=n.GameBet.GetValue(PhotonRespEnum_GameBet.BetSizes),AppData.Account.BaseBet=n.GameBet.GetValue(PhotonRespEnum_GameBet.BaseBet);for(var r=n.GameBet.GetValue(PhotonRespEnum_GameBet.DefaultBet),s=0,l=AppData.Account.BetSizes.length;l>s;s++)if(r==AppData.Account.BetSizes[s]){AppData.Account.BetSizeDefaultIndex=s;break}Method.EachArrayItemMultiplyValue(AppData.Account.BetMultiples,.01*AppData.Account.CustomDisplayCashScale),AppData.Account.BetSizes.length>0&&AppData.Account.BetMultiples.length>0?AppData.Account.BetTotal=Method.MultiplyValues(GlobalValue.NumberDigits,AppData.Account.BetSizes[AppData.Account.BetSizeDefaultIndex],AppData.Account.BetMultiples[0],AppData.Account.BaseBet):Debug.LogError("BetSizes.length = 0 or BetMultiples.length = 0"),this.JoinGameRoomFinish()}break;case PhotonProtocol.GetSlotGameResultResponse:case PhotonProtocol.GetBorderGameResponse:try{this.ExeCallback(e,t)}catch(u){Debug.LogErrorWithFlag("e : "+u),MsgWindow.ShowMsgWithTitle_OKOnly(e.toString(),LanguageManager.GetText("SocketError"),function(){GlobalMethod.ReloadPage()})}}},t.prototype.JoinGameRoom=function(){var e=PhotonManager.ins.GetGameConnector();PhotonManager.ins.EnterRoom(this.Callback,this,e),this.ExeCallback(PhotonProtocol.LoginLobbyResponse)},t.prototype.JoinGameRoomFinish=function(){this.ExeCallback(PhotonProtocol.JoinGameRoomResponse)},t}(PhotonHandlerBase);__reflect(PhotonHandler_Game.prototype,"PhotonHandler_Game");
var PhotonHandler_GetBalance=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.HandlerKey="GetBalance",t}return __extends(t,e),t.prototype.ExeAction=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];switch(e.prototype.ExeAction.apply(this,[t].concat(n)),t){case"GetBalance":this.Send(PhotonProtocol.GetBalanceRequest)}},t.prototype.OnMsg=function(e,t){switch(e){case PhotonProtocol.GetBalanceResponse:var n=new PhotonRespData_GetBalance(t);this.ExeCallback(e,n)}},t}(PhotonHandlerBase);__reflect(PhotonHandler_GetBalance.prototype,"PhotonHandler_GetBalance");var GetSlotGameResultRequest;!function(e){e[e.Money=0]="Money",e[e.Jackpot=1]="Jackpot"}(GetSlotGameResultRequest||(GetSlotGameResultRequest={}));var GetJackpotRequest;!function(e){e[e.GameID=0]="GameID"}(GetJackpotRequest||(GetJackpotRequest={}));var PhotonHandler_GetJackpot=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.HandlerKey="GetJackpot",t}return __extends(t,e),t.prototype.ExeAction=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];switch(e.prototype.ExeAction.apply(this,[t].concat(n)),t){case"GetJackpot":this.Send(PhotonProtocol.GetJackpotRequest,[{Key:GetJackpotRequest.GameID,Value:GlobalValue.GameID,ValueType:FieldType.Int}])}},t.prototype.OnMsg=function(e,t){switch(e){case PhotonProtocol.GetJackpotResponse:var n=JSON.parse(JSON.stringify(t)),o=[];if(IsNullOrUndefined(n.length)){n=JSON.parse(JSON.stringify(t[0]));for(var i=0,a=n.length;a>i;i++)o.push(new PhotonRespData_GetJackpot(n[i]))}else for(var i=0,a=n.length;a>i;i++)o.push(new PhotonRespData_GetJackpot(n[i]));this.ExeCallback(e,o)}},t}(PhotonHandlerBase);__reflect(PhotonHandler_GetJackpot.prototype,"PhotonHandler_GetJackpot");var LoginAccountRequest_Formal;!function(e){e[e.Version=0]="Version",e[e.Channel=1]="Channel",e[e.MachineCode=2]="MachineCode",e[e.Data=3]="Data"}(LoginAccountRequest_Formal||(LoginAccountRequest_Formal={}));var LoginAccountRequest_Test;!function(e){e[e.Account=0]="Account",e[e.ThirdPartyAccount=1]="ThirdPartyAccount",e[e.Password=2]="Password",e[e.BindStatus=3]="BindStatus",e[e.DevicePlatform=4]="DevicePlatform",e[e.MachineCode=5]="MachineCode",e[e.Channel=6]="Channel",e[e.Firm=7]="Firm",e[e.IsFromRegistration=8]="IsFromRegistration"}(LoginAccountRequest_Test||(LoginAccountRequest_Test={}));var PhotonHandler_Login=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.HandlerKey="Login",t.GetAccountKey="PlayerAccount",t.PlayerNickName="",t}return __extends(t,e),t.prototype.OnConnect=function(){var e=(new PhotonMsgBuilder,GlobalValue.GetCustomIntValue("channelId",1));switch(GlobalValue.GameMode){case GameMode.Formal:this.Send(PhotonProtocol.LoginAccountRequest_Formal,[{Key:LoginAccountRequest_Formal.Version,Value:GlobalValue.Version,ValueType:FieldType.String},{Key:LoginAccountRequest_Formal.Channel,Value:e,ValueType:FieldType.Int},{Key:LoginAccountRequest_Formal.MachineCode,Value:"n/a",ValueType:FieldType.String},{Key:LoginAccountRequest_Formal.Data,Value:decodeURIComponent(GlobalValue.GetCustomStringValue("data","")),ValueType:FieldType.String}]);break;case GameMode.TestServer:var t=this.GetPlayerAccount();this.Send(PhotonProtocol.LoginAccountRequest,[{Key:LoginAccountRequest_Test.Account,Value:t,ValueType:FieldType.String},{Key:LoginAccountRequest_Test.ThirdPartyAccount,Value:t,ValueType:FieldType.String},{Key:LoginAccountRequest_Test.Password,Value:"",ValueType:FieldType.String},{Key:LoginAccountRequest_Test.BindStatus,Value:0,ValueType:FieldType.Int},{Key:LoginAccountRequest_Test.DevicePlatform,Value:7,ValueType:FieldType.Int},{Key:LoginAccountRequest_Test.MachineCode,Value:t,ValueType:FieldType.String},{Key:LoginAccountRequest_Test.Channel,Value:e,ValueType:FieldType.Int},{Key:LoginAccountRequest_Test.Firm,Value:e,ValueType:FieldType.Int},{Key:LoginAccountRequest_Test.IsFromRegistration,Value:!1,ValueType:FieldType.Boolean}])}},t.prototype.GetPlayerAccount=function(){var e="";switch(GlobalValue.GameMode){case GameMode.Formal:e=egret.localStorage.getItem(this.GetAccountKey),StringIsNullOrEmpty(e)&&(e=Method.GetNewGuid(),egret.localStorage.setItem(this.GetAccountKey,e));break;case GameMode.TestServer:e=Method.GetNewGuid()}return e},t.prototype.OnMsg=function(e,t){switch(e){case PhotonProtocol.LoginAccountResponse:var n=new PhotonRespData_Login(t);if(this.HandleError(n.GetValue(PhotonRespEnum_Login.ErrorCode)))if(n.IsFreezed)MsgWindow.ShowMsgWithTitle_OKOnly("Error","Freeze : "+n.GetValue(PhotonRespEnum_Login.ErrorCode).toString(),function(){GlobalMethod.ReloadPage()});else{var o="wss://"+n.GetValue(PhotonRespEnum_Login.LobbyServerIP)+":"+n.GetValue(PhotonRespEnum_Login.LobbyServerPort),i=n.GetValue(PhotonRespEnum_Login.SessionId);this.LoginLobby(o,i)}break;case PhotonProtocol.LoginAccountResponse_Formal:var n=new PhotonRespData_LoginFormal(t);this.HandleError(n.GetValue(PhotonRespEnum_LoginFormal.ErrorCode))&&(AppData.Account.NickName=n.GetValue(PhotonRespEnum_LoginFormal.NickName))}},t.prototype.LoginLobby=function(e,t){var n=PhotonManager.ins.GetGameHandler();PhotonManager.ins.LoginLobby(e,t,this.Callback,n,null),this.ExeCallback(PhotonProtocol.LoginAccountResponse,e,t)},t}(PhotonHandlerBase);__reflect(PhotonHandler_Login.prototype,"PhotonHandler_Login");var AppMain=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.UseFakeData=!1,t}return __extends(t,e),t.prototype.SetupMaxThreadCount=function(){RES.setMaxLoadingThread(32)},t.prototype.Start=function(t){switch(e.prototype.Start.call(this,t),Time.FIXED_UPDATE_DELTA_TIME=32,GlobalValue.GameMode){case GameMode.Local:Debug.init(!0)}},t.prototype.SetupCanvasEdge=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},t.prototype.FilterLanguage=function(e){switch(e){case LanguageType.CN:return LanguageType.CN;case LanguageType.TW:return LanguageType.CN;case LanguageType.EN:return LanguageType.EN;case LanguageType.TH:return LanguageType.TH;case LanguageType.VN:return LanguageType.VN}return LanguageType.EN},t.prototype.OnLoadLoadingComplete=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.LoadingView=new LoadingView,this.LoadingView.Init(FUIManager.CreateEObjToSceneByPackageName("Loading","Loading")),this.LoadingView.SetProgressTextActive(!0),this.LoadingView.SetActive(!0),[2]})})},t.prototype.OnLoadPreloadComplete=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(e.prototype.OnLoadPreloadComplete.call(this),this.MsgWindow=new MsgWindow,this.MsgWindow.Init(FUIManager.CreateEObjToSceneByPackageName("MsgWindow","MsgWindow")),GlobalValue.GameMode){case GameMode.Local:WebSocketManager.ins.RegisterGetFakeDataHandler(new WebSocketFakeData)}return[2]})})},t.prototype.LoadExtensionResources=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:switch(e=GlobalValue.GameMode){case GameMode.Local:return[3,1]}return[3,4];case 1:return this.UseFakeData?[4,RES.loadGroup("WebSocketFakeData")]:[3,3];case 2:t.sent(),t.label=3;case 3:return[3,4];case 4:return[2]}})})},t.prototype.OnHttpResp=function(e,t){this.GameScene.OnHttpResp(e,t)},t.prototype.GetLoginLobbyHandler=function(){return new HttpHandler_FishingLoginLobby},t.prototype.InitGameScene=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.GameScene=new GameManager,this.GameScene.Init(this),[2]})})},t.prototype.OnStartGameReady=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.GameScene.Start(),GlobalValue.GetCustomBoolValue("autoSkip",!1)?(Debug.LogWarning("自動跳過「Click to continue」畫面 (測試方便功能)"),[4,Time.WaitForSecond(1)]):[3,2];case 1:return e.sent(),this.LoadingView.SetActive(!1),this.LoadingView.SetSkipBtnActive(!1),[3,3];case 2:this.LoadingView.SetSkipBtnActive(!0),e.label=3;case 3:return[2]}})})},t}(Main);__reflect(AppMain.prototype,"AppMain");var GameTypeState;!function(e){e[e.Lobby=0]="Lobby",e[e.Game=1]="Game"}(GameTypeState||(GameTypeState={}));var GameManager=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t,"ins",{get:function(){return null==this.Instance&&(this.Instance=new t),this.Instance},enumerable:!0,configurable:!0}),t.prototype.Init=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(o){return t.Instance=this,e.prototype.Init.apply(this,n),[2]})})},t}(FishingGameManagerBase);__reflect(GameManager.prototype,"GameManager");var WebSocketFakeData=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.FishID=99,t.LotteryType=0,t.FakeMoney=1e5,t}return __extends(t,e),t.prototype.GetFakeResponse=function(e,t,n){var o="WebSocketResp_"+(t>=0?e+"_"+t:e)+"_txt";e.indexOf("UpdateFish_")>=0&&(o="WebSocketResp_UpdateFish_Temp_txt");var i=ResManager.GetJson(o);switch(i||Debug.Log("讀取不到假資料 : resName = "+o),Debug.LogWarning("收到 : "+e),e){case"JoinRoom":return this.HandleJoinRoomResponse(i);case"HitFish":return this.HandleHitFishResponse(i,n);case"SpecialHitFish":return this.HandleHitFishResponse(i,n);case"ShootSpecialBullet":return this.HandleShootSpecialBulletResponse(i,n)}return e.indexOf("UpdateFish_")>=0?this.HandleUpdateFishResponse(i,e):JSON.stringify(i)},t.prototype.HandleUpdateFishResponse=function(e,t){var n=Method.GetLastStringAsIndex(t),o=e.Data;return this.FishID++,o.AddFish[0].FishID=this.FishID.toString(),o.AddFish[0].FSType=n,this.GetRespFormat("UpdateFish",o)},t.prototype.HandleShootSpecialBulletResponse=function(e,t){var n=e.Data,o=t.Data;return n.PlayerSeat=Method.ParseValueToNumber(o.PlayerSeat,0),n.BulletType=Method.ParseValueToNumber(o.BulletType,0),n.BulletCount=GameManager.ins.Data.Seat[n.PlayerSeat].SpecialWeaponBulletCount,this.GetRespFormat("GetSpecialBulletResult",n)},t.prototype.HandleJoinRoomResponse=function(e){var t=e.Data;return t.Seat=GlobalValue.GetCustomIntValue("seat",0),this.GetRespFormat("JoinRoom",t)},t.prototype.HandleHitFishResponse=function(e,t){for(var n=e.Data,o=t.Data,i=o.FishID,a=i.split(","),r=0,s=a.length;s>r;r++){n.DieOrRemoveFish[r]||n.DieOrRemoveFish.push(new RemoveFishRespData);var l=Method.ParseValueToNumber(o.BulletBet,1);l||(l=Method.RandomIntRange(100,150)),n.DieOrRemoveFish[r].BulletBet=l,n.DieOrRemoveFish[r].WinScore=l*GlobalValue.ClientToServerMoneyScale*12,n.DieOrRemoveFish[r].WinScore||(n.DieOrRemoveFish[r].WinScore=0),n.DieOrRemoveFish[r].HitSeat=Method.ParseValueToNumber(o.PlayerSeat,0),n.DieOrRemoveFish[r].FishID=a[r],n.DieOrRemoveFish[r].Hit=!0,n.DieOrRemoveFish[r].HitDieRemove=!0,n.DieOrRemoveFish[r].OddLotteryType=Method.LoopRange(this.LotteryType++,0,4),n.DieOrRemoveFish[r].PlayerBalance=GameManager.ins.Data.Seat[n.DieOrRemoveFish[r].HitSeat].Balance+n.DieOrRemoveFish[r].WinScore}GameManager.ins.Data.Fishes[n.DieOrRemoveFish[0].FishID];return this.GetRespFormat("UpdateFish",n)},t.prototype.GetRespFormat=function(e,t){var n=JSON.stringify(t);return'{ "OpCode": "'+e+'", "ErrorCode": "", "Data": '+n+" }"},t.prototype.HandleLoginLobbyResponse=function(e){var t=e.Data;return null==t&&(t=new WebSocketRespData_Login),this.Fake$Money=MathMul(this.FakeMoney,GlobalValue.ClientToServerMoneyScale,GlobalValue.NumberDigits),this.Fake$Money>0&&(e.Data=t),JSON.stringify(e)},t.prototype.HandleGetBalanceResponse=function(e){return JSON.stringify(e)},t}(WebSocketFakeDataBase);__reflect(WebSocketFakeData.prototype,"WebSocketFakeData");var FishType;!function(e){e[e.none=0]="none",e[e.fish_1=1]="fish_1",e[e.fish_2=2]="fish_2",e[e.fish_3=3]="fish_3",e[e.fish_4=4]="fish_4",e[e.fish_5=5]="fish_5",e[e.fish_6=6]="fish_6",e[e.fish_7=7]="fish_7",e[e.fish_8=8]="fish_8",e[e.fish_9=9]="fish_9",e[e.fish_10=10]="fish_10",e[e.fish_11=11]="fish_11",e[e.fish_12=12]="fish_12",e[e.fish_13=13]="fish_13",e[e.fish_14=14]="fish_14",e[e.fish_15=15]="fish_15",e[e.fish_16=16]="fish_16",e[e.fish_17=17]="fish_17",e[e.fish_18=18]="fish_18",e[e.fish_19=19]="fish_19",e[e.fish_20=20]="fish_20",e[e.fish_21=21]="fish_21",e[e.fish_22=22]="fish_22",e[e.fish_23=23]="fish_23",e[e.fish_24=24]="fish_24",e[e.fish_25=25]="fish_25",e[e.fish_26=26]="fish_26"}(FishType||(FishType={}));var WebSocketHandler_ThisGame=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.ExeAction=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];e.prototype.ExeAction.apply(this,[t].concat(n))},t.prototype.SimulateFakeData=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return WebSocketManager.ins.SendFakeRespMsg("GetGameInitDataResult"),[4,Time.WaitForDeltaTime()];case 1:return e.sent(),WebSocketManager.ins.SendFakeRespMsg("UpdateFish"),[4,Time.WaitForSecond(3)];case 2:return e.sent(),[2]}})})},t.prototype.OnMsg=function(t){e.prototype.OnMsg.call(this,t);var n=JSON.parse(t);if(n){n.OpCode}},t}(FishingWebSocketHandlerBase_ThisGame);__reflect(WebSocketHandler_ThisGame.prototype,"WebSocketHandler_ThisGame");var GameSettings=function(){function e(){}return e.BulletBufferRange=30,e.BulletJudgeHitRange=40,e.SceneMaxBulletCount=20,e.MaxBatteryCount=4,e.MaxSeatCount=4,e.FlameWeaponIndex=5,e.NuclearWeaponIndex=6,e.LaserWeaponIndex=7,e.AutoShootSpecialWeaponMaxSec=10,e.MaxATKSelectBtnCount=10,e.ShootInterval=[.5,.35,.25],e.AFKShootBulletCount=[10,100,500,1e3,5e3,1e4],e.SeatShootPos=[new Vector2(191,688),new Vector2(452,688),new Vector2(827,688),new Vector2(1088,688)],e}();__reflect(GameSettings.prototype,"GameSettings");var BulletCtrller=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(BulletCtrllerBase);__reflect(BulletCtrller.prototype,"BulletCtrller");var CommonCtrller=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.OnClickWalletConfirmBtn=function(){switch(GameManager.ins.CurGameState){case GameTypeState.Lobby:e.prototype.OnClickWalletConfirmBtn.call(this);break;case GameTypeState.Game:AudioPlayer.PlaySound("Button_001_mp3"),GameManager.ins.MainCtrller.OnClickWalletConfirmBtn(this.Data.ExchangeAmount,this.Data.AutoExchangeBalance)}},t.prototype.OnClickWalletBtn=function(){e.prototype.OnClickWalletBtn.call(this);var t=GameManager.ins.LobbyData;switch(GameManager.ins.CurGameState){case GameTypeState.Lobby:SendTool.SendData("GetWalletExchangeResult","0",t.Balance,GlobalValue.GameGroup,null);break;case GameTypeState.Game:var n=t.RoomInfo[t.CurRoomIndex];n?SendTool.SendData("GetWalletExchangeResult",n.MinBalance,n.MaxBalance,n.GameType,function(e){GameManager.ins.MainCtrller.UpdateUI()}):Debug.LogError("取得房間資訊錯誤 : "+t.CurRoomIndex)}},t.prototype.OnClickExitBtn=function(){switch(GameManager.ins.CurGameState){case GameTypeState.Lobby:AudioPlayer.PlaySound("Button_001_mp3"),MsgWindow.ShowLangMsg_OKCancel("Msg_QuitGame",function(e,t){GameDataBase.ClickUIBtn=!0,t==MsgWindowBtnType.LeftBtn&&GlobalMethod.ReturnToHome()});break;case GameTypeState.Game:e.prototype.OnClickExitBtn.call(this)}},t}(FishingCommonCtrllerBase);__reflect(CommonCtrller.prototype,"CommonCtrller");var FishCtrller=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Init=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return e.prototype.Init.apply(this,t),[2]})})},t.prototype.OnHitOrKillFish=function(e){var t=GameManager.ins.Views[e.HitSeat],n=GameManager.ins.Ctrllers[e.HitSeat],o=this.Data.Fishes.GetValueByKey(e.FishID);if(o&&t&&n){switch(o.FishType){case FishType.fish_25:AudioPlayer.PlaySound("WinSpecial_001_mp3");break;case FishType.fish_17:case FishType.fish_18:case FishType.fish_19:AudioPlayer.PlaySound("WinBoss_001_mp3");break;default:var i=this.Data.FishSetting[o.FishType];switch(i.GroupIndex){case 0:AudioPlayer.PlaySound("WinFish_001_mp3");break;case 1:AudioPlayer.PlaySound("WinFish_002_mp3");break;case 2:AudioPlayer.PlaySound("WinFish_003_mp3")}}switch(o.FishType){case FishType.fish_25:t.ShowEffect_FishType_25(e.OddLotteryType,o.FishObj.x,o.FishObj.y,e.WinScore);break;case FishType.fish_17:case FishType.fish_18:case FishType.fish_19:switch(t.PlayScreenShake(),t.ShowScoreEffect(HitFishBaseEffectType.Big,o.FishObj.x,o.FishObj.y,e.WinScore),t.ShowSettlement(e.WinScore,o.FishType),o.FishType){case FishType.fish_17:this.View.PlayWarningTip(WarningType.BOSS_A_Loss);break;case FishType.fish_18:this.View.PlayWarningTip(WarningType.BOSS_B_Loss);break;case FishType.fish_19:this.View.PlayWarningTip(WarningType.BOSS_C_Loss)}break;case FishType.fish_22:n.DisableAutoShoot(),t.ShowEffect_GetSpecialWeapon(WeaponType.Flame,o.FishObj.x,o.FishObj.y,function(){n.EnableSpecialWeaponMode(WeaponType.Flame)});break;case FishType.fish_23:this.Data.Seat[e.HitSeat]&&(this.Data.Seat[e.HitSeat].LaserMoney=e.WinScore),n.DisableAutoShoot(),t.ShowEffect_GetSpecialWeapon(WeaponType.Laser,o.FishObj.x,o.FishObj.y,function(){n.EnableSpecialWeaponMode(WeaponType.Laser)});break;case FishType.fish_24:n.DisableAutoShoot(),t.ShowEffect_GetSpecialWeapon(WeaponType.Bomb,o.FishObj.x,o.FishObj.y,function(){n.EnableSpecialWeaponMode(WeaponType.Bomb)});break;default:var i=this.Data.FishSetting[o.FishType];switch(i.GroupIndex){case 0:t.ShowScoreEffect(HitFishBaseEffectType.Small,o.FishObj.x,o.FishObj.y,e.WinScore);break;case 1:t.ShowScoreEffect(HitFishBaseEffectType.Mid,o.FishObj.x,o.FishObj.y,e.WinScore);break;case 2:t.ShowSettlement(e.WinScore,o.FishType),t.ShowScoreEffect(HitFishBaseEffectType.Big,o.FishObj.x,o.FishObj.y,e.WinScore)}}null!=o.FishObj.GetAniObj("die")&&o.FishObj.PlayAni("die")}},t.prototype.UpdateFishTransform=function(t,n,o){switch(t.FishType){case FishType.fish_10:case FishType.fish_19:case FishType.fish_22:case FishType.fish_23:case FishType.fish_24:case FishType.fish_25:case FishType.fish_26:this.View.UpdateFishMove(t,n.x,n.y,0),n.x-t.LastX>0?t.FishObj.SetScale(1,t.FishObj.Scale.y):n.x-t.LastX<0&&t.FishObj.SetScale(-1,t.FishObj.Scale.y),t.LastX=n.x,t.LastY=n.y;break;default:e.prototype.UpdateFishTransform.call(this,t,n,o)}},t.prototype.OnAddFish=function(e,t){if(t.FishObj)switch(e.FSType){case FishType.fish_10:case FishType.fish_22:case FishType.fish_24:case FishType.fish_25:case FishType.fish_26:t.FishObj.Depth=2;break;case FishType.fish_17:case FishType.fish_18:case FishType.fish_19:t.FishObj.Depth=0;break;default:t.FishObj.Depth=1}switch(e.FSType){case FishType.fish_17:break;case FishType.fish_18:break;case FishType.fish_19:}},t.prototype.PlayIdleAni=function(e){e.FishObj.PlayGLoaderAni(),e.FishObj.PlayAni("idle"),e.FishDBObj.HasAni("walk")?e.FishDBObj.PlayAni("walk"):e.FishDBObj.PlayAni("idle")},t.prototype.OnWaveHitFish=function(t,n){t.FishWave||(t.FishWave=!0,null!=t.FishObj.GetAniObj("die")?(t.FishObj.PlayAni("die"),this.RecycleFish(t.ID,t.FishType,t.FishObj)):e.prototype.RecycleFish.call(this,t.ID,t.FishType,t.FishObj))},t.prototype.RecycleFish=function(t,n,o){return __awaiter(this,void 0,void 0,function(){var i,a;return __generator(this,function(r){switch(r.label){case 0:return i=0,this.ClearFlag?[3,3]:[3,1];case 1:switch(n){case 22:case 23:case 24:case 25:return e.prototype.RecycleFish.call(this,t,n,o),[2];case 1:i=18;break;case 2:i=23;break;case 3:i=28;break;case 4:i=23;break;case 5:i=18;break;case 6:i=32;break;case 7:i=28;break;case 8:i=32;break;case 9:i=38;break;case 10:i=24;break;case 11:case 12:case 13:case 14:case 15:case 16:i=20;break;case 17:i=120;break;case 18:i=140;break;case 19:i=160;break;case 20:i=36;break;case 21:i=26;break;case 26:i=40}return a=i/24,[4,Time.WaitForSkippableSeconds(a)];case 2:r.sent(),r.label=3;case 3:return e.prototype.RecycleFish.call(this,t,n,o),[2]}})})},t}(FishCtrllerBase);__reflect(FishCtrller.prototype,"FishCtrller");var FlameCtrller=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AllowShoot=!1,t.SendIntervalDuration=.5,t.HitedFishesID=[],t}return __extends(t,e),Object.defineProperty(t.prototype,"DetectPointCount",{get:function(){return 4},enumerable:!0,configurable:!0}),t.prototype.Init=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return e.prototype.Init.apply(this,t),[2]})})},t.prototype.Clear=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.HitedFishesID=[],Time.UnregisterByKey(this.UpdateKey)},t.prototype.EnableAim=function(){this.AllowShoot=!0},t.prototype.Shoot=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(t){switch(t.label){case 0:return this.AllowShoot?(this.AllowShoot=!1,this.Clear(),this.View.PlayFlameAni("Shoot"),this.IsSelfPlayer?(this.UpdateKey=Time.RegisterAndStopKey(function(t){e.PointEObj[0].ActiveSelf&&e.DetectHitedFish(!1)},this.UpdateKey),this.IntervalCallback(),AudioPlayer.PlaySound("CannonFlame_001_mp3"),[4,Time.WaitForSecond(1.1)]):[3,2]):[2];case 1:t.sent(),this.Callback(this.HitedFishesID),t.label=2;case 2:return this.Clear(),[2]}})})},t.prototype.IntervalCallback=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.PointEObj[0].ActiveSelf?(this.Callback(this.HitedFishesID),this.HitedFishesID=[],[4,Time.WaitForSecond(this.SendIntervalDuration)]):[3,2];case 1:return e.sent(),[3,0];case 2:return[2]}})})},t.prototype.OnHitFish=function(e,t,n){this.HitedFishesID.indexOf(e.ID)<0&&this.HitedFishesID.push(e.ID)},t}(BulletColCtrllerBase);__reflect(FlameCtrller.prototype,"FlameCtrller");var GameCtrller_Self=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.AbleToRotateBattery=function(){return this.SeatData.IsFlameMode?!0:this.SeatData.IsNuclearMode?this.NuclearCtrller.AllowShoot?!0:!1:this.SeatData.IsLaserMode?this.LaserCtrller.AllowShoot?!0:!1:e.prototype.AbleToRotateBattery.call(this)},t.prototype.Init=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return e.prototype.Init.apply(this,t),[2]})})},t.prototype.OnSwipEnd=function(e,t){},t.prototype.UpdateBattery=function(){},t.prototype.EnableSpecialWeaponMode=function(e){},t.prototype.OnTouchFish=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},t.prototype.ShootSpecialWeapon=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},t.prototype.OnSpecialWeaponHitFishes=function(e,t){},t.prototype.ClickGameBtn=function(e,t){void 0===t&&(t=null)},Object.defineProperty(t.prototype,"FilterSelectType",{get:function(){return[17,18,19,20,21,22,23,24,25,26]},enumerable:!0,configurable:!0}),t.prototype.SetupAbleSelectType=function(){},t}(FishingGameCtrllerBase_Self);__reflect(GameCtrller_Self.prototype,"GameCtrller_Self");var HttpManager=function(){function e(){this.Handlers=[],this.PingDic=new Dictionary,this.PingKeyDic=new Dictionary}return Object.defineProperty(e,"ins",{get:function(){return null==this.Instance&&(this.Instance=new e),this.Instance},enumerable:!0,configurable:!0}),e.prototype.Request=function(e,t,n,o){var i=this,a=new egret.HttpRequest;a.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),ServerDebug.Log("Http Call : "+e),ServerDebug.Log("Http POST : "+t),a.responseType=egret.HttpResponseType.TEXT,this.StartCalcPing(o),a.once(egret.Event.COMPLETE,function(e){i.StopCalcPing(o);var t=e.currentTarget;ServerDebug.Log("Http response : "+t.response),i.SendResponse(t.response,o),n&&n(t.response,o)},this),a.open(e,egret.HttpMethod.POST),a.withCredentials=!1,a.send(t)},e.prototype.SendResponse=function(t,n){for(var o=0,i=this.Handlers.length;i>o;o++)this.Handlers[o]&&this.Handlers[o].OnMsg(t,n);SendTool.SendData(e.RespEventAction,t,n)},e.prototype.RegisterHandler=function(e,t){return void 0===t&&(t=null),this.Handlers.indexOf(e)<0&&this.Handlers.push(e),e.Init(t),e},e.prototype.UnregisterHandler=function(e){var t=this.Handlers.indexOf(e);t>=0&&this.Handlers.splice(t,1)},e.prototype.StartCalcPing=function(e){this.PingDic.ContainsKey(e)||this.PingDic.Add(e,new PingData);var t=this.PingDic[e];t.TimeKey=Time.Register(function(e){t.TimeCounter+=e})},e.prototype.StopCalcPing=function(e){if(this.PingDic.ContainsKey(e)){var t=this.PingDic[e];t.SetToHistory(),Time.UnregisterByKey(t.TimeKey)}},e.prototype.GetPing=function(){for(var e=0,t=this.PingDic.Values,n=t.length,o=0;n>o;o++){var i=t[o];e+=i.Ping}return 0==n&&(n=1),e/n},e.RespEventAction="OnHttpResponse",e}();__reflect(HttpManager.prototype,"HttpManager");var LaserCtrller=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AllowShoot=!1,t.HitedFishesID=[],t}return __extends(t,e),Object.defineProperty(t.prototype,"DetectPointCount",{get:function(){return 4},enumerable:!0,configurable:!0}),t.prototype.Init=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return e.prototype.Init.apply(this,t),[2]})})},t.prototype.Clear=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.HitedFishesID=[],Time.UnregisterByKey(this.UpdateKey)},t.prototype.EnableAim=function(){this.AllowShoot=!0,this.View.PlayLaserAni("Aim")},t.prototype.Shoot=function(){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(t){switch(t.label){case 0:if(!this.AllowShoot)return[2];if(this.AllowShoot=!1,this.Clear(),this.View.PlayLaserAni("Shoot"),!this.IsSelfPlayer)return[3,7];this.UpdateKey=Time.RegisterAndStopKey(function(t){e.PointEObj[0].ActiveSelf&&e.DetectHitedFish(!1)},this.UpdateKey),t.label=1;case 1:return this.PointEObj[0].ActiveSelf?[3,3]:[4,Time.WaitForDeltaTime()];case 2:return t.sent(),[3,1];case 3:return this.Shake(),AudioPlayer.PlaySound("CannonLaser_001_mp3"),[4,Time.WaitForSecond(.25)];case 4:t.sent(),this.Callback(this.HitedFishesID),t.label=5;case 5:return this.PointEObj[0].ActiveSelf?[4,Time.WaitForDeltaTime()]:[3,7];case 6:return t.sent(),[3,5];case 7:return[4,Time.WaitForSecond(1.5)];case 8:return t.sent(),[2]}})})},t.prototype.Shake=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:e=0,t=4,n.label=1;case 1:return t>e?(this.View.PlayScreenShake(),[4,Time.WaitForSecond(.17)]):[3,4];case 2:n.sent(),n.label=3;case 3:return e++,[3,1];case 4:return[2]}})})},t.prototype.OnHitFish=function(e,t,n){this.HitedFishesID.indexOf(e.ID)<0&&this.HitedFishesID.push(e.ID)},t}(BulletColCtrllerBase);__reflect(LaserCtrller.prototype,"LaserCtrller");var LobbyCtrller=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.StateBegin=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return e.prototype.StateBegin.apply(this,t),this.View.ResetRoomBtnAni(),[2]})})},t}(FishingLobbyCtrllerBase);__reflect(LobbyCtrller.prototype,"LobbyCtrller");var NuclearCtrller=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.AllowShoot=!1,t}return __extends(t,e),t.prototype.Init=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return e.prototype.Init.apply(this,t),[2]})})},t.prototype.EnableAim=function(){this.AllowShoot=!0,this.View.PlayNuclearAni("Aim")},t.prototype.Shoot=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,o;return __generator(this,function(i){switch(i.label){case 0:return this.AllowShoot?(this.AllowShoot=!1,this.Clear(),AudioPlayer.PlaySound("ShootNuclear_mp3"),[4,this.View.PlayNuclearAni("Shoot")]):[2];case 1:return i.sent(),this.IsSelfPlayer?[4,Time.WaitForSecond(.5)]:[3,4];case 2:return i.sent(),AudioPlayer.PlaySound("CannonNuclear_001_mp3"),[4,Time.WaitForSecond(.5)];case 3:for(i.sent(),this.View.PlayScreenShake(),e=[],t=this.Data.Fishes.Values,n=0,o=t.length;o>n;n++)t[n].x>0&&t[n].x<GlobalValue.EgretElementWidth&&t[n].y>0&&t[n].y<GlobalValue.EgretElementHeight&&e.push(t[n].ID);this.Callback(e),i.label=4;case 4:return this.Clear(),[2]}})})},t}(BulletColCtrllerBase);__reflect(NuclearCtrller.prototype,"NuclearCtrller");var GameData=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(GameDataBase);__reflect(GameData.prototype,"GameData");var SeatData=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.IsFlameMode=!1,t.IsLaserMode=!1,t.IsNuclearMode=!1,t.LaserMoney=0,t}return __extends(t,e),t.prototype.Setup=function(t,n,o){e.prototype.Setup.call(this,t,n,o)},t.prototype.Clear=function(){e.prototype.Clear.call(this),this.IsFlameMode=!1,this.IsLaserMode=!1,this.IsNuclearMode=!1},t}(SeatDataBase);__reflect(SeatData.prototype,"SeatData");var CommonView=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.Init=function(t,n){return __awaiter(this,void 0,void 0,function(){var o,i,o,i,o,i,o,i,a,o,i,r;return __generator(this,function(s){for(e.prototype.Init.call(this,t,n),o=1,i=16;i>=o;o++)this.FishOddText.Add(o,[FUIManager.GetEObj(this.RootObj,"IntroPanel/IntroPage_1/OddText_"+o)]);for(o=17,i=21;i>=o;o++)this.FishOddText.Add(o,[FUIManager.GetEObj(this.RootObj,"IntroPanel/IntroPage_2/OddText_"+o)]);for(o=26,i=26;i>=o;o++)this.FishOddText.Add(o,[FUIManager.GetEObj(this.RootObj,"IntroPanel/IntroPage_2/OddText_"+o)]);for(o=22,i=24;i>=o;o++)this.FishOddText.Add(o,[FUIManager.GetEObj(this.RootObj,"IntroPanel/IntroPage_3/OddText_"+o)]);for(a=[],o=0,i=5;i>o;o++)r=FUIManager.GetEObj(this.RootObj,"IntroPanel/IntroPage_2/OddText_25-"+o),a.push(r);return this.FishOddText.Add(25,a),[2]})})},t.prototype.UpdateUI=function(){switch(GameManager.ins.CurGameState){case GameTypeState.Lobby:this.WalletBtn.Enabled=!1,this.LeaveBtn.Enabled=GlobalValue.GetCustomBoolValue("showHome",!1);break;case GameTypeState.Game:this.WalletBtn.Enabled=!0,this.LeaveBtn.Enabled=!0}e.prototype.UpdateUI.call(this)},t}(FishingCommonViewBase);__reflect(CommonView.prototype,"CommonView");var WarningType;!function(e){e[e.BOSS_A=0]="BOSS_A",e[e.BOSS_B=1]="BOSS_B",e[e.BOSS_C=2]="BOSS_C",e[e.BOSS_A_Loss=3]="BOSS_A_Loss",e[e.BOSS_B_Loss=4]="BOSS_B_Loss",e[e.BOSS_C_Loss=5]="BOSS_C_Loss"}(WarningType||(WarningType={}));var GameView_Self=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.IsBaseUIEnable=function(){return this.IsGettingSpecialWeapon?!0:e.prototype.IsBaseUIEnable.call(this)},t.prototype.Init=function(t,n,o){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){switch(i.label){case 0:return e.prototype.Init.call(this,t,n,o),this.FishWaveText=this.WarningTip.GetChild("WaveText"),this.BGUrl=["ui://si08n7lifk4i11d","ui://si08n7lid2u915w","ui://si08n7lid2u9169","ui://si08n7lid2u916c","ui://si08n7lifk4i11o","ui://si08n7lifk4i11p","ui://si08n7lifk4i11q"],this.GameBG.Depth=-1,[4,Time.WaitForSecond()];case 1:return i.sent(),[2]}})})},t.prototype.UpdateBG=function(){this.GameBG&&(-1==this.AssignBGIndex?this.GameBG.SetActive(!1):(this.GameBG.Icon=this.BGUrl[this.AssignBGIndex],this.GameBG.SetActive(!0)))},t.prototype.SetAFKPanelActive=function(t){if(e.prototype.SetAFKPanelActive.call(this,t),t)for(var n=0,o=this.AFKPanelOddText.length;o>n;n++)this.AFKPanelOddText[n]&&(this.AFKPanelOddText[n].Text=this.GetOddsTextString(this.MinOdds[n],this.MaxOdds[n]))
},t.prototype.PlayWarningTip=function(t){switch(e.prototype.PlayWarningTip.call(this,t),t){case WarningType.BOSS_A:case WarningType.BOSS_B:case WarningType.BOSS_C:AudioPlayer.PlaySound("RemindBoss_001_mp3")}this.WarningTip&&this.WarningTip.PlayAni(WarningType[t])},Object.defineProperty(t.prototype,"FishWaveDuration",{get:function(){return 1},enumerable:!0,configurable:!0}),t.prototype.PlayFishWaveTip=function(t){return __awaiter(this,void 0,void 0,function(){var n=this;return __generator(this,function(o){switch(o.label){case 0:return this.FixWaveTip(t),[4,e.prototype.PlayFishWaveTip.call(this,t)];case 1:return o.sent(),Time.DelayAction(this.FishWaveDuration,function(){switch(t.BackGroundID){case 4:n.PlayWarningTip(WarningType.BOSS_A);break;case 5:n.PlayWarningTip(WarningType.BOSS_B);break;case 6:n.PlayWarningTip(WarningType.BOSS_C)}}),[2]}})})},t.prototype.FixWaveTip=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,Time.WaitForSecond()];case 1:return t.sent(),e.BossID>=0?this.FishWaveText.Text=LanguageManager.GetText("WaveText_Boss"):this.FishWaveText.Text=LanguageManager.GetText("WaveText"),[2]}})})},t.prototype.SetMoneyNotEnoughTipActive=function(){e.prototype.SetMoneyNotEnoughTipActive.call(this),GameManager.ins.CommonCtrller.ClickCommonBtn("WalletBtn")},t}(FishingGameViewBase_Self);__reflect(GameView_Self.prototype,"GameView_Self");var SlotGameResultType;!function(e){e[e.GetSlotNormalGameResult=0]="GetSlotNormalGameResult",e[e.GetSlotFreeGameResult=1]="GetSlotFreeGameResult",e[e.GetSlotBonusGameResult=2]="GetSlotBonusGameResult"}(SlotGameResultType||(SlotGameResultType={}));var AudioPlayer=function(){function e(){}return e.Init=function(){var e=this;this.IsInited=!0,SendTool.Register(AppEvent[AppEvent.OnAppPause],this,function(){e.OnApplicationPause(!0)}),SendTool.Register(AppEvent[AppEvent.OnAppResume],this,function(){e.OnApplicationPause(!1)})},e.OnApplicationPause=function(e){e?(this.OriIsMute=this.IsMute,this.SetMute(!0)):this.OriIsMute||this.SetMute(!1)},e.SetVersion=function(e){this.AssignVersion=e},e.UrlAttachVersion=function(e){if(e.indexOf("v=")<0){var t=this.AssignVersion;t&&(e+=e.indexOf("?")<0?"?v="+t:"&v="+t)}return e},e.LoadAudios=function(e,t){return __awaiter(this,void 0,void 0,function(){var n,o,i,a,r,s,l,u,r,s;return __generator(this,function(c){switch(c.label){case 0:if(this.IsNullOrUndefined(e))return[3,4];for(n=e.resources,o=[],i=0,a=0,r=0,s=n.length;s>r;r++)"sound"===n[r].type&&(i++,l=n[r].name,u=this.UrlAttachVersion("resource/"+n[r].url),this.AudioKeyUrlDic[l]=u,o.push(new AudioClip(l,u,function(){a++})));c.label=1;case 1:return i>a?[4,this.WaitForSecond()]:[3,3];case 2:return c.sent(),[3,1];case 3:for(r=0,s=o.length;s>r;r++)null!=o[r]&&(o[r].Clear(),o[r]=null);return[3,5];case 4:Debug.LogWarning("Audio JsonText = null"),c.label=5;case 5:return null!=t&&t(),[2]}})})},e.IsBGMStopped=function(){return null!=this.PlayingBGM?!this.PlayingBGM.IsPlaying:!0},e.PlayBGM=function(e,t){return void 0===t&&(t=0),__awaiter(this,void 0,void 0,function(){var n,o;return __generator(this,function(i){switch(i.label){case 0:if(this.StringIsNullOrEmpty(e))return[2];if(null!=this.PlayingBGM&&e==this.PlayingBGM.Key&&this.PlayingBGM.IsPlaying)return[2];i.label=1;case 1:return this.IsInited?[3,3]:[4,this.WaitForSecond()];case 2:return i.sent(),[3,1];case 3:return n=this.AudioKeyUrlDic[e],this.StringIsNullOrEmpty(n)?(Debug.LogError("找不到 BGM : "+e),[2]):((!this.IsBGMActive||this.IsMute)&&(t=0),null!=this.PlayingBGM&&this.PlayingBGM.Key!=e?(o=this.PlayingBGM,o.FadeTo(0,t,function(){o.Clear()}),this.PlayingBGM=null):t=0,null==this.PlayingBGM&&(this.PlayingBGM=new AudioClip(e,n)),this.PlayingBGM.Loop=!0,this.PlayingBGM.FadeTo(this.BGMVolume,t),this.IsBGMActive?this.PlayingBGM.Play():this.PlayingBGM.Stop(),[2])}})})},e.PlaySound=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1),this.IsSoundActive&&this.ForcePlaySound(e,this.SoundVolume,t,n)},e.ForcePlaySound=function(e,t,n,o){return void 0===t&&(t=this.SoundVolume),void 0===n&&(n=null),void 0===o&&(o=!1),__awaiter(this,void 0,void 0,function(){var i,a,r,s=this;return __generator(this,function(l){return this.StringIsNullOrEmpty(e)?[2]:this.IsInited?(i=this.AudioKeyUrlDic[e],this.StringIsNullOrEmpty(i)?(Debug.LogWarning("找不到 Sound : "+e),[2]):(this.IsNullOrUndefined(this.LastTimeDic[e])&&(this.LastTimeDic[e]=0),a=(new Date).getTime(),a==this.LastTimeDic[e]?[2]:(this.LastTimeDic[e]=a,r=new AudioClip(e,i),this.PlayingSoundList[r.ID]=r,r.Audio.loop(o),r.Volume=t,o||(r.OnPlayEnd=function(e){null!=n&&n(),s.RemoveSound(e),r=null,e=null}),r.Play(),[2]))):[2]})})},e.RemoveSound=function(e){if(null!=e){var t=e.ID;e.Clear(),e=null,this.PlayingSoundList[t]=null}},e.PauseBGM=function(){null!=this.PlayingBGM&&this.PlayingBGM.Pause()},e.StopBGM=function(){null!=this.PlayingBGM&&this.PlayingBGM.Stop()},e.StopSound=function(e,t){var n=this;void 0===t&&(t=-1),t>=0?this.PlayingSoundList.forEach(function(e){return null!=e&&e.ID==t?(n.RemoveSound(e),void(e=null)):void 0}):this.StringIsNullOrEmpty(e)||this.PlayingSoundList.forEach(function(t){null!=t&&t.Key==e&&(n.RemoveSound(t),t=null)})},e.StopAllSounds=function(){var e=this;this.PlayingSoundList.forEach(function(t){e.RemoveSound(t),t=null}),this.PlayingSoundList=[]},Object.defineProperty(e,"IsAudioMute",{get:function(){return this.IsMute},enumerable:!0,configurable:!0}),e.SetMute=function(e){if(this.IsInited)if(e){if(this.IsMute)return;this.OriBGMVolume=this.BGMVolume,this.OriSoundVolume=this.SoundVolume,this.SetBGMVolume(0),this.SetSoundVolume(0),this.IsMute=e}else{if(!this.IsMute)return;this.IsMute=e,this.SetBGMVolume(this.OriBGMVolume),this.SetSoundVolume(this.OriSoundVolume)}},e.SetSoundVolume=function(e){var t=this;e!=this.SoundVolume&&(this.SoundVolume=e,this.SoundVolume>1?this.SoundVolume=1:this.SoundVolume<0&&(this.SoundVolume=0),!this.IsMute&&this.IsSoundActive&&this.PlayingSoundList.forEach(function(e){null!=e&&(e.Volume=t.SoundVolume)}))},e.SetBGMVolume=function(e){e!=this.BGMVolume&&(this.BGMVolume=e,this.BGMVolume>1?this.BGMVolume=1:this.BGMVolume<0&&(this.BGMVolume=0),!this.IsMute&&this.IsBGMActive&&null!=this.PlayingBGM&&(this.PlayingBGM.Volume=this.BGMVolume))},e.LerpBGMVolume=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return this.IsMute?(this.BGMVolume=e,this.OriBGMVolume=e,[2]):(this.IsBGMActive&&null!=this.PlayingBGM&&this.PlayingBGM.FadeTo(e,t),[2])})})},e.LerpSoundVolume=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return this.IsMute?(this.SoundVolume=e,this.OriSoundVolume=e,[2]):(this.IsSoundActive&&this.PlayingSoundList.forEach(function(n){null!=n&&n.FadeTo(e,t)}),[2])})})},e.SetSoundActive=function(e){this.IsSoundActive!=e&&(this.IsSoundActive=e,e||this.StopAllSounds())},e.SetBGMActive=function(e){this.IsBGMActive!=e&&(this.IsBGMActive=e,null!=this.PlayingBGM&&(e?this.PlayBGM(this.PlayingBGM.Key):this.PlayingBGM.Stop()))},e.WaitForSecond=function(){return new Promise(function(e){return setTimeout(e,100)})},e.WaitForSeconds=function(e){return new Promise(function(t){return setTimeout(t,1e3*e)})},e.StringIsNullOrEmpty=function(e){return null==e||!e||e.trim().length<=0},e.IsNullOrUndefined=function(e){return null==e||void 0==e},e.IsInited=!1,e.IsBGMActive=!0,e.IsSoundActive=!0,e.BGMVolume=1,e.SoundVolume=1,e.PlayingBGM=null,e.PlayingSoundList=[],e.OriIsMute=!1,e.AssignVersion="",e.AudioKeyUrlDic=[],e.LastTimeDic=[],e.OriBGMVolume=1,e.OriSoundVolume=1,e.IsMute=!1,e}();__reflect(AudioPlayer.prototype,"AudioPlayer");